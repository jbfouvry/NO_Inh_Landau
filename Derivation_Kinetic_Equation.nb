(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    901647,      22112]
NotebookOptionsPosition[    885681,      21753]
NotebookOutlinePosition[    886059,      21770]
CellTagsIndexPosition[    886016,      21767]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "Mathematica", " ", "notebook", " ", "derives", " ", "the", 
      " ", 
      RowBox[{"1", "/", 
       RowBox[{"N", "^", "2"}]}], " ", "kinetic", " ", "equation", " ", 
      "presented", " ", "in", "\[IndentingNewLine]", "Kinetic", " ", "theory",
       " ", "of", " ", "one"}], "-", 
     RowBox[{"dimensional", " ", "inhomogeneous", " ", "long"}], "-", 
     RowBox[{"range", " ", "interacting", " ", "N"}], "-", 
     RowBox[{"body", " ", "systems", " ", "at", " ", "order", " ", 
      RowBox[{"1", "/", 
       RowBox[{"N", "^", "2"}]}], " ", "without", " ", "collective", " ", 
      "effects"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Jean", "-", 
     RowBox[{"Baptiste", " ", "Fouvry"}]}], ",", " ", 
    RowBox[{"submitted", " ", "to", " ", 
     RowBox[{"Phys", ".", " ", "Rev", ".", " ", "E", "."}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "code", " ", "was", " ", "run", " ", "using", " ", 
    "Mathematica", " ", "10.3", ".0", ".0", " ", "on", " ", 
    RowBox[{"MacOS", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "different", " ", "sections", " ", "of", " ", "the", " ", 
     "code", " ", "must", " ", "be", " ", "run", " ", "in", " ", 
     RowBox[{"order", ".", "\[IndentingNewLine]", "Their"}], " ", "main", " ",
      "purpose", " ", "is", " ", "as", " ", 
     RowBox[{"follows", ":", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", " ", "Custom"}], " ", "grammar", " ", "and", " ", 
        "rules", " ", "used", " ", "throughout", " ", "the", " ", 
        "derivation", "\[IndentingNewLine]", 
        RowBox[{"2", "/", " ", "BBGKY"}], " ", "hierarchy", 
        "\[IndentingNewLine]", 
        RowBox[{"3", "/", " ", "Truncating"}], " ", "the", " ", "equations", 
        " ", "at", " ", "order", " ", 
        RowBox[{"1", "/", 
         RowBox[{"N", "^", "2"}]}], "\[IndentingNewLine]", 
        RowBox[{"4", "/", " ", "Solving"}], " ", "the", " ", "time"}], "-", 
       RowBox[{
       "evolution", " ", "of", " ", "the", " ", "correlation", " ", 
        "functions", "\[IndentingNewLine]", 
        RowBox[{"5", "/", " ", "Simplifying"}], " ", "the", " ", "expression",
         " ", "of", " ", "the", " ", "collision", " ", "operator", 
        "\[IndentingNewLine]", 
        RowBox[{"6", "/", " ", "Recovering"}], " ", "the", " ", "homogeneous",
         " ", 
        RowBox[{"1", "/", 
         RowBox[{"N", "^", "2"}]}], " ", "kinetic", " ", "equation", " ", 
        "presented", " ", "in", " ", "Fouvry"}], "+", "2020"}]}]}], ",", " ", 
    "PRE", ",", " ", "102", ",", " ", 
    RowBox[{
     RowBox[{"052110", " ", 
      RowBox[{"(", "2020", ")"}], "\[IndentingNewLine]", 
      RowBox[{"7", "/", " ", "Proving"}], " ", "the", " ", "conservation", 
      " ", "properties", "\[IndentingNewLine]", 
      RowBox[{"8", "/", " ", "Introducing"}], " ", "the", " ", "fundamental", 
      " ", "resonances", "\[IndentingNewLine]", 
      RowBox[{"9", "/", " ", "Introducing"}], " ", "the", " ", "alternative", 
      " ", "writing", " ", "for", " ", "resonant", " ", "contribution", 
      "\[IndentingNewLine]", 
      RowBox[{"10", "/", " ", "Proving"}], " ", "the", " ", "well"}], "-", 
     RowBox[{"posedness", "\[IndentingNewLine]", 
      RowBox[{"11", "/", " ", "Unveiling"}], " ", "the", " ", "second"}], "-", 
     RowBox[{"order", " ", "kinetic", " ", "blocking"}]}]}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.781429935327736*^9, 3.781430076039935*^9}, {
  3.7851368095121803`*^9, 3.785136811623149*^9}, {3.785644403902787*^9, 
  3.7856444077395067`*^9}, {3.798977999859817*^9, 3.798978018585991*^9}, {
  3.866178387138856*^9, 3.8661784094969387`*^9}, {3.866178446621874*^9, 
  3.866178652852013*^9}, {3.8661789586384363`*^9, 3.866179067795525*^9}, {
  3.866519803081572*^9, 3.86651983194694*^9}, {3.866519870570128*^9, 
  3.866519886768461*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"1", "/", " ", "CUSTOM"}], " ", "GRAMMAR"}], 
  "Subsubsection"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.781506278256659*^9, 3.781506291398142*^9}, 
   3.781506438562361*^9, {3.781509176441293*^9, 3.7815091777910833`*^9}, {
   3.866178740050034*^9, 3.8661787457617598`*^9}, 3.866178853540661*^9, {
   3.866179008421351*^9, 3.866179008845294*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Definition", " ", "of", " ", "the", " ", "derivative", " ", 
     RowBox[{"operator", ".", "\[IndentingNewLine]", "The"}], " ", "first", 
     " ", "argument", " ", "is", " ", "the", " ", "quantity", " ", "to", " ", 
     "differentiate"}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "second", " ", "argument", " ", "is", " ", "the", 
     " ", "variable", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "which"}], " ", "the", " ", 
     "derivative", " ", "is", " ", 
     RowBox[{"computed", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "DER", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Expanding", " ", "the", " ", "inner", " ", "argument", " ", "if", " ", 
     RowBox[{"useful", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DER", "/:", 
     RowBox[{"DER", "[", 
      RowBox[{"A_", ",", "l_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"DER", "[", 
       RowBox[{
        RowBox[{"Expand", "@", "A"}], ",", "l"}], "]"}], "/;", 
      RowBox[{"(", " ", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Expand", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Scalar", " ", "quantities", " ", "have", " ", "a", " ", "zero", " ", 
     RowBox[{"derivative", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DER", "/:", 
     RowBox[{"DER", "[", 
      RowBox[{
       RowBox[{"A_", "?", "NumberQ"}], ",", "l_"}], "]"}], ":=", "0"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Spotting", " ", "zero", " ", 
     RowBox[{"derivatives", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DER", "/:", 
     RowBox[{"DER", "[", 
      RowBox[{"A_", ",", "l_"}], "]"}], ":=", 
     RowBox[{"0", "/;", 
      RowBox[{"(", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"A", ",", "l"}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Linearity", " ", "of", " ", "the", " ", 
     RowBox[{"derivative", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DER", "/:", " ", 
     RowBox[{"DER", "[", 
      RowBox[{"A_Plus", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"DER", "[", 
        RowBox[{"#", ",", "l"}], "]"}], "&"}], "/@", "A"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Product", " ", "rule", " ", "for", " ", "the", " ", 
     RowBox[{"derivative", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DER", "/:", 
     RowBox[{"DER", "[", 
      RowBox[{"A_Times", ",", "l_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "lA", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lA", " ", "=", " ", 
         RowBox[{"List", "@@", "A"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Times", "@@", 
           RowBox[{"(", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"lA", ",", 
              RowBox[{"i", "\[Rule]", 
               RowBox[{"DER", "[", 
                RowBox[{
                 RowBox[{"lA", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "l"}], "]"}]}]}], 
             "]"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "@", "lA"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Derivatives", " ", "of", " ", 
      RowBox[{"Power", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     
     RowBox[{"we", " ", "add", " ", "the", " ", 
      RowBox[{"`Positive", "'"}], " ", "test", " ", "to", " ", "ensure", " ", 
      "that", " ", "this", " ", "is", " ", "not", " ", "applied", " ", "to", 
      " ", "denominators"}], ",", " ", 
     RowBox[{
     "in", " ", "particular", " ", "not", " ", "applied", " ", "to", " ", 
      "resonant", " ", 
      RowBox[{"denominators", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DER", "/:", 
     RowBox[{"DER", "[", 
      RowBox[{
       RowBox[{"A_", "^", 
        RowBox[{"(", 
         RowBox[{"n_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", "0"}], "&"}], ")"}]}], ")"}]}], ",", "l_"}], 
      "]"}], ":=", 
     RowBox[{"n", " ", 
      RowBox[{"A", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], " ", 
      RowBox[{"DER", "[", 
       RowBox[{"A", ",", "l"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Definition", " ", "of", " ", "a", " ", "generic", " ", "function", " ", 
      "that", " ", "takes", " ", "an", " ", "argument", " ", "and", " ", "a", 
      " ", "list", " ", "of", " ", "variables"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"and", " ", "returns", " ", 
      RowBox[{"{", 
       RowBox[{"prefactor", ",", "integrand"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "where", " ", "prefactor", " ", "is", " ", "the", " ", "product", " ", 
      "of", " ", "the", " ", "factors", " ", "independent", " ", "of", " ", 
      "the", " ", "variables"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "and", " ", "integrand", " ", "the", " ", "product", " ", "of", " ", 
      "the", " ", "factors", " ", "that", " ", "depend", " ", "on", " ", 
      "the", " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "This"}], " ", "is", 
      " ", "a", " ", "useful", " ", "function", " ", "to", " ", "simplify", 
      " ", "INT", " ", "and", " ", 
      RowBox[{"SUM", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetPrefactorIntegrand", "[", 
      RowBox[{"A_Times", ",", "l_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lA", ",", "prefactor", ",", "integrand", ",", "i"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lA", " ", "=", " ", 
         RowBox[{"List", "@@", "A"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"prefactor", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"integrand", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "@", "lA"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"And", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{
                   RowBox[{"lA", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
                "/@", "l"}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "The", " ", "term", " ", "is", " ", "independent", " ", "of", 
               " ", "the", " ", "integration", " ", 
               RowBox[{"variables", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"prefactor", " ", "*=", " ", 
              RowBox[{"lA", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "The", " ", "term", " ", "depends", " ", "on", " ", "the", " ", 
               "integration", " ", 
               RowBox[{"variables", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"integrand", " ", "*=", " ", 
              RowBox[{"lA", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"prefactor", ",", "integrand"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Definition", " ", "of", " ", "the", " ", "integral", " ", 
      RowBox[{"operator", ".", "\[IndentingNewLine]", "The"}], " ", "first", 
      " ", "argument", " ", "is", " ", "the", " ", "quantity", " ", "to", " ",
       "integrate"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "and", " ", "the", " ", "second", " ", "argument", " ", "is", " ", "a", 
      " ", "list", " ", "of", " ", "variables", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", "which"}], " ", "the", " ", 
      "integrals", " ", "are", " ", 
      RowBox[{"computed", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "INT", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Vanishing", " ", 
     RowBox[{"integral", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INT", "/:", 
     RowBox[{"INT", "[", 
      RowBox[{"0", ",", "l_"}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Expanding", " ", "the", " ", "inner", " ", "integrand", " ", "if", " ", 
     RowBox[{"useful", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INT", "/:", 
     RowBox[{"INT", "[", 
      RowBox[{"A_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"INT", "[", 
       RowBox[{
        RowBox[{"Expand", "@", "A"}], ",", "l"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Expand", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Linearity", " ", "of", " ", "the", " ", 
     RowBox[{"integral", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INT", "/:", 
     RowBox[{"INT", "[", 
      RowBox[{"A_Plus", ",", "l_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{"#", ",", "l"}], "]"}], "&"}], "/@", "A"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Taking", " ", "out", " ", "the", " ", "factors", " ", "independent", 
      " ", "of", " ", "the", " ", "integration", " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "This"}], " ", 
      "simplification", " ", "is", " ", "applied", " ", "only", " ", "if", 
      " ", "the", " ", "prefactor", " ", "is", " ", "different", " ", "from", 
      " ", "1"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "if"}], " ", "it", " ", "does", " ", 
      RowBox[{"something", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INT", "/:", 
     RowBox[{"INT", "[", 
      RowBox[{"A_Times", ",", "l_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"GetPrefactorIntegrand", "[", 
         RowBox[{"A", ",", "l"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", 
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GetPrefactorIntegrand", "[", 
           RowBox[{"A", ",", "l"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "l"}], "]"}]}], "/;", 
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetPrefactorIntegrand", "[", 
          RowBox[{"A", ",", "l"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Dealing", " ", "with", " ", "the", " ", "case", " ", "where", " ", 
      "the", " ", "integrand", " ", "is", " ", "only", " ", "one", " ", 
      "term", " ", "independent", " ", "of", " ", "the", " ", "integration", 
      " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "This"}], " ", 
      "appears", " ", "in", " ", "the", " ", "Fourier", " ", "transforms"}], 
     ",", " ", 
     RowBox[{
     "and", " ", "we", " ", "can", " ", "take", " ", "this", " ", "one", " ", 
      "factor", " ", 
      RowBox[{"out", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{"to", " ", "avoid", " ", "infinite", " ", "loops"}], ",", " ", 
     RowBox[{
     "we", " ", "make", " ", "sure", " ", "that", " ", "this", " ", "loop", 
      " ", "is", " ", "not", " ", "applied", " ", "if", " ", "the", " ", 
      "integrand", " ", "is", " ", "equal", " ", "to", " ", "1."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INT", "/:", 
     RowBox[{"INT", "[", 
      RowBox[{"A_", ",", "l_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"A", " ", 
       RowBox[{"INT", "[", 
        RowBox[{"1", ",", "l"}], "]"}]}], " ", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"A", ",", "#"}], "]"}], "&"}], "/@", "l"}], ")"}]}], " ",
         "&&", " ", 
        RowBox[{"UnsameQ", "[", 
         RowBox[{"A", ",", "1"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "ease", " ", "the", " ", 
      "recognition", " ", "of", " ", "terms"}], ",", " ", 
     RowBox[{
     "we", " ", "make", " ", "sure", " ", "that", "\[IndentingNewLine]", 
      "the", " ", "integration", " ", "variables", " ", "always", " ", 
      "appear", " ", "in", " ", "a", " ", "sorted", " ", 
      RowBox[{"order", ".", "\[IndentingNewLine]", "This"}], " ", "is", " ", 
      "useful", " ", "when", " ", "relabelling", " ", "dummy", " ", 
      RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "performs", " ", "the", " ", "sorting", " ",
      "of", " ", "the", " ", "integration", " ", 
     RowBox[{"variables", ".", "\[IndentingNewLine]", "We"}], " ", "write", 
     " ", "it", " ", "so", " ", "that", " ", "\[Theta]", " ", "appear", " ", 
     "before", " ", "the", " ", 
     RowBox[{"J", ".", "\[IndentingNewLine]", "This"}], " ", "function", " ", 
     "returns", " ", "True", " ", "if", " ", "var1", " ", "has", " ", "to", 
     " ", "appear", " ", "before", " ", 
     RowBox[{"var2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SortINT", "[", 
      RowBox[{"var1_", ",", "var2_"}], "]"}], ":=", " ", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Angles", " ", "appear", " ", "before", " ", 
          RowBox[{"actions", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"AngleQ", "@", "var1"}], " ", "&&", " ", 
          RowBox[{"ActionQ", "@", "var2"}]}], ",", "\[IndentingNewLine]", 
         "True", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Actions", " ", "appear", " ", "after", " ", 
           RowBox[{"angles", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ActionQ", "@", "var1"}], " ", "&&", " ", 
          RowBox[{"AngleQ", "@", "var2"}]}], ",", "\[IndentingNewLine]", 
         "False", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Otherwise", ",", " ", 
           RowBox[{
           "we", " ", "use", " ", "Mathematica", " ", "classical", " ", 
            RowBox[{"ordering", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "The", " ", "first", " ", "variable", " ", "should", " ", "appear", 
           " ", "before", " ", "the", " ", "second", " ", 
           RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Order", "[", 
           RowBox[{"var1", ",", "var2"}], "]"}], "\[Equal]", "1"}], ",", 
         "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "The", " ", "second", " ", "variable", " ", "should", " ", "appear",
            " ", "before", " ", "the", " ", "first", " ", 
           RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Order", "[", 
           RowBox[{"var1", ",", "var2"}], "]"}], "\[Equal]", 
          RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "False", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"In", " ", "all", " ", "other", " ", "case"}], ",", " ", 
           RowBox[{
           "we", " ", "do", " ", "not", " ", "change", " ", "the", " ", 
            "order", " ", "of", " ", "the", " ", 
            RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         "True", ",", "\[IndentingNewLine]", "True"}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Sorting", " ", "the", " ", "integration", " ", "variables", " ", "of", 
     " ", 
     RowBox[{"INT", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INT", "/:", 
     RowBox[{"INT", "[", 
      RowBox[{"A_", ",", "l_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"INT", "[", 
       RowBox[{"A", ",", 
        RowBox[{"Sort", "[", 
         RowBox[{"l", ",", "SortINT"}], "]"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"l", ",", 
         RowBox[{"Sort", "[", 
          RowBox[{"l", ",", "SortINT"}], "]"}]}], "]"}], ")"}]}]}], ";"}], 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Definition", " ", "of", " ", "the", " ", "integral", " ", "operator", 
      " ", "with", " ", 
      RowBox[{"bounds", ".", "\[IndentingNewLine]", "The"}], " ", "first", 
      " ", "argument", " ", "is", " ", "the", " ", "quantity", " ", "to", " ",
       "integrate"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "and", " ", "the", " ", "second", " ", "argument", " ", "is", " ", "the",
       " ", "list", " ", "of", " ", "the", " ", "variable", " ", "and", " ", 
      "its", " ", "bounds"}], ",", " ", 
     RowBox[{
      RowBox[{"e", ".", "g", ".", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ".", 
       "\[IndentingNewLine]", "This"}], " ", "is", " ", "the", " ", 
      "integral", " ", "operator", " ", "that", " ", "we", " ", "use", " ", 
      "for", " ", "the", " ", "temporal", " ", "integral"}], ",", " ", 
     RowBox[{
     "to", " ", "make", " ", "sure", " ", "that", " ", "we", " ", "correctly",
       " ", "keep", " ", "track", " ", "of", " ", "the", " ", 
      RowBox[{"bounds", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "INTb", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Vanishing", " ", 
     RowBox[{"integral", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTb", "/:", 
     RowBox[{"INTb", "[", 
      RowBox[{"0", ",", "l_"}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Expanding", " ", "the", " ", "inner", " ", "integrand", " ", "if", " ", 
     RowBox[{"useful", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTb", "/:", 
     RowBox[{"INTb", "[", 
      RowBox[{"A_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"INTb", "[", 
       RowBox[{
        RowBox[{"Expand", "@", "A"}], ",", "l"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Expand", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Linearity", " ", "of", " ", "the", " ", 
     RowBox[{"integral", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTb", "/:", 
     RowBox[{"INTb", "[", 
      RowBox[{"A_Plus", ",", "l_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"INTb", "[", 
        RowBox[{"#", ",", "l"}], "]"}], "&"}], "/@", "A"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Taking", " ", "out", " ", "the", " ", "factors", " ", "independent", 
      " ", "of", " ", "the", " ", "integration", " ", 
      RowBox[{"variable", ".", "\[IndentingNewLine]", "This"}], " ", 
      "simplification", " ", "is", " ", "applied", " ", "only", " ", "if", 
      " ", "the", " ", "prefactor", " ", "is", " ", "different", " ", "from", 
      " ", "1"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "if"}], " ", "it", " ", "does", " ", 
      RowBox[{"something", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "to", " ", "the", " ", "change", " ", "in", " ", "the", " ", "call", " ",
       "to", " ", 
      RowBox[{"GetPrefactorIntegrand", ":", " ", 
       RowBox[{
       "the", " ", "integration", " ", "variable", " ", "is", " ", "the", " ",
         "first", " ", "one", " ", "in", " ", "the", " ", "list", " ", "of", 
        " ", "three", " ", 
        RowBox[{"elements", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTb", "/:", 
     RowBox[{"INTb", "[", 
      RowBox[{"A_Times", ",", "l_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"GetPrefactorIntegrand", "[", 
         RowBox[{"A", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"l", ",", "1"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", 
       RowBox[{"INTb", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GetPrefactorIntegrand", "[", 
           RowBox[{"A", ",", 
            RowBox[{"Take", "[", 
             RowBox[{"l", ",", "1"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "l"}], "]"}]}], "/;", 
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetPrefactorIntegrand", "[", 
          RowBox[{"A", ",", 
           RowBox[{"Take", "[", 
            RowBox[{"l", ",", "1"}], "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Dealing", " ", "with", " ", "the", " ", "case", " ", "where", " ", 
      "the", " ", "integrand", " ", "is", " ", "only", " ", "one", " ", 
      "term", " ", "independent", " ", "of", " ", "the", " ", "integration", 
      " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "This"}], " ", "can", 
      " ", "appear", " ", "in", " ", "the", " ", "Fourier", " ", 
      RowBox[{"transforms", ".", "\[IndentingNewLine]", "We"}], " ", "can", 
      " ", "take", " ", "this", " ", "factor", " ", 
      RowBox[{"out", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{"to", " ", "avoid", " ", "infinite", " ", "loops"}], ",", " ", 
     RowBox[{
     "we", " ", "make", " ", "sure", " ", "that", " ", "this", " ", "rule", 
      " ", "is", " ", "not", " ", "applied", " ", "if", " ", "the", " ", 
      "integrand", " ", "is", " ", "equal", " ", "to", " ", "1.", 
      "\[IndentingNewLine]", "ATTENTION"}], ",", " ", 
     RowBox[{
     "to", " ", "the", " ", "change", " ", "in", " ", "the", " ", "tests"}], 
     ",", " ", 
     RowBox[{
     "given", " ", "where", " ", "the", " ", "integration", " ", "variable", 
      " ", "is", " ", "stored", " ", "in", " ", 
      RowBox[{"INTb", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTb", "/:", 
     RowBox[{"INTb", "[", 
      RowBox[{"A_", ",", "l_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"A", " ", 
       RowBox[{"INTb", "[", 
        RowBox[{"1", ",", "l"}], "]"}]}], " ", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"A", ",", 
          RowBox[{"l", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "&&", " ", 
        RowBox[{"UnsameQ", "[", 
         RowBox[{"A", ",", "1"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Definition", " ", "of", " ", "the", " ", "summation", " ", 
      RowBox[{"operator", ".", "\[IndentingNewLine]", "The"}], " ", "first", 
      " ", "argument", " ", "is", " ", "the", " ", "quantity", " ", "to", " ",
       "sum"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "and", " ", "the", " ", "second", " ", "argument", " ", "is", " ", "the",
       " ", "List", " ", "of", " ", "variables", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", "which"}], " ", "the", " ", 
      "sum", " ", "is", " ", 
      RowBox[{"computed", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "SUM", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Vanishing", " ", 
     RowBox[{"sum", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SUM", "/:", 
     RowBox[{"SUM", "[", 
      RowBox[{"0", ",", "l_"}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Expanding", " ", "the", " ", "inner", " ", "argument", " ", "if", " ", 
     RowBox[{"useful", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SUM", "/:", 
     RowBox[{"SUM", "[", 
      RowBox[{"A_", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"SUM", "[", 
       RowBox[{
        RowBox[{"Expand", "@", "A"}], ",", "l"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Expand", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Linearity", " ", "of", " ", "the", " ", 
     RowBox[{"sum", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SUM", "/:", 
     RowBox[{"SUM", "[", 
      RowBox[{"A_Plus", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"SUM", "[", 
        RowBox[{"#", ",", "l"}], "]"}], "&"}], "/@", "A"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Taking", " ", "out", " ", "the", " ", "factors", " ", "independent", 
      " ", "of", " ", "the", " ", "integration", " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "This"}], " ", 
      "simplification", " ", "rule", " ", "is", " ", "applied", " ", "only", 
      " ", "if", " ", "the", " ", "prefactor", " ", "is", " ", "different", 
      " ", "from", " ", "1"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "if"}], " ", "it", " ", "does", " ", 
      RowBox[{"something", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SUM", "/:", 
     RowBox[{"SUM", "[", 
      RowBox[{"A_Times", ",", "l_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"GetPrefactorIntegrand", "[", 
         RowBox[{"A", ",", "l"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", 
       RowBox[{"SUM", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GetPrefactorIntegrand", "[", 
           RowBox[{"A", ",", "l"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "l"}], "]"}]}], "/;", 
      RowBox[{"UnsameQ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GetPrefactorIntegrand", "[", 
          RowBox[{"A", ",", "l"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "ease", " ", "the", " ", 
      "recognition", " ", "of", " ", "terms"}], ",", " ", 
     RowBox[{
     "we", " ", "make", " ", "sure", " ", "that", " ", "for", " ", 
      "integrals", " ", "with", " ", "more", " ", "than", " ", "one", " ", 
      "integration", " ", "variables"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "the", " ", "integration", " ", "variables", " ", "always", " ", 
      "appear", " ", "in", " ", "a", " ", "sorted", " ", 
      RowBox[{"order", ".", "\[IndentingNewLine]", "This"}], " ", "can", " ", 
      "be", " ", "useful", " ", "when", " ", "relabelling", " ", "dummy", " ", 
      RowBox[{"variables", "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"SUM", "/:", 
     RowBox[{"SUM", "[", 
      RowBox[{"A_", ",", "l_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"SUM", "[", 
       RowBox[{"A", ",", 
        RowBox[{"Sort", "@", "l"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"l", ",", 
         RowBox[{"Sort", "@", "l"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Definition", " ", "of", " ", "the", " ", "exponential", " ", 
     RowBox[{"function", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "EXP", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Value", " ", "in", " ", "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EXP", "/:", 
     RowBox[{"EXP", "[", "0", "]"}], ":=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Factoring", " ", "the", " ", "arguments"}], ",", " ", 
     RowBox[{"if", " ", 
      RowBox[{"useful", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EXP", "/:", 
     RowBox[{"EXP", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"EXP", "[", 
       RowBox[{"Factor", "@", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Factor", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Basic", " ", "rules", " ", "for", " ", "the", " ", "Kronecker", " ", 
     RowBox[{"symbol", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "KRON", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Value", " ", "in", " ", "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KRON", "/:", 
     RowBox[{"KRON", "[", "0", "]"}], ":=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Value", " ", "for", " ", "non"}], "-", 
     RowBox[{"zero", " ", "integer", " ", 
      RowBox[{"values", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KRON", "/:", 
     RowBox[{"KRON", "[", 
      RowBox[{"A_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerQ", "[", "#", "]"}], " ", "&&", " ", 
          RowBox[{"UnsameQ", "[", 
           RowBox[{"#", ",", "0"}], "]"}]}], "&"}], ")"}]}], "]"}], ":=", 
     "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Factoring", " ", "the", " ", "arguments"}], ",", " ", 
     RowBox[{"if", " ", 
      RowBox[{"useful", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KRON", "/:", " ", 
     RowBox[{"KRON", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"KRON", "[", 
       RowBox[{"Factor", "@", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Factor", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "use", " ", "the", " ", "fact", " ", "that", " ", "the", " ", 
      "KRON", " ", "function", " ", "is", " ", 
      RowBox[{"even", ".", "\[IndentingNewLine]", 
       RowBox[{"See", ":", " ", "https", ":"}]}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", "a"}],
        "/", "126759"}], "/", "9569"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KRON", "/:", 
     RowBox[{"KRON", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"KRON", "[", 
       RowBox[{"-", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "A", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Basic", " ", "rules", " ", "for", " ", "the", " ", "Dirac", " ", 
      "delta", " ", "and", " ", "its", " ", 
      RowBox[{"derivatives", ".", "\[IndentingNewLine]", "Throughout"}], " ", 
      "this", " ", "notebook"}], ",", " ", 
     RowBox[{"the", " ", "suffix", " ", 
      RowBox[{"`P", "'"}], " ", "stands", " ", "for", " ", "derivatives"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e"}], " ", 
      RowBox[{
       RowBox[{"`Prime", "'"}], "."}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "DIRAC", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "DIRACP", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "DIRACPP", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DIRAC", " ", "is", " ", "an", " ", "even", " ", 
     RowBox[{"function", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DIRAC", "/:", 
     RowBox[{"DIRAC", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"DIRAC", "[", 
       RowBox[{"Factor", "@", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Factor", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DIRAC", "/:", 
     RowBox[{"DIRAC", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"DIRAC", "[", 
       RowBox[{"-", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "A", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DIRACP", " ", "is", " ", "an", " ", "odd", " ", 
     RowBox[{"function", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DIRACP", "/:", 
     RowBox[{"DIRACP", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"DIRACP", "[", 
       RowBox[{"Factor", "@", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Factor", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DIRACP", "/:", 
     RowBox[{"DIRACP", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"DIRACP", "[", 
        RowBox[{"-", "A"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "A", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DIRACPP", " ", "is", " ", "an", " ", "even", " ", 
     RowBox[{"function", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DIRACPP", "/:", 
     RowBox[{"DIRACPP", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"DIRACPP", "[", 
       RowBox[{"Factor", "@", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Factor", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DIRACPP", "/:", 
     RowBox[{"DIRACPP", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"DIRACPP", "[", 
       RowBox[{"-", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "A", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Basic", " ", "rules", " ", "for", " ", "the", " ", "principal", " ", 
     RowBox[{"part", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "PRPA", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "PRPAP", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "PRPAPP", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PRPA", " ", "is", " ", "an", " ", "odd", " ", 
     RowBox[{"function", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PRPA", "/:", 
     RowBox[{"PRPA", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"PRPA", "[", 
       RowBox[{"Factor", "@", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Factor", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PRPA", "/:", 
     RowBox[{"PRPA", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"PRPA", "[", 
        RowBox[{"-", "A"}], "]"}]}], " ", "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "A", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PRPAP", " ", "is", " ", "an", " ", "even", " ", 
     RowBox[{"function", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PRPAP", "/:", 
     RowBox[{"PRPAP", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"PRPAP", "[", 
       RowBox[{"Factor", "@", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Factor", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PRPAP", "/:", 
     RowBox[{"PRPAP", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"PRPAP", "[", 
       RowBox[{"-", "A"}], "]"}], " ", "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "A", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PRPAPP", " ", "is", " ", "an", " ", "odd", " ", 
     RowBox[{"function", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PRPAPP", "/:", 
     RowBox[{"PRPAPP", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"PRPAPP", "[", 
       RowBox[{"Factor", "@", "A"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"A", ",", 
         RowBox[{"Factor", "@", "A"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PRPAPP", "/:", 
     RowBox[{"PRPAPP", "[", "A_", "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"PRPAPP", "[", 
        RowBox[{"-", "A"}], "]"}]}], " ", "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "A", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Generic", " ", "property", " ", "for", " ", "the", " ", 
       RowBox[{"Pos", "[", "\[Omega]", "]"}]}], "=", 
      RowBox[{"\[Omega]", "+", "I\[Gamma]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"with", " ", "\[Gamma]"}], ">", 
      RowBox[{
      "0", " ", "a", " ", "small", " ", "positive", " ", "real", " ", 
       RowBox[{"number", ".", "\[IndentingNewLine]", "This"}], " ", "is", " ",
        "useful", " ", "to", " ", "keep", " ", "track", " ", "of", " ", "the",
        " ", "sign", " ", "to", " ", "use", " ", "in", " ", 
       RowBox[{"Plemelj", "'"}], "s", " ", 
       RowBox[{"formula", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pos", "/:", 
     RowBox[{"Pos", "[", "\[Omega]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Pos", "[", 
       RowBox[{"Factor", "@", "\[Omega]"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"\[Omega]", ",", 
         RowBox[{"Factor", "@", "\[Omega]"}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Basic", " ", "rules", " ", "for", " ", "the", " ", "coupling", " ", 
      "coefficients", " ", "and", " ", "their", " ", 
      RowBox[{"gradients", ".", "\[IndentingNewLine]", "Here"}]}], ",", " ", 
     RowBox[{"we", " ", "use", " ", "the", " ", 
      RowBox[{"notations", ":", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"+", " ", "UPotk"}], " ", "is", " ", "the", " ", "coupling", 
         " ", "coefficient"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"UPotkP1", " ", "is", " ", "its", " ", "first"}], "-", 
        RowBox[{"order", " ", "gradient", " ", 
         RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", "first", 
         " ", "action", " ", "coordinate"}], "\[IndentingNewLine]", "+", " ", 
        
        RowBox[{"UPotkP2", " ", "is", " ", "its", " ", "first"}], "-", 
        RowBox[{"order", " ", "gradient", " ", 
         RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", "second", 
         " ", "action", " ", "coordinate"}], "\[IndentingNewLine]", "+", " ", 
        
        RowBox[{"UPotkP1P1", " ", "is", " ", "its", " ", "second"}], "-", 
        RowBox[{"order", " ", "gradient", " ", 
         RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", "first", 
         " ", "action", " ", "coordinate"}], "\[IndentingNewLine]", "+", " ", 
        
        RowBox[{"UPotkP2P2", " ", "is", " ", "its", " ", "second"}], "-", 
        RowBox[{"order", " ", "gradient", " ", 
         RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", "second", 
         " ", "action", " ", "coordinate"}], "\[IndentingNewLine]", "+", " ", 
        
        RowBox[{"UPotkP1P2", " ", "is", " ", "its", " ", "second"}], "-", 
        RowBox[{"order", " ", "gradient", " ", 
         RowBox[{"w", ".", "r", ".", "t", ".", " ", "each"}], " ", "action", 
         " ", "coordinate", " ", 
         RowBox[{"once", "."}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "UPotk", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "UPotkP1", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "UPotkP2", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "UPotkP1P1", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "UPotkP2P2", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "UPotkP1P2", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "coefficients", " ", "satisfy", " ", "the", " ", "symmetry", 
      " ", 
      RowBox[{"UPotk", "[", 
       RowBox[{
        RowBox[{"-", "k"}], ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "=", 
     RowBox[{
      RowBox[{"UPotk", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotk", "/:", 
     RowBox[{"UPotk", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J1_", ",", "J2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotk", "[", 
       RowBox[{
        RowBox[{"-", "k"}], ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "k", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP1", "/:", 
     RowBox[{"UPotkP1", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J1_", ",", "J2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotkP1", "[", 
       RowBox[{
        RowBox[{"-", "k"}], ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "k", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP2", "/:", 
     RowBox[{"UPotkP2", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J1_", ",", "J2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotkP2", "[", 
       RowBox[{
        RowBox[{"-", "k"}], ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "k", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP1P1", "/:", 
     RowBox[{"UPotkP1P1", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J1_", ",", "J2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotkP1P1", "[", 
       RowBox[{
        RowBox[{"-", "k"}], ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "k", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP2P2", "/:", 
     RowBox[{"UPotkP2P2", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J1_", ",", "J2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotkP2P2", "[", 
       RowBox[{
        RowBox[{"-", "k"}], ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "k", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP1P2", "/:", 
     RowBox[{"UPotkP1P2", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J1_", ",", "J2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotkP1P2", "[", 
       RowBox[{
        RowBox[{"-", "k"}], ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"Internal`SyntacticNegativeQ", "[", "k", "]"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "The", " ", "coefficients", " ", "satisfy", " ", "the", " ", "symmetry",
        " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"J2", ",", "J1"}], "}"}]}], "]"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"UPotk", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], ".", 
        "\[IndentingNewLine]", "We"}], " ", "sort", " ", "therefore", " ", 
       "the", " ", "arguments", " ", "so", " ", "that", " ", "the", " ", 
       "first", " ", "action", " ", "is", " ", "always", " ", "the", " ", 
       "first", " ", "one", " ", "by", " ", "alphabetical", " ", 
       RowBox[{"order", ".", "\[IndentingNewLine]", "ATTENTION"}]}]}], ",", 
     " ", 
     RowBox[{
     "to", " ", "the", " ", "switches", " ", "in", " ", "the", " ", "names", 
      " ", "of", " ", "the", " ", "function", " ", "for", " ", "the", " ", 
      "rules", " ", "of", " ", "the", " ", "derivatives"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "except", " ", "for", " ", "the", " ", "crossed", " ", "derivative", " ",
       "where", " ", "we", " ", "use", " ", 
      RowBox[{"Schwarz", "'"}], " ", 
      RowBox[{"Theorem", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotk", "/:", 
     RowBox[{"UPotk", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J2_", ",", "J1_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotk", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"J2", ",", "J1"}], "}"}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{"{", 
           RowBox[{"J2", ",", "J1"}], "}"}]}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP1", "/:", 
     RowBox[{"UPotkP1", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J2_", ",", "J1_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotkP2", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"J2", ",", "J1"}], "}"}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{"{", 
           RowBox[{"J2", ",", "J1"}], "}"}]}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP2", "/:", 
     RowBox[{"UPotkP2", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J2_", ",", "J1_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotkP1", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"J2", ",", "J1"}], "}"}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{"{", 
           RowBox[{"J2", ",", "J1"}], "}"}]}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP1P1", "/:", 
     RowBox[{"UPotkP1P1", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J2_", ",", "J1_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotkP2P2", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"J2", ",", "J1"}], "}"}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{"{", 
           RowBox[{"J2", ",", "J1"}], "}"}]}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP2P2", "/:", 
     RowBox[{"UPotkP2P2", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J2_", ",", "J1_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotkP1P1", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"J2", ",", "J1"}], "}"}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{"{", 
           RowBox[{"J2", ",", "J1"}], "}"}]}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP1P2", "/:", 
     RowBox[{"UPotkP1P2", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J2_", ",", "J1_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"UPotkP1P2", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"J2", ",", "J1"}], "}"}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{"{", 
           RowBox[{"J2", ",", "J1"}], "}"}]}]}], "]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "also", " ", "add", " ", "an", " ", "additional", " ", 
      "symmetry", " ", "in", " ", "the", " ", "particular", " ", "case", " ", 
      "where", " ", "the", " ", "two", " ", "actions", " ", "are", " ", 
      "identical"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "to"}], " ", "evaluate", " ", 
      RowBox[{
       RowBox[{"UPotk", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J"}], "}"}]}], "]"}], ".", "\[IndentingNewLine]",
        "In"}], " ", "that", " ", "case"}], ",", " ", 
     RowBox[{
     "we", " ", "always", " ", "favor", " ", "taking", " ", "the", " ", 
      "derivative", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", "first", " ", 
      RowBox[{"coordinate", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP2", "/:", 
     RowBox[{"UPotkP2", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J_", ",", "J_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"UPotkP1", "[", 
      RowBox[{"k", ",", 
       RowBox[{"{", 
        RowBox[{"J", ",", "J"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPotkP2P2", "/:", 
     RowBox[{"UPotkP2P2", "[", 
      RowBox[{"k_", ",", 
       RowBox[{"{", 
        RowBox[{"J_", ",", "J_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"UPotkP1P1", "[", 
      RowBox[{"k", ",", 
       RowBox[{"{", 
        RowBox[{"J", ",", "J"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "for", " ", "a", " ", 
      "given", " ", "expression"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "performs", " ", "the", " ", "replacement", " ", "of", " ", "the", " ", 
      "variables", " ", "listvarold", " ", "into", " ", "the", " ", 
      "variables", " ", 
      RowBox[{"listvarnew", ".", "\[IndentingNewLine]", "This"}], " ", 
      "function", " ", "is", " ", "useful", " ", "to", " ", "avoid", " ", 
      "confusion", " ", "when", " ", "performing", " ", "such", " ", 
      RowBox[{"replacements", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceVariables", "[", 
      RowBox[{"exp_", ",", "listvarold_", ",", "listvartemp_"}], "]"}], ":=", 
     
     RowBox[{"exp", "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{"listvarold", ",", "listvartemp"}], "}"}]}], ")"}]}], 
         ")"}], "//", "Flatten"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "performs", " ", "a", " ", 
      "ReplaceRepeated", " ", "in", " ", "an", " ", "expression", " ", "for", 
      " ", "a", " ", "list", " ", "of", " ", 
      RowBox[{"rules", ".", "\[IndentingNewLine]", "We"}], " ", "make", " ", 
      "sure", " ", "that", " ", "we", " ", "reach", " ", "a", " ", "stage", 
      " ", "where", " ", "applying", " ", "each", " ", "individual", " ", 
      "rule", " ", "repetitively", " ", "does", " ", "not", " ", "change", 
      " ", "the", " ", "resulting", " ", 
      RowBox[{"expression", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "one", " ", "can", " ", "fall", " ", "in", " ", "an", " ", "infinite", 
      " ", "loop", " ", "if", " ", "the", " ", "rules", " ", "are", " ", 
      "not", " ", 
      RowBox[{"correct", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RepeatedRules", "[", 
      RowBox[{"exp_", ",", "tabrules_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"exptemp", ",", "res", ",", "nbrules", ",", "currentrule"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Temporary", " ", "container", " ", "for", " ", "the", " ", 
         RowBox[{"expression", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exptemp", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Container", " ", "for", " ", "the", " ", 
          RowBox[{"result", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", "exp"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Number", " ", "of", " ", "rules", " ", "to", " ", 
          RowBox[{"apply", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"nbrules", " ", "=", " ", 
         RowBox[{"Length", "[", "tabrules", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Current", " ", "rule", " ", "that", " ", "is", " ", "being", " ", 
          RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"currentrule", " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"We", " ", "enter", " ", "a", " ", "loop"}], ",", " ", 
          RowBox[{
          "that", " ", "we", " ", "leave", " ", "only", " ", "once", " ", 
           "none", " ", "of", " ", "the", " ", "rules", " ", "have", " ", 
           "any", " ", "effects", " ", "on", " ", "the", " ", 
           RowBox[{"expression", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"currentrule", "\[LessEqual]", "nbrules"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"We", " ", "apply", " ", "the", " ", "current", " ", 
             RowBox[{"rule", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",",
             " ", 
            RowBox[{"we", " ", "use", " ", "a", " ", 
             RowBox[{"RepleaceRepeated", "."}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"exptemp", " ", "=", " ", 
            RowBox[{"res", "//.", 
             RowBox[{"tabrules", "[", 
              RowBox[{"[", "currentrule", "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "We", " ", "determine", " ", "if", " ", "the", " ", "rule", " ", 
              "has", " ", "been", " ", "applied"}], ",", " ", 
             RowBox[{
              RowBox[{"i", ".", "e", ".", " ", "if"}], " ", "the", " ", 
              "expression", " ", "has", " ", 
              RowBox[{"changed", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"res", ",", "exptemp"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "The", " ", "rule", " ", "has", " ", "not", " ", "been", " ", 
               RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "We", " ", "can", " ", "now", " ", "consider", " ", "the", " ", 
               "next", " ", 
               RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"currentrule", " ", "+=", " ", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"The", " ", "rule", " ", "has", " ", "been", " ", 
               RowBox[{"applied", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"We", " ", "update", " ", "the", " ", 
               RowBox[{"result", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"res", " ", "=", " ", "exptemp"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "We", " ", "start", " ", "again", " ", "from", " ", "the", " ",
                 "first", " ", 
                RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"currentrule", " ", "=", " ", "1"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "ease", " ", "the", " ", "spotting", 
      " ", "of", " ", "similar", " ", "expressions"}], ",", " ", 
     RowBox[{
     "we", " ", "use", " ", "the", " ", "fact", " ", "that", " ", "we", " ", 
      "have", " ", "dummy", " ", "variables", " ", "at", " ", "our", " ", 
      RowBox[{"disposal", ".", "\[IndentingNewLine]", "Indeed"}]}], ",", " ", 
     
     RowBox[{
     "there", " ", "can", " ", "be", " ", "many", " ", "terms", " ", "that", 
      " ", "are", " ", "the", " ", "same", " ", "up", " ", "to", " ", 
      "relabelling", " ", "of", " ", "the", " ", "dummy", " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "As"}], " ", "such"}], 
     ",", " ", 
     RowBox[{
     "we", " ", "define", " ", "a", " ", "function", " ", "that", " ", 
      "takes", " ", "an", " ", "expression", " ", "as", " ", "an", " ", 
      "argument"}], ",", " ", 
     RowBox[{
     "and", " ", "relabels", " ", "the", " ", "dummy", " ", "variables", " ", 
      
      RowBox[{"therein", ".", "\[IndentingNewLine]", "Such"}], " ", 
      "manipulations", " ", "cannot", " ", "create", " ", "new", " ", 
      RowBox[{"terms", ".", "\[IndentingNewLine]", "But"}]}], ",", " ", 
     RowBox[{
     "following", " ", "this", " ", "relabelling", " ", "some", " ", "equal", 
      " ", "terms", " ", "will", " ", "appear", " ", "and", " ", 
      RowBox[{"vanish", ".", "\[IndentingNewLine]", "Here"}]}], ",", " ", 
     RowBox[{
     "we", " ", "make", " ", "this", " ", "relabelling", " ", "even", " ", 
      "smarter", " ", "by", " ", "obtaining", " ", "the", " ", "list", " ", 
      "of", " ", "variables", " ", "in", " ", "the", " ", "same", " ", 
      "order", " ", "as", " ", "they", " ", "appear", " ", "in", " ", "the", 
      " ", 
      RowBox[{"expression", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "tests", " ", "whether", " ", "or", " ", 
      "not", " ", "a", " ", "variable", " ", "is", " ", "an", " ", 
      RowBox[{"angle", ".", "\[IndentingNewLine]", "This"}], " ", "test", " ",
       "is", " ", "made", " ", "by", " ", "taking", " ", "the", " ", "first", 
      " ", "character", " ", "of", " ", "the", " ", "name"}], ",", " ", 
     RowBox[{"and", " ", "checking", " ", "that", " ", "it", " ", "is", " ", 
      RowBox[{"\[Theta]", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "we", " ", "also", " ", "make", " ", "sure", " ", "that", " ", "we", " ",
       "do", " ", "not", " ", "keep", " ", "any", " ", "of", " ", "patterns", 
      " ", 
      RowBox[{
       RowBox[{"Blank", "[", "]"}], ".", "\[IndentingNewLine]", 
       "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "we", " ", "also", " ", "make", " ", "sure", " ", "that", " ", "we", " ",
       "have", " ", "only", " ", "one", " ", 
      RowBox[{"term", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AngleQ", "[", "var_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "var", "]"}], "//", 
        RowBox[{
         RowBox[{"StringDelete", "[", 
          RowBox[{"#", ",", "\"\<_\>\""}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "\[Equal]", "\"\<\[Theta]\>\""}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Symbol", ",", "Pattern"}], "}"}], ",", 
           RowBox[{"Head", "@", "var"}]}], "]"}]}], ")"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "tests", " ", "whether", " ", "or", " ", 
     "not", " ", "a", " ", "variable", " ", "is", " ", "an", " ", 
     RowBox[{"action", ".", "\[IndentingNewLine]", "Same"}], " ", "remarks", 
     " ", "as", " ", "in", " ", 
     RowBox[{"AngleQ", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ActionQ", "[", "var_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "var", "]"}], "//", 
        RowBox[{
         RowBox[{"StringDelete", "[", 
          RowBox[{"#", ",", "\"\<_\>\""}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "\[Equal]", "\"\<J\>\""}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Symbol", ",", "Pattern"}], "}"}], ",", 
           RowBox[{"Head", "@", "var"}]}], "]"}]}], ")"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "tests", " ", "whether", " ", "or", " ", 
     "not", " ", "a", " ", "variable", " ", "is", " ", "a", " ", "wavenumber",
      " ", 
     RowBox[{"k", ".", "\[IndentingNewLine]", "Same"}], " ", "remarks", " ", 
     "as", " ", "in", " ", 
     RowBox[{"AngleQ", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WaveQ", "[", "var_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", "var", "]"}], "//", 
        RowBox[{
         RowBox[{"StringDelete", "[", 
          RowBox[{"#", ",", "\"\<_\>\""}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "\[Equal]", "\"\<k\>\""}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Symbol", ",", "Pattern"}], "}"}], ",", 
           RowBox[{"Head", "@", "var"}]}], "]"}]}], ")"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "test", " ", "whether", " ", "or", " ", 
      "not", " ", "a", " ", "variable", " ", "is", " ", "a", " ", 
      "frequency"}], ",", " ", 
     RowBox[{"of", " ", "the", " ", "form", " ", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FrequencyQ", "[", "var_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Head", "@", "var"}], " ", "\[Equal]", " ", 
       "\[CapitalOmega]"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Function", " ", "that", " ", "relabels", " ", "one", " ", 
     RowBox[{"term", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RelabelDummy", "[", "exp_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "listvar", ",", "listActOLD", ",", "listWaveOLD", ",", "listActNEW", 
         ",", "listWaveNEW", ",", "listOLD", ",", "listNEW"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{
         "we", " ", "extract", " ", "the", " ", "UNSORTED", " ", "list", " ", 
          "of", " ", "all", " ", "the", " ", "variables", " ", "that", " ", 
          "appear", " ", "in", " ", "the", " ", 
          RowBox[{"expression", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"listvar", " ", "=", " ", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{"exp", ",", "_Symbol", ",", "Infinity"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "remove", " ", "all", " ", "the", " ", "variables", " ", 
           "that", " ", "are", " ", "dummy"}], ",", " ", 
          RowBox[{"i", ".", "e", ".", " ", 
           RowBox[{"{", 
            RowBox[{"\[Pi]", ",", "\[Mu]", ",", "J"}], "}"}], ".", 
           "\[IndentingNewLine]", "ATTENTION"}], ",", " ", 
          RowBox[{
          "we", " ", "also", " ", "have", " ", "to", " ", "filter", " ", 
           "the", " ", "variable", " ", 
           RowBox[{"\[Pi]", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listvar", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"listvar", "//", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", "\[Pi]"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{"#", ",", "\[Mu]"}], "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", "J"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", ",", " ", 
          RowBox[{
          "in", " ", "this", " ", "list", " ", "of", " ", "variables"}], ",", 
          " ", 
          RowBox[{
          "we", " ", "split", " ", "the", " ", "variables", " ", "among", " ",
            "the", " ", "action", " ", "ones", " ", "and", " ", "the", " ", 
           "wavenumber", " ", 
           RowBox[{"ones", ".", "\[IndentingNewLine]", "This"}], " ", "split",
            " ", "is", " ", "made", " ", "by", " ", "selecting", " ", "the", 
           " ", "variables", " ", "that", " ", "start", " ", "with", " ", "v",
            " ", "or", " ", "with", " ", 
           RowBox[{"\[Omega]", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "List", " ", "of", " ", "the", " ", "velocities", " ", "that", " ", 
          RowBox[{"appear", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listActOLD", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"listvar", ",", "ActionQ"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "List", " ", "of", " ", "the", " ", "wavenumbers", " ", "that", " ", 
          
          RowBox[{"appear", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listWaveOLD", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"listvar", ",", "WaveQ"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "now", " ", "decide", " ", "of", " ", "what", " ", 
           "will", " ", "be", " ", "the", " ", "new", " ", "variables", " ", 
           "associated", " ", "with", " ", "the", " ", "old", " ", 
           RowBox[{"ones", ".", "\[IndentingNewLine]", "In"}], " ", 
           "essence"}], ",", " ", 
          RowBox[{
          "we", " ", "count", " ", "the", " ", "total", " ", "number", " ", 
           "of", " ", "variables", " ", "present"}], ",", " ", 
          RowBox[{
          "and", " ", "we", " ", "start", " ", "the", " ", "new", " ", 
           "dummy", " ", "variables", " ", "at", " ", "1."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"listActNEW", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<J\>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "@", "listActOLD"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listWaveNEW", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<k\>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "@", "listWaveOLD"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "now", " ", "join", " ", "the", " ", "lists", " ", 
          "together", " ", "to", " ", "make", " ", "the", " ", "full", " ", 
          "lists", " ", "of", " ", "the", " ", "old", " ", "variables", " ", 
          "and", " ", "the", " ", "new", " ", 
          RowBox[{"ones", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listOLD", " ", "=", " ", 
         RowBox[{"listActOLD", "~", "Join", "~", "listWaveOLD"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"listNEW", " ", "=", " ", 
         RowBox[{"listActNEW", "~", "Join", "~", "listWaveNEW"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Making", " ", "the", " ", "replacement", " ", "of", " ", 
           "variables", " ", "and", " ", 
           RowBox[{"output", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",",
           " ", 
          RowBox[{
          "we", " ", "rely", " ", "on", " ", "the", " ", "fact", " ", "that", 
           " ", "INT", " ", "always", " ", "sorts", " ", "its", " ", 
           "integration", " ", 
           RowBox[{"arguments", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ReplaceVariables", "[", 
         RowBox[{"exp", ",", "listOLD", ",", "listNEW"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Wrapped", " ", "function", " ", "that", " ", "applies", " ", "the", " ",
       "relabelling", " ", "to", " ", "all", " ", "the", " ", "terms", " ", 
      "of", " ", "a", " ", "large", " ", "sum", " ", "of", " ", 
      RowBox[{"terms", ".", "\[IndentingNewLine]", "To"}], " ", "do", " ", 
      "so"}], ",", " ", 
     RowBox[{
     "we", " ", "transform", " ", "the", " ", "integrand", " ", "into", " ", 
      "a", " ", "list", " ", "of", " ", "terms"}], ",", " ", 
     RowBox[{
     "apply", " ", "the", " ", "relabelling", " ", "to", " ", "each", " ", 
      "term"}], ",", " ", 
     RowBox[{"and", " ", "then", " ", "sum", " ", 
      RowBox[{"again", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WrappedRelabelDummy", "[", "integrand_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"listintegrand", ",", "res"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "List", " ", "of", " ", "the", " ", "terms", " ", "in", " ", "the", 
         " ", 
         RowBox[{"integrand", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"listintegrand", " ", "=", " ", 
         RowBox[{"List", "@@", 
          RowBox[{"(", 
           RowBox[{"Expand", "@", "integrand"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Applying", " ", "the", " ", "relabelling", " ", "to", " ", "each", 
          " ", 
          RowBox[{"term", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listintegrand", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"RelabelDummy", "/@", "listintegrand"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Transforming", " ", "the", " ", "list", " ", "back", " ", "into", 
          " ", "a", " ", 
          RowBox[{"sum", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Plus", "@@", "listintegrand"}], ")"}], "//", "Expand"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"res", "//", "Expand"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "returns", " ", "all", " ", "the", " ", 
      "variables", " ", "appearing", " ", "in", " ", "an", " ", 
      RowBox[{"expression", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "we", " ", "do", " ", "not", " ", "return", " ", "\[Pi]", " ", "and", 
      " ", "\[Mu]", " ", "as", " ", 
      RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetVariables", "[", "exp_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"DeleteDuplicates", "@", 
         RowBox[{"Cases", "[", 
          RowBox[{"exp", ",", "_Symbol", ",", "Infinity"}], "]"}]}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\[Pi]"}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{"#", ",", "\[Mu]"}], "]"}], "&"}]}], "//", "Sort"}]}], 
    ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.7814301708169327`*^9, 3.7814301914100237`*^9}, {
   3.781430226289014*^9, 3.781430247656332*^9}, {3.7814304562734833`*^9, 
   3.781430726472575*^9}, {3.781430797724547*^9, 3.781430924578383*^9}, {
   3.781430975347542*^9, 3.781431073156333*^9}, {3.781431111777171*^9, 
   3.7814312417386208`*^9}, {3.781431697489606*^9, 3.781431699337843*^9}, {
   3.78143174549691*^9, 3.781431800462129*^9}, {3.781431864460678*^9, 
   3.7814320345105543`*^9}, {3.781432143692227*^9, 3.7814321672735767`*^9}, {
   3.7814322877342043`*^9, 3.781432313564786*^9}, {3.781432367763838*^9, 
   3.781432489278366*^9}, {3.781432526269823*^9, 3.7814325970832863`*^9}, {
   3.781432689073284*^9, 3.781432740509657*^9}, {3.78143277862096*^9, 
   3.78143296546894*^9}, {3.781433063033555*^9, 3.7814330659626617`*^9}, {
   3.781433282428389*^9, 3.781433304424911*^9}, {3.781433513675275*^9, 
   3.7814335209469624`*^9}, {3.78143355181155*^9, 3.781433553233719*^9}, {
   3.781433592930517*^9, 3.781433595904573*^9}, {3.781433652056321*^9, 
   3.781433771146442*^9}, {3.7814338922267427`*^9, 3.78143389267815*^9}, {
   3.781434071255638*^9, 3.7814340778011837`*^9}, {3.781434157103857*^9, 
   3.781434210580402*^9}, {3.781497467821982*^9, 3.781497471956396*^9}, {
   3.7814975326274014`*^9, 3.7814975390586*^9}, {3.781497736100523*^9, 
   3.781497815194146*^9}, 3.781497876840273*^9, {3.7814980830744133`*^9, 
   3.781498083207632*^9}, {3.78149817468552*^9, 3.781498179260975*^9}, {
   3.781498382007021*^9, 3.781498391341082*^9}, {3.781498421940816*^9, 
   3.781498422477014*^9}, {3.781498467541527*^9, 3.7814984718430557`*^9}, {
   3.7814985080336113`*^9, 3.7814985111480618`*^9}, {3.781498943379747*^9, 
   3.781498945811163*^9}, {3.781499199690942*^9, 3.7814992213541317`*^9}, {
   3.7814993059442263`*^9, 3.781499336134385*^9}, {3.781499367356615*^9, 
   3.781499368501259*^9}, {3.781499410605797*^9, 3.7814994750179567`*^9}, {
   3.781499534594421*^9, 3.7814995575458317`*^9}, {3.781500096078546*^9, 
   3.781500114598963*^9}, {3.781500791866745*^9, 3.7815008388718157`*^9}, 
   3.781502684860592*^9, 3.781506438562708*^9, 3.781507417607469*^9, {
   3.7815076215296383`*^9, 3.781507632431188*^9}, {3.781507736693327*^9, 
   3.781508028104466*^9}, {3.7815080624168663`*^9, 3.781508100460643*^9}, {
   3.782037469013254*^9, 3.782037469290668*^9}, {3.782039464629642*^9, 
   3.7820394647998343`*^9}, {3.7821089723424387`*^9, 3.782108973650978*^9}, {
   3.7834256639842777`*^9, 3.7834258463990393`*^9}, {3.7834258978655987`*^9, 
   3.783425988091784*^9}, {3.7834260858905478`*^9, 3.7834261441361513`*^9}, {
   3.7834262049629917`*^9, 3.783426205686921*^9}, {3.7848783644485207`*^9, 
   3.784878496386601*^9}, {3.7850685543598623`*^9, 3.785068554618578*^9}, {
   3.785073397326551*^9, 3.785073414237671*^9}, {3.785073484013177*^9, 
   3.7850734959790792`*^9}, 3.785073593129331*^9, {3.785128193088807*^9, 
   3.785128235613318*^9}, {3.785128320666822*^9, 3.785128428594616*^9}, {
   3.785128582040456*^9, 3.785128621298697*^9}, {3.7851288044828043`*^9, 
   3.785128807627275*^9}, {3.785138671869269*^9, 3.785138682167266*^9}, {
   3.785587748440673*^9, 3.785587754348287*^9}, 3.788235005121944*^9, {
   3.7882581370900784`*^9, 3.788258137210808*^9}, {3.788494174727895*^9, 
   3.788494175271209*^9}, {3.793535049534096*^9, 3.7935352631298122`*^9}, {
   3.793789930124261*^9, 3.793789997430979*^9}, {3.7937906960084877`*^9, 
   3.793790698364213*^9}, {3.798978266194871*^9, 3.798978747205517*^9}, {
   3.799145107553334*^9, 3.799145135319466*^9}, {3.799565920608837*^9, 
   3.799565961314191*^9}, {3.799566746693445*^9, 3.799566749338952*^9}, {
   3.799586659413625*^9, 3.7995866912376003`*^9}, {3.7996396938588037`*^9, 
   3.799640156527219*^9}, {3.7999314971948442`*^9, 3.799931747611269*^9}, {
   3.799932957617201*^9, 3.7999331092534323`*^9}, {3.799933141126863*^9, 
   3.799933246688122*^9}, {3.8607315646479187`*^9, 3.860731564896397*^9}, {
   3.860731610626856*^9, 3.8607316313134823`*^9}, {3.8607317420306253`*^9, 
   3.860731742149588*^9}, 3.8607326797185*^9, {3.8607454590642014`*^9, 
   3.860745459241191*^9}, {3.8612736986572647`*^9, 3.8612738610209923`*^9}, {
   3.86617910449579*^9, 3.866179104907703*^9}, {3.866179514832676*^9, 
   3.8661795717917767`*^9}, {3.866179602547265*^9, 3.866179655865868*^9}, {
   3.866179695001315*^9, 3.8661797085692587`*^9}, {3.86617977974529*^9, 
   3.8661798746081743`*^9}, {3.8661802062823772`*^9, 3.866180233762838*^9}, {
   3.866180268153009*^9, 3.866180311392685*^9}, {3.866180344088676*^9, 
   3.866180377703993*^9}, {3.866187637998824*^9, 3.866187638714745*^9}, {
   3.8661876824875927`*^9, 3.866187818224848*^9}, {3.866519977391705*^9, 
   3.866519977535479*^9}, {3.866520050092773*^9, 3.866520095750951*^9}, {
   3.8665201411515303`*^9, 3.8665201447766047`*^9}, {3.866520179387705*^9, 
   3.866520181696012*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["2/ BBGKY HIERARCHY", "Subsubsection"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.798979059343989*^9, 3.79897908079394*^9}, 
   3.799145162363421*^9, {3.8661787505221777`*^9, 3.8661787518178473`*^9}, 
   3.8661788557541323`*^9, {3.866179010180572*^9, 3.866179010460334*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"In", " ", "this", " ", "section"}], ",", " ", 
    RowBox[{
    "we", " ", "derive", " ", "the", " ", "BBGKY", " ", "evolution", " ", 
     "equations", " ", "for", " ", "the", " ", "correlation", " ", 
     RowBox[{"functions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "that", " ", "for", " ", "a", " ", "given", " ", 
    "integer", " ", "n", " ", "returns", " ", "the", " ", "list", " ", "of", 
    " ", "symbols", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", "...", ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]n", ",", "Jn"}], "}"}]}], "}"}], "."}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GetSymbols", "[", "n_", "]"}], ":=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Symbol", "[", 
          RowBox[{"\"\<\[Theta]\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
         RowBox[{"Symbol", "[", 
          RowBox[{"\"\<J\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "returns", " ", "the", " ", "reduced", " ", 
     "DF", " ", "of", " ", "order", " ", 
     RowBox[{"n", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Fn", "[", "n_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "lsymb", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Getting", " ", "the", " ", "list", " ", "of", " ", "the", " ", 
         "symbols", " ", "to", " ", 
         RowBox[{"use", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lsymb", " ", "=", " ", 
         RowBox[{"GetSymbols", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Output", ".", "\[IndentingNewLine]", "ATTENTION"}], ",", 
          " ", 
          RowBox[{"we", " ", "also", " ", "add", " ", 
           RowBox[{"`t", "'"}], " ", "as", " ", "the", " ", "last", " ", 
           RowBox[{"variable", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"F", "[", 
         RowBox[{"lsymb", ",", "t"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Definition", " ", "of", " ", "the", " ", "n"}], "-", 
     RowBox[{
     "body", " ", "Hamiltonian", " ", "appearing", " ", "in", " ", "the", " ",
       "BBGKY", " ", "equation", " ", "of", " ", "order", " ", 
      RowBox[{"n", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Hn", "[", "n_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lsymb", ",", "Hloc"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Getting", " ", "the", " ", "list", " ", "of", " ", "symbols", " ", 
         "to", " ", 
         RowBox[{"use", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lsymb", " ", "=", " ", 
         RowBox[{"GetSymbols", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{"Initialising", " ", "the", " ", 
          RowBox[{"Hamiltonian", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Hloc", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Adding", " ", "the", " ", "part", " ", "associated", " ", "with", 
          " ", "the", " ", "external", " ", 
          RowBox[{"potential", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Hloc", " ", "+=", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Uext", "[", 
            RowBox[{"lsymb", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Adding", " ", "the", " ", "interaction", " ", 
           RowBox[{"energy", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",",
           " ", 
          RowBox[{"to", " ", "avoid", " ", "confusion"}], ",", " ", 
          RowBox[{
           RowBox[{
           "we", " ", "add", " ", "explicitly", " ", "the", " ", "step", " ", 
            "of", " ", "`"}], "+", 
           RowBox[{
            RowBox[{"1", "'"}], " ", "in", " ", "the", " ", "two", " ", 
            RowBox[{"indices", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Hloc", " ", "+=", " ", 
         RowBox[{"\[Mu]", " ", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"UPot", "[", 
             RowBox[{
              RowBox[{"lsymb", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"lsymb", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"i", "+", "1"}], ",", "n", ",", "1"}], "}"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", "Hloc"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Definition", " ", "of", " ", "the", " ", "interaction", " ", 
     "Hamiltonian", " ", "of", " ", "order", " ", 
     RowBox[{"n", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]Hn", "[", "n_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lsymb", ",", "\[Delta]Hloc"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Getting", " ", "the", " ", "list", " ", "of", " ", "the", " ", 
         "symbols", " ", "to", " ", 
         RowBox[{"use", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lsymb", " ", "=", " ", 
         RowBox[{"GetSymbols", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Adding", " ", "all", " ", "the", " ", "interaction", " ", 
           RowBox[{"energies", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
          ",", " ", 
          RowBox[{"there", " ", "are", " ", "no", " ", "\[Mu]", " ", 
           RowBox[{"prefactors", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
          ",", " ", 
          RowBox[{"it", " ", "only", " ", "goes", " ", "up", " ", "to", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Delta]Hloc", " ", "=", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"UPot", "[", 
            RowBox[{
             RowBox[{"lsymb", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"lsymb", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"n", "-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        "\[Delta]Hloc"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Definition", " ", "of", " ", "the", " ", "Poisson", " ", 
     RowBox[{"bracket", " ", "[", 
      RowBox[{"F", ",", "H"}], "]"}], " ", "of", " ", "order", " ", 
     RowBox[{"n", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PoissonBracket", "[", 
      RowBox[{"n_", ",", "F_", ",", "H_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lsymb", ",", "res", ",", "\[Theta]i", ",", "Ji"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Getting", " ", "the", " ", "list", " ", "of", " ", "symbols", " ", 
         "to", " ", 
         RowBox[{"use", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lsymb", " ", "=", " ", 
         RowBox[{"GetSymbols", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{"Computing", " ", "the", " ", 
          RowBox[{"derivatives", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Sum", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]i", " ", "=", " ", 
             RowBox[{"lsymb", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Ji", " ", "=", " ", 
             RowBox[{"lsymb", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"DER", "[", 
               RowBox[{"F", ",", "\[Theta]i"}], "]"}], " ", 
              RowBox[{"DER", "[", 
               RowBox[{"H", ",", "Ji"}], "]"}]}], " ", "-", " ", 
             RowBox[{
              RowBox[{"DER", "[", 
               RowBox[{"F", ",", "Ji"}], "]"}], 
              RowBox[{"DER", "[", 
               RowBox[{"H", ",", "\[Theta]i"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Definition", " ", "of", " ", "the", " ", "BBGKY", " ", "equation", " ", 
     "for", " ", 
     RowBox[{"Fn", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BBGKY", "[", "n_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "lsymb", ",", "Floc", ",", "Flocnext", ",", "Hloc", ",", 
         "\[Delta]Hloc", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Getting", " ", "the", " ", "list", " ", "of", " ", 
          RowBox[{"symbols", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",",
          " ", 
         RowBox[{
          RowBox[{
          "we", " ", "get", " ", "the", " ", "list", " ", "of", " ", 
           "symbols", " ", "to", " ", "order", " ", "n"}], "+", "1."}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lsymb", " ", "=", " ", 
         RowBox[{"GetSymbols", "[", 
          RowBox[{"n", "+", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Getting", " ", "the", " ", "reduced", " ", 
          RowBox[{"DFs", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Floc", " ", "=", " ", 
         RowBox[{"Fn", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Flocnext", " ", "=", " ", 
         RowBox[{"Fn", "[", 
          RowBox[{"n", "+", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Getting", " ", "the", " ", "n"}], "-", 
          RowBox[{"body", " ", 
           RowBox[{"Hamiltonian", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Hloc", " ", "=", " ", 
         RowBox[{"Hn", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Getting", " ", "the", " ", "interaction", " ", 
           RowBox[{"Hamiltonian", ".", "\[IndentingNewLine]", "ATTENTION"}]}],
           ",", " ", 
          RowBox[{
           RowBox[{"it", " ", "is", " ", "of", " ", "order", " ", "n"}], "+", 
           "1."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Delta]Hloc", " ", "=", " ", 
         RowBox[{"\[Delta]Hn", "[", 
          RowBox[{"n", "+", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"BBGKY", " ", "equation", " ", "of", " ", "order", " ", 
           RowBox[{"n", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
          RowBox[{
           RowBox[{"the", " ", "integral", " ", "is", " ", "performed", " ", 
            RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", 
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}]}], "-", "coordinate"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"DER", "[", 
            RowBox[{"Floc", ",", "t"}], "]"}], " ", "+", " ", 
           RowBox[{"PoissonBracket", "[", 
            RowBox[{"n", ",", "Floc", ",", "Hloc"}], "]"}], " ", "+", " ", 
           RowBox[{"INT", "[", 
            RowBox[{
             RowBox[{"PoissonBracket", "[", 
              RowBox[{"n", ",", "Flocnext", ",", "\[Delta]Hloc"}], "]"}], ",", 
             RowBox[{"lsymb", "[", 
              RowBox[{"[", 
               RowBox[{"n", "+", "1"}], "]"}], "]"}]}], "]"}]}], " ", 
          "\[Equal]", "0"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Expanding", " ", "the", " ", 
          RowBox[{"result", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"res", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Definition", " ", "of", " ", "the", " ", "replacement", " ", "rules", 
     " ", "to", " ", "introduce", " ", "the", " ", "cluster", " ", 
     RowBox[{"representation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Introduction", " ", "of", " ", 
     RowBox[{"G2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleClusterF2", " ", "=", " ", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]1_", ",", "J1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]2_", ",", "J2_"}], "}"}]}], "}"}], ",", "t_"}], 
       "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"G", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], 
         "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Introduction", " ", "of", " ", 
     RowBox[{"G3", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleClusterF3", " ", "=", " ", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]1_", ",", "J1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]2_", ",", "J2_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]3_", ",", "J3_"}], "}"}]}], "}"}], ",", "t_"}], 
       "]"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]3", ",", "J3"}], "}"}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]3", ",", "J3"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"G", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
         "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Introduction", " ", "of", " ", 
     RowBox[{"G4", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleClusterF4", " ", "=", " ", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]1_", ",", "J1_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]2_", ",", "J2_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]3_", ",", "J3_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]4_", ",", "J4_"}], "}"}]}], "}"}], ",", "t_"}], 
       "]"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]3", ",", "J3"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]4", ",", "J4"}], "}"}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]4", ",", "J4"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]3", ",", "J3"}], "}"}], "}"}], ",", "t"}], 
          "]"}], 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]4", ",", "J4"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]4", ",", "J4"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]3", ",", "J3"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]4", ",", "J4"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]4", ",", "J4"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]3", ",", "J3"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]4", ",", "J4"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]4", ",", "J4"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]4", ",", "J4"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]3", ",", "J3"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]4", ",", "J4"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"F", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\[Theta]4", ",", "J4"}], "}"}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]4", ",", "J4"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]4", ",", "J4"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]4", ",", "J4"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}], " ", 
         RowBox[{"G", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
          "]"}]}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"G", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]3", ",", "J3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]4", ",", "J4"}], "}"}]}], "}"}], ",", "t"}], 
         "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "write", " ", "the", " ", "first", " ", "BBGKY", " ", 
     "equations", " ", "expressed", " ", "only", " ", "in", " ", "terms", " ",
      "of", " ", 
     RowBox[{"F", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKY1", " ", "=", " ", 
     RowBox[{
      RowBox[{"BBGKY", "[", "1", "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKY2", " ", "=", " ", 
     RowBox[{
      RowBox[{"BBGKY", "[", "2", "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKY3", " ", "=", " ", 
     RowBox[{
      RowBox[{"BBGKY", "[", "3", "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "use", " ", "the", " ", "cluster", " ", 
      "expansion", " ", "so", " ", "that", " ", "these", " ", "equations", 
      " ", "only", " ", "involve", " ", "F1"}], ",", " ", "G2", ",", " ", 
     "G3", ",", " ", 
     RowBox[{"and", " ", 
      RowBox[{"G4", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKY1", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKY1", "/.", "RuleClusterF2"}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKY2", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKY2", "/.", 
        RowBox[{"{", 
         RowBox[{"RuleClusterF2", ",", "RuleClusterF3"}], "}"}]}], ")"}], "//",
       "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKY3", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKY3", "/.", 
        RowBox[{"{", 
         RowBox[{
         "RuleClusterF2", ",", "RuleClusterF3", ",", "RuleClusterF4"}], 
         "}"}]}], ")"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Our", " ", "goal", " ", "is", " ", "now", " ", "to", " ", "obtain", " ",
       "the", " ", "evolution", " ", "equations", " ", "for", " ", 
      RowBox[{"dF1", "/", "dt"}]}], ",", " ", 
     RowBox[{"dG2", "/", "dt"}], ",", " ", 
     RowBox[{"and", " ", 
      RowBox[{"dG3", "/", 
       RowBox[{"dt", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Evolution", " ", "equation", " ", "for", " ", 
      RowBox[{"dF1", "/", 
       RowBox[{"dt", ".", "\[IndentingNewLine]", "In"}]}], " ", "that", " ", 
      "expression"}], ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]1", ",", "J1"}], "}"}], " ", "are", " ", "the", " ", 
      "outside", " ", "variables"}], ",", " ", 
     RowBox[{"and", " ", 
      RowBox[{"{", 
       RowBox[{"\[Theta]2", ",", "J2"}], "}"}], " ", "are", " ", "the", " ", 
      "integrated", " ", 
      RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"BBGKY1", ",", 
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "}"}], ",", "t"}], 
           "]"}], ",", "t"}], "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "put", " ", "everything", " ", "back", " ", "in", " ", "one", 
     " ", "equation", " ", "with", " ", "the", " ", "rhs", " ", "equal", " ", 
     "to", " ", "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYF", " ", "=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "}"}], ",", "t"}], 
           "]"}], ",", "t"}], "]"}], "-", "dFdt"}], "\[Equal]", "0"}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Evolution", " ", "equation", " ", "for", " ", 
      RowBox[{"dG2", "/", 
       RowBox[{"dt", ".", "\[IndentingNewLine]", "In"}]}], " ", "that", " ", 
      "expression"}], ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]2", ",", "J2"}], "}"}]}], "}"}], " ", "are", " ", 
      "the", " ", "outside", " ", "variables"}], ",", " ", 
     RowBox[{"and", " ", 
      RowBox[{"{", 
       RowBox[{"\[Theta]3", ",", "J3"}], "}"}], " ", "are", " ", "the", " ", 
      "integrated", " ", 
      RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG2dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"BBGKY2", ",", 
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], 
           "]"}], ",", "t"}], "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Now", ",", " ", 
     RowBox[{
     "we", " ", "replace", " ", "the", " ", "occurrences", " ", "of", " ", 
      RowBox[{"dF", "/", "dt"}]}], ",", " ", 
     RowBox[{"using", " ", 
      RowBox[{"{", 
       RowBox[{"\[Theta]3", ",", "J3"}], "}"}], " ", "as", " ", "the", " ", 
      "integration", " ", 
      RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG2dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dG2dt", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DER", "[", 
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"\[Theta]a_", ",", "Ja_"}], "}"}], "}"}], ",", "t"}], 
             "]"}], ",", "t"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"dFdt", ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1", ",", "\[Theta]2", ",", "J2"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]a", ",", "Ja", ",", "\[Theta]3", ",", "J3"}], 
             "}"}]}], "]"}]}], "}"}]}], ")"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "put", " ", "everything", " ", "back", " ", "in", " ", "one", 
     " ", "equation", " ", "with", " ", "the", " ", "rhs", " ", "equal", " ", 
     "to", " ", "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG2", " ", "=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], 
           "]"}], ",", "t"}], "]"}], "-", "dG2dt"}], "\[Equal]", "0"}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Evolution", " ", "equation", " ", "for", " ", 
      RowBox[{"dG3", "/", 
       RowBox[{"dt", ".", "\[IndentingNewLine]", "In"}]}], " ", "that", " ", 
      "expression"}], ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], " ", "are", " ", 
      "the", " ", "outside", " ", "variables"}], ",", " ", 
     RowBox[{"and", " ", 
      RowBox[{"{", 
       RowBox[{"\[Theta]4", ",", "J4"}], "}"}], " ", "are", " ", "the", " ", 
      "integrated", " ", 
      RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG3dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"BBGKY3", ",", 
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
           "]"}], ",", "t"}], "]"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Now", ",", " ", 
     RowBox[{
     "we", " ", "replace", " ", "the", " ", "occurrences", " ", "of", " ", 
      RowBox[{"dF", "/", "dt"}]}], ",", " ", 
     RowBox[{"using", " ", 
      RowBox[{"{", 
       RowBox[{"\[Theta]4", ",", "v4"}], "}"}], " ", "as", " ", "the", " ", 
      "integration", " ", 
      RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG3dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dG3dt", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DER", "[", 
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"\[Theta]a_", ",", "Ja_"}], "}"}], "}"}], ",", "t"}], 
             "]"}], ",", "t"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"dFdt", ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "J1", ",", "\[Theta]2", ",", "J2"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]a", ",", "Ja", ",", "\[Theta]4", ",", "J4"}], 
             "}"}]}], "]"}]}], "}"}]}], ")"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "replace", " ", "the", " ", "occurrences", " ", "of", " ", 
      RowBox[{"dG2", "/", "dt"}]}], ",", " ", 
     RowBox[{"using", " ", 
      RowBox[{"{", 
       RowBox[{"\[Theta]4", ",", "J4"}], "}"}], " ", "as", " ", "the", " ", 
      "integration", " ", 
      RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG3dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dG3dt", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DER", "[", 
           RowBox[{
            RowBox[{"G", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\[Theta]a_", ",", "Ja_"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]b_", ",", "Jb_"}], "}"}]}], "}"}], ",", 
              "t"}], "]"}], ",", "t"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"dG2dt", ",", 
            RowBox[{"{", 
             RowBox[{
             "\[Theta]1", ",", "J1", ",", "\[Theta]2", ",", "J2", ",", 
              "\[Theta]3", ",", "J3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\[Theta]a", ",", "Ja", ",", "\[Theta]b", ",", "Jb", ",", 
              "\[Theta]4", ",", "J4"}], "}"}]}], "]"}]}], "}"}]}], ")"}], "//",
       "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "put", " ", "everything", " ", "back", " ", "in", " ", "one", 
     " ", "equation", " ", "with", " ", "the", " ", "rhs", " ", "equal", " ", 
     "to", " ", "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3", " ", "=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"G", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]2", ",", "J2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
           "]"}], ",", "t"}], "]"}], "-", "dG3dt"}], "\[Equal]", "0"}], 
      ")"}]}], ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.7989791736587667`*^9, 3.7989792719597063`*^9}, {
   3.798979370597043*^9, 3.798979552057316*^9}, {3.79897958861471*^9, 
   3.798979701556753*^9}, {3.798980057076523*^9, 3.798980061703682*^9}, {
   3.798980131832254*^9, 3.798980324900776*^9}, {3.7989804480470247`*^9, 
   3.798980449702183*^9}, {3.799062395023677*^9, 3.799062760469369*^9}, {
   3.799062917197125*^9, 3.79906302938725*^9}, {3.799063075107222*^9, 
   3.799063084810788*^9}, {3.799063131646989*^9, 3.799063154382086*^9}, {
   3.799063188555951*^9, 3.799063428620921*^9}, {3.799063576816475*^9, 
   3.799064024309002*^9}, {3.79906437219177*^9, 3.799064741540472*^9}, 
   3.799145162365746*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["3/ TRUNCATION AT ORDER 1/N^2", "Subsubsection"]], \
"Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.799064923428533*^9, 3.799064942445668*^9}, 
   3.79949621278997*^9, 3.866178756978006*^9, {3.866178862818331*^9, 
   3.866178866274074*^9}, {3.866179011245122*^9, 3.866179011492856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"In", " ", "this", " ", "section"}], ",", " ", 
    RowBox[{
    "we", " ", "truncate", " ", "the", " ", "kinetic", " ", "equations", " ", 
     "at", " ", "order", " ", 
     RowBox[{"1", "/", 
      RowBox[{"N", "^", "2."}]}], "\[IndentingNewLine]", "The", " ", 
     "starting", " ", "points", " ", "are", " ", "BBGKYF"}], ",", " ", 
    "BBGKYG2", ",", " ", 
    RowBox[{"BBGKYG3", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", "BBGKYF"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG2CALC", " ", "=", " ", "BBGKYG2"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", "BBGKYG3"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "We", " ", "clarify", " ", "the", " ", "notations", " ", "by", " ", 
       "writing", " ", 
       RowBox[{"G", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]2", ",", "J2"}], "}"}]}], "}"}], "]"}]}], 
      "\[RuleDelayed]", 
      RowBox[{"G2", "[", "...", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "similarly", " ", "for", " ", "the", " ", "other", " ", "correlation", 
      " ", 
      RowBox[{"functions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleNameG", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "[", 
        RowBox[{"A_", ",", "t_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<G\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Length", "@", "A"}], "]"}]}], "]"}], "[", 
        RowBox[{"A", ",", "t"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYFCALC", "/.", "RuleNameG"}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG2CALC", "  ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG2CALC", "/.", "RuleNameG"}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", "RuleNameG"}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "introduce", " ", "the", " ", "small", " ", 
      "parameter", " ", 
      RowBox[{"\[CurlyEpsilon]", " ", "\\", "propto"}], " ", 
      RowBox[{"1", "/", "N"}]}], ",", " ", 
     RowBox[{
     "to", " ", "keep", " ", "track", " ", "of", " ", "the", " ", "order", 
      " ", "of", " ", "the", " ", 
      RowBox[{"terms", ".", "\[IndentingNewLine]", "Importantly"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"we", " ", "split", " ", "the", " ", "2"}], "-", 
      RowBox[{
      "body", " ", "correlation", " ", "function", " ", "in", " ", "two", " ",
        "components"}]}], ",", " ", 
     RowBox[{
      RowBox[{"so", " ", "that", " ", "G2"}], "\[RuleDelayed]", 
      RowBox[{"\[CurlyEpsilon]G21", "+", 
       RowBox[{
        RowBox[{"\[CurlyEpsilon]", "^", 
         RowBox[{"(", "2", ")"}]}], 
        RowBox[{"G22", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesEpsilon", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Mu]", " ", "\[RuleDelayed]", " ", 
        RowBox[{"\[CurlyEpsilon]", " ", "\[Mu]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"G2", "[", 
         RowBox[{"A_", ",", "t_"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[CurlyEpsilon]", " ", 
           RowBox[{"G21", "[", 
            RowBox[{"A", ",", "t"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[CurlyEpsilon]", "^", 
            RowBox[{"(", "2", ")"}]}], 
           RowBox[{"G22", "[", 
            RowBox[{"A", ",", "t"}], "]"}]}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"G3", "[", 
         RowBox[{"A_", ",", "t_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"\[CurlyEpsilon]", "^", 
          RowBox[{"(", "2", ")"}]}], " ", 
         RowBox[{"G3", "[", 
          RowBox[{"A", ",", "t"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"G4", "[", 
         RowBox[{"A_", ",", "t_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"\[CurlyEpsilon]", "^", 
          RowBox[{"(", "3", ")"}]}], " ", 
         RowBox[{"G4", "[", 
          RowBox[{"A", ",", "t"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYFCALC", "/.", "RulesEpsilon"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG2CALC", "  ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG2CALC", "/.", "RulesEpsilon"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", "RulesEpsilon"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "cut", " ", "all", " ", "the", " ", "equations", 
      " ", "at", " ", "order", " ", 
      RowBox[{"\[CurlyEpsilon]", "^", 
       RowBox[{"(", "2", ")"}]}]}], "=", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"N", "^", "2."}]}], "\[IndentingNewLine]", "We", " ", "also", 
      " ", "use", " ", 
      RowBox[{"Normal", "[", "..", "]"}], " ", "to", " ", "get", " ", "rid", 
      " ", "of", " ", "the", " ", 
      RowBox[{
       RowBox[{"O", "[", 
        RowBox[{"\[CurlyEpsilon]", "^", 
         RowBox[{"(", "3", ")"}]}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"BBGKYFCALC", "//", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], 
         "&"}]}], "//", "Normal"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG2CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"BBGKYG2CALC", "//", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], 
         "&"}]}], "//", "Normal"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"BBGKYG3CALC", "//", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], 
         "&"}]}], "//", "Normal"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "split", " ", "the", " ", "evolution", " ", 
      "equation", " ", "for", " ", "G2", " ", "in", " ", "two", " ", 
      "evolution", " ", "equations"}], ",", " ", 
     RowBox[{"one", " ", "for", " ", "G21", " ", 
      RowBox[{"(", 
       RowBox[{"order", " ", "\[CurlyEpsilon]"}], ")"}], " ", "and", " ", 
      "one", " ", "for", " ", "G22", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"order", " ", 
         RowBox[{"\[CurlyEpsilon]", "^", 
          RowBox[{"(", "2", ")"}]}]}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", ",", " ", 
     RowBox[{"we", " ", "extract", " ", "the", " ", "lhs"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "we"}], " ", "remove", " ", "the", 
       " ", "`"}], "\[Equal]", 
      RowBox[{
       RowBox[{"0", "'"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"termsBBGKYG2CALC", " ", "=", " ", 
     RowBox[{"BBGKYG2CALC", "//", "First"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "List", " ", "of", " ", "the", " ", "coefficients", " ", "for", " ", 
     "the", " ", "polynomial", " ", "in", " ", 
     RowBox[{"\[CurlyEpsilon]", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffsBBGKYG2CALC", " ", "=", " ", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"termsBBGKYG2CALC", ",", "\[CurlyEpsilon]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Evolution", " ", "equation", " ", "for", " ", 
      RowBox[{"dG21", "/", 
       RowBox[{"dt", ".", "\[IndentingNewLine]", "ATTENTION"}]}]}], ",", " ", 
     
     RowBox[{"the", " ", "term", " ", "in", " ", 
      RowBox[{"\[CurlyEpsilon]", "^", 
       RowBox[{"(", "1", ")"}]}], " ", "is", " ", "given", " ", "by", " ", 
      "the", " ", "element", " ", "2", " ", "of", " ", "the", " ", 
      RowBox[{"coefficients", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
     ",", " ", 
     RowBox[{"for", " ", "completeness"}], ",", " ", 
     RowBox[{
      RowBox[{"we", " ", "also", " ", "re"}], "-", 
      RowBox[{"put", " ", "manually", " ", "the", " ", 
       RowBox[{
        RowBox[{"\[CurlyEpsilon]", "^", 
         RowBox[{"(", "1", ")"}]}], "."}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[CurlyEpsilon]", " ", 
         RowBox[{"coeffsBBGKYG2CALC", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", "0"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Evolution", " ", "equation", " ", "for", " ", 
      RowBox[{"dG22", "/", 
       RowBox[{"dt", ".", "\[IndentingNewLine]", "ATTENTION"}]}]}], ",", " ", 
     
     RowBox[{"the", " ", "term", " ", "in", " ", 
      RowBox[{"\[CurlyEpsilon]", "^", 
       RowBox[{"(", "2", ")"}]}], " ", "is", " ", "given", " ", "by", " ", 
      "the", " ", "element", " ", "3", " ", "of", " ", "the", " ", 
      RowBox[{"coefficients", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
     ",", " ", 
     RowBox[{"for", " ", "completeness"}], ",", " ", 
     RowBox[{
      RowBox[{"we", " ", "also", " ", "re"}], "-", 
      RowBox[{"put", " ", "manually", " ", "the", " ", 
       RowBox[{
        RowBox[{"\[CurlyEpsilon]", "^", 
         RowBox[{"(", "2", ")"}]}], "."}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CurlyEpsilon]", "^", 
          RowBox[{"(", "2", ")"}]}], " ", 
         RowBox[{"coeffsBBGKYG2CALC", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "\[Equal]", "0"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Having", " ", "performed", " ", "all", " ", "the", " ", "truncations", 
      " ", "and", " ", "developments", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", "\[CurlyEpsilon]"}]}], ",", 
     " ", 
     RowBox[{
     "we", " ", "may", " ", "put", " ", "\[CurlyEpsilon]", " ", "back", " ", 
      "to", " ", "1."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleEpsilonONE", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"\[CurlyEpsilon]", "\[RuleDelayed]", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYFCALC", "/.", "RuleEpsilonONE"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG21CALC", "/.", "RuleEpsilonONE"}], ")"}], "//", 
      "Expand"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG22CALC", "/.", "RuleEpsilonONE"}], ")"}], "//", 
      "Expand"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", "RuleEpsilonONE"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"We", " ", "now", " ", "assume", " ", "that", " ", "the", " ", 
       RowBox[{"system", "'"}], "s", " ", "1"}], "-", 
      RowBox[{
      "body", " ", "DF", " ", "is", " ", "in", " ", "a", " ", "quasi"}], "-", 
      
      RowBox[{"stationary", " ", "equilibrium"}]}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", 
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "J"}], "}"}], "}"}], ",", "t"}], "]"}]}], 
      "=", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"J", ",", "t"}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleQSSF", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\[Theta]_", ",", "J_"}], "}"}], "}"}], ",", "t_"}], "]"}],
        "\[RuleDelayed]", 
       RowBox[{"F", "[", 
        RowBox[{"J", ",", "t"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYFCALC", "/.", "RuleQSSF"}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG21CALC", "/.", "RuleQSSF"}], ")"}], "//", "Expand"}]}], 
    ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG22CALC", "/.", "RuleQSSF"}], ")"}], "//", "Expand"}]}], 
    ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", "RuleQSSF"}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "We", " ", "now", " ", "assume", " ", "that", " ", "the", " ", "mean"}],
       "-", 
      RowBox[{
      "field", " ", "potential", " ", "is", " ", "also", " ", "in", " ", 
       RowBox[{"equilibrium", ".", "\[IndentingNewLine]", "As"}], " ", "a", 
       " ", "result"}]}], ",", " ", 
     RowBox[{"oH", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Uext", "[", 
         RowBox[{"{", 
          RowBox[{"\[Theta]1", ",", "J1"}], "}"}], "]"}], "+", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"F", "[", "J2", "]"}], " ", 
           RowBox[{"UPot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]1", ",", "J1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]2", ",", "J2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]2", ",", "J2"}], "}"}]}], "]"}]}], " ", "=", " ", 
       
       RowBox[{
        RowBox[{"oH", "[", "J1", "]"}], "."}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleMeanField", " ", "=", "  ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Pushing", " ", "out", " ", "the", " ", "DER", " ", "of", " ", "the", 
         " ", "self"}], "-", 
        RowBox[{"gravitating", " ", 
         RowBox[{"potential", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DER", "[", 
            RowBox[{
             RowBox[{"UPot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Theta]a_", ",", "Ja_"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]b_", ",", "Jb_"}], "}"}]}], "]"}], ",", 
             "var_"}], "]"}], " ", 
           RowBox[{"F", "[", 
            RowBox[{"Jb_", ",", "t_"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]b_", ",", "Jb_"}], "}"}]}], "]"}], 
        "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"DER", "[", 
          RowBox[{
           RowBox[{"INT", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"UPot", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\[Theta]a", ",", "Ja"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]b", ",", "Jb"}], "}"}]}], "]"}], " ", 
              RowBox[{"F", "[", 
               RowBox[{"Jb", ",", "t"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]b", ",", "Jb"}], "}"}]}], "]"}], ",", "var"}], 
          "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"var", ",", "\[Theta]a"}], "]"}], "||", 
             RowBox[{"SameQ", "[", 
              RowBox[{"var", ",", "Ja"}], "]"}]}], ")"}], "&&", 
           RowBox[{"UnsameQ", "[", 
            RowBox[{"var", ",", "Jb"}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
          "Giving", " ", "a", " ", "name", " ", "to", " ", "the", " ", 
           "mass"}], "-", 
          RowBox[{"generated", " ", "mean"}], "-", 
          RowBox[{"field", " ", 
           RowBox[{"potential", ".", "\[IndentingNewLine]", "ATTENTION"}]}]}],
          ",", " ", 
         RowBox[{
          RowBox[{"we", " ", "assume", " ", "that", " ", "the", " ", "mass"}],
           "-", 
          RowBox[{"generated", " ", "mean"}], "-", 
          RowBox[{"field", " ", "potential", " ", "is", " ", "time"}], "-", 
          RowBox[{"independent", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"UPot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]a_", ",", "Ja_"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]b_", ",", "Jb_"}], "}"}]}], "]"}], " ", 
           RowBox[{"F", "[", 
            RowBox[{"Jb_", ",", "t_"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]b_", ",", "Jb_"}], "}"}]}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"Umf", "[", 
         RowBox[{"{", 
          RowBox[{"\[Theta]a", ",", "Ja"}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Gathering", " ", "the", " ", "Uext", " ", "and", " ", "Umf", " ", 
          RowBox[{"together", ".", "\[IndentingNewLine]", "To"}], " ", "do", 
          " ", "so"}], ",", " ", 
         RowBox[{
          RowBox[{"we", " ", "write", " ", "Htot"}], "=", 
          RowBox[{"Uext", "+", "Umf"}]}], ",", " ", 
         RowBox[{
          RowBox[{"so", " ", "that", " ", "Uext"}], "=", 
          RowBox[{"Htot", "-", 
           RowBox[{"Umf", ".", "\[IndentingNewLine]", "ATTENTION"}]}]}], ",", 
         " ", 
         RowBox[{
          RowBox[{"we", " ", "assume", " ", "that", " ", "the", " ", "mean"}],
           "-", 
          RowBox[{
          "field", " ", "potential", " ", "is", " ", "integrable", " ", "and",
            " ", "time"}], "-", "independent"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A_", " ", 
         RowBox[{"DER", "[", 
          RowBox[{
           RowBox[{"Uext", "[", 
            RowBox[{"{", 
             RowBox[{"\[Theta]a_", ",", "Ja_"}], "}"}], "]"}], ",", "var_"}], 
          "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", " ", 
           RowBox[{"DER", "[", 
            RowBox[{
             RowBox[{"Htot", "[", "Ja", "]"}], ",", "var"}], "]"}]}], "-", 
          RowBox[{"A", " ", 
           RowBox[{"DER", "[", 
            RowBox[{
             RowBox[{"Umf", "[", 
              RowBox[{"{", 
               RowBox[{"\[Theta]a", ",", "Ja"}], "}"}], "]"}], ",", "var"}], 
            "]"}]}]}], "/;", 
         RowBox[{"(", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Theta]a", ",", "Ja"}], "}"}], ",", "var"}], "]"}], 
          ")"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYFCALC", ",", "RuleMeanField"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG21CALC", ",", "RuleMeanField"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG22CALC", ",", "RuleMeanField"}], "]"}], "//", 
      "Expand"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG3CALC", ",", "RuleMeanField"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "replace", " ", "the", " ", "gradient", " ", "of",
       " ", "the", " ", "mean"}], "-", 
     RowBox[{
     "field", " ", "potential", " ", "with", " ", "the", " ", "orbital", " ", 
      
      RowBox[{"frequencies", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleOrbitalFreq", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DER", "[", 
        RowBox[{
         RowBox[{"Htot", "[", "J_", "]"}], ",", "J_"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYFCALC", ",", "RuleOrbitalFreq"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG21CALC", ",", "RuleOrbitalFreq"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG22CALC", ",", "RuleOrbitalFreq"}], "]"}], "//", 
      "Expand"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG3CALC", ",", "RuleOrbitalFreq"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "neglect", " ", "the", " ", "collective", " ", 
      "effects", " ", "in", " ", "the", " ", "evolution", " ", "equation", 
      " ", "for", " ", "G21"}], ",", " ", "G22", ",", " ", 
     RowBox[{"and", " ", 
      RowBox[{"G33", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG21CALC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{
            RowBox[{"A_", " ", 
             RowBox[{"G21", "[", 
              RowBox[{"B_", ",", "t_"}], "]"}]}], ",", "lvar_"}], "]"}], 
          "\[RuleDelayed]", "0"}], "}"}]}], ")"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG22CALC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{
            RowBox[{"A_", " ", 
             RowBox[{"G22", "[", 
              RowBox[{"B_", ",", "t_"}], "]"}]}], ",", "lvar_"}], "]"}], 
          "\[RuleDelayed]", "0"}], "}"}]}], ")"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{
            RowBox[{"A_", " ", 
             RowBox[{"G3", "[", 
              RowBox[{"B_", ",", "t_"}], "]"}]}], ",", "lvar_"}], "]"}], 
          "\[RuleDelayed]", "0"}], "}"}]}], ")"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "the", " ", "evolution", " ", "equation", " ", "for", " ", 
      RowBox[{"dG22", "/", "dt"}]}], ",", " ", 
     RowBox[{
     "we", " ", "neglect", " ", "the", " ", "source", " ", "term", " ", "in", 
      " ", 
      RowBox[{"G21", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG22CALC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"G21", "[", 
           RowBox[{"l_", ",", "t_"}], "]"}], "\[RuleDelayed]", "0"}], "}"}]}],
        ")"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "the", " ", "evolution", " ", "equation", " ", "for", " ", 
      RowBox[{"dG3", "/", "dt"}]}], ",", " ", 
     RowBox[{
     "we", " ", "also", " ", "remove", " ", "the", " ", "source", " ", "term",
       " ", "in", " ", "G21", "\[Times]", 
      RowBox[{"G21", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"G21", "[", 
           RowBox[{"l_", ",", "t_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"\[Eta]", " ", 
           RowBox[{"G21", "[", 
            RowBox[{"l", ",", "t"}], "]"}]}]}], "}"}]}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["\[Eta]", "2"], "\[RuleDelayed]", "0"}], "}"}]}], 
       ")"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", 
        RowBox[{"{", 
         RowBox[{"\[Eta]", "\[RuleDelayed]", "1"}], "}"}]}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "introduce", " ", "the", " ", "Fourier", " ", "expansion", 
      " ", "of", " ", "the", " ", "pairwise", " ", "interaction", " ", 
      RowBox[{"potential", ".", "\[IndentingNewLine]", "To"}], " ", 
      "highlight", " ", "the", " ", "fact", " ", "that", " ", "we", " ", 
      "are", " ", "dealing", " ", "with", " ", "the", " ", "Fourier", " ", 
      "coefficients"}], ",", " ", 
     RowBox[{
     "we", " ", "note", " ", "this", " ", "function", " ", "as", " ", 
      RowBox[{"UPotk", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     
     RowBox[{
     "to", " ", "the", " ", "convention", " ", "for", " ", "the", " ", 
      "Fourier", " ", 
      RowBox[{"transform", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleFourierUPot", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UPot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]a_", ",", "Ja_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]b_", ",", "Jb_"}], "}"}]}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"SUM", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"ks", ",", 
            RowBox[{"{", 
             RowBox[{"Ja", ",", "Jb"}], "}"}]}], "]"}], " ", 
          RowBox[{"EXP", "[", 
           RowBox[{
            RowBox[{"I", " ", "ks", " ", "\[Theta]a"}], "-", 
            RowBox[{"I", " ", "ks", " ", "\[Theta]b"}]}], "]"}]}], ",", 
         RowBox[{"{", "ks", "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "rewrite", " ", "the", " ", "correlation", " ", 
      "functions", " ", "as", " ", "Fourier", " ", 
      RowBox[{"expansions", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "we", " ", "make", " ", "these", " ", "replacements", " ", "carefully", 
      " ", "to", " ", "make", " ", "sure", " ", "that", " ", "the", " ", 
      "correct", " ", "variable", " ", "names", " ", "are", " ", "being", " ", 
      RowBox[{"used", ".", "\[IndentingNewLine]", "To"}], " ", "highlight", 
      " ", "the", " ", "fact", " ", "we", " ", "are", " ", "dealing", " ", 
      "with", " ", "Fourier", " ", "coefficients"}], ",", " ", 
     RowBox[{
     "we", " ", "note", " ", "these", " ", "functions", " ", "as", " ", 
      RowBox[{"Gk", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Function", " ", "that", " ", "for", " ", "a", " ", "given", " ", 
      "\[Theta]", " ", "symbol"}], ",", " ", 
     RowBox[{"returns", " ", "the", " ", "associated", " ", "ks", " ", 
      RowBox[{"symbol", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "here", " ", "this", " ", "replacement", " ", "will", " ", "be", " ", 
      "fine", " ", "because", " ", "the", " ", "correlation", " ", "do", " ", 
      "not", " ", "appear", " ", 
      RowBox[{"squared", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"From\[Theta]toks", "[", "\[Theta]_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]", "//", "ToString"}], "//", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\"\<\[Theta]\>\"", "\[Rule]", "\"\<k\>\""}]}], "]"}], 
        "&"}]}], "//", 
      RowBox[{
       RowBox[{"Symbol", "[", 
        RowBox[{"#", "<>", "\"\<s\>\""}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Rule", " ", "for", " ", 
     RowBox[{"G21", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleFourierG21", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"G21", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]a_", ",", "Ja_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]b_", ",", "Jb_"}], "}"}]}], "}"}], ",", "t_"}], 
        "]"}], "\[RuleDelayed]", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"kas", ",", "kbs"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Getting", " ", "the", " ", "good", " ", "symbols", " ", "for", " ",
            "the", " ", "Fourier", " ", 
           RowBox[{"numbers", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kas", " ", "=", " ", 
           RowBox[{"From\[Theta]toks", "[", "\[Theta]a", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"kbs", " ", "=", " ", 
           RowBox[{"From\[Theta]toks", "[", "\[Theta]b", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Making", " ", "the", " ", 
            RowBox[{"replacement", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"SUM", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"G21k", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"kas", ",", "Ja"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"kbs", ",", "Jb"}], "}"}]}], "}"}], ",", "t"}], 
              "]"}], " ", 
             RowBox[{"EXP", "[", 
              RowBox[{
               RowBox[{"I", " ", "kas", " ", "\[Theta]a"}], " ", "+", " ", 
               RowBox[{"I", " ", "kbs", " ", "\[Theta]b"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"kas", ",", "kbs"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Rule", " ", "for", " ", 
     RowBox[{"G22", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleFourierG22", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"G22", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]a_", ",", "Ja_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]b_", ",", "Jb_"}], "}"}]}], "}"}], ",", "t_"}], 
        "]"}], "\[RuleDelayed]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"kas", ",", "kbs"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Getting", " ", "the", " ", "good", " ", "symbols", " ", "for", " ",
            "the", " ", "Fourier", " ", 
           RowBox[{"numbers", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kas", " ", "=", " ", 
           RowBox[{"From\[Theta]toks", "[", "\[Theta]a", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"kbs", " ", "=", " ", 
           RowBox[{"From\[Theta]toks", "[", "\[Theta]b", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Making", " ", "the", " ", 
            RowBox[{"replacement", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"SUM", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"G22k", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"kas", ",", "Ja"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"kbs", ",", "Jb"}], "}"}]}], "}"}], ",", "t"}], 
              "]"}], " ", 
             RowBox[{"EXP", "[", 
              RowBox[{
               RowBox[{"I", " ", "kas", " ", "\[Theta]a"}], " ", "+", " ", 
               RowBox[{"I", " ", "kbs", " ", "\[Theta]b"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"kas", ",", "kbs"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Rule", " ", "for", " ", 
     RowBox[{"G3", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleFourierG3", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"G3", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]a_", ",", "Ja_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]b_", ",", "Jb_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]c_", ",", "Jc_"}], "}"}]}], "}"}], ",", "t_"}], 
        "]"}], "\[RuleDelayed]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"kas", ",", "kbs", ",", "kcs"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Getting", " ", "the", " ", "good", " ", "symbols", " ", "for", " ",
            "the", " ", "Fourier", " ", 
           RowBox[{"numbers", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kas", " ", "=", " ", 
           RowBox[{"From\[Theta]toks", "[", "\[Theta]a", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"kbs", " ", "=", " ", 
           RowBox[{"From\[Theta]toks", "[", "\[Theta]b", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"kcs", " ", "=", " ", 
           RowBox[{"From\[Theta]toks", "[", "\[Theta]c", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Making", " ", "the", " ", 
            RowBox[{"replacement", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"SUM", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"G3k", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"kas", ",", "Ja"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"kbs", ",", "Jb"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"kcs", ",", "Jc"}], "}"}]}], "}"}], ",", "t"}], 
              "]"}], " ", 
             RowBox[{"EXP", "[", 
              RowBox[{
               RowBox[{"I", " ", "kas", " ", "\[Theta]a"}], " ", "+", " ", 
               RowBox[{"I", " ", "kbs", " ", "\[Theta]b"}], " ", "+", 
               RowBox[{"I", " ", "kcs", " ", "\[Theta]c"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"kas", ",", "kbs", ",", "kcs"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Joining", " ", "all", " ", "the", " ", "Fourier", " ", "rules", " ", 
     "in", " ", 
     RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesFourier", " ", "=", " ", 
     RowBox[{
     "RuleFourierUPot", "~", "Join", "~", "RuleFourierG21", "~", "Join", "~", 
      "RuleFourierG22", "~", "Join", "~", "RuleFourierG3"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Making", " ", "the", " ", "Fourier", " ", 
     RowBox[{"replacements", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYFCALC", "/.", "RulesFourier"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG21CALC", "/.", "RulesFourier"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG22CALC", "/.", "RulesFourier"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", "RulesFourier"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "know", " ", "that", " ", "the", " ", "mean", " ", "DF", " ", 
      "is", " ", "indepedent", " ", "of", " ", 
      RowBox[{"\[Theta]1", ".", "\[IndentingNewLine]", "As"}], " ", "a", " ", 
      "consequence"}], ",", " ", 
     RowBox[{
     "we", " ", "can", " ", "perform", " ", "the", " ", "operation", " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}]}], 
      RowBox[{"INT", "[", 
       RowBox[{",", 
        RowBox[{"{", "\[Theta]1", "}"}]}], "]"}], " ", "on", " ", "both", " ",
       "sides", " ", "of", " ", "the", " ", "evolution", " ", "equation", " ",
       "for", " ", 
      RowBox[{"dF", "/", 
       RowBox[{"dt", ".", "\[IndentingNewLine]", "ATTENTION"}]}]}], ",", " ", 
     
     RowBox[{"to", " ", "the", " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}]}], " ", 
      RowBox[{"prefactor", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYFCALC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"A_", " ", "\[Equal]", " ", "B_"}], " ", "\[RuleDelayed]", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", "\[Pi]"}], ")"}]}], " ", 
            RowBox[{"INT", "[", 
             RowBox[{"A", ",", 
              RowBox[{"{", "\[Theta]1", "}"}]}], "]"}]}], "\[Equal]", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", "\[Pi]"}], ")"}]}], " ", 
            RowBox[{"INT", "[", 
             RowBox[{"B", ",", 
              RowBox[{"{", "\[Theta]1", "}"}]}], "]"}]}]}]}], "}"}]}], ")"}], 
      "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Computing", " ", "already", " ", "the", " ", "integral", " ", 
      RowBox[{"INT", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", "\[Theta]1", "}"}]}], "]"}]}], "=", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYFCALC", "/.", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", "\[Theta]1", "}"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"2", " ", "\[Pi]"}], ")"}]}]}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "G21"}], ",", " ", 
     RowBox[{"we", " ", "perform", " ", "the", " ", "operation", " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]"}], ")"}], "^", 
         RowBox[{"(", "2", ")"}]}], ")"}]}], " ", 
      RowBox[{"INT", "[", 
       RowBox[{
        RowBox[{"...", 
         RowBox[{"EXP", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], " ", "k1", " ", "\[Theta]1"}], " ", "-", " ", 
           
           RowBox[{"I", " ", "k2", " ", "\[Theta]2"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}]}], "]"}], " ", "on", 
      " ", "both", " ", 
      RowBox[{"sides", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     
     RowBox[{"to", " ", "the", " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]"}], ")"}], "^", 
         RowBox[{"(", "2", ")"}]}], ")"}]}], " ", 
      RowBox[{"prefactor", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG21CALC", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"A_", " ", "\[Equal]", " ", "B_"}], " ", "\[RuleDelayed]", 
          " ", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", "\[Pi]"}], ")"}], "^", 
               RowBox[{"(", "2", ")"}]}], ")"}]}], " ", 
            RowBox[{"INT", "[", 
             RowBox[{
              RowBox[{"A", " ", 
               RowBox[{"EXP", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", " ", "I"}], " ", "k1", " ", "\[Theta]1"}], " ",
                  "-", " ", 
                 RowBox[{"I", " ", "k2", " ", "\[Theta]2"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}]}], "]"}]}], " ",
            "\[Equal]", " ", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", "\[Pi]"}], ")"}], "^", 
               RowBox[{"(", "2", ")"}]}], ")"}]}], " ", 
            RowBox[{"INT", "[", 
             RowBox[{
              RowBox[{"B", "  ", 
               RowBox[{"EXP", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", " ", "I"}], " ", "k1", " ", "\[Theta]1"}], " ",
                  "-", " ", 
                 RowBox[{"I", " ", "k2", " ", "\[Theta]2"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ")"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "G22"}], ",", " ", 
     RowBox[{"we", " ", "perform", " ", "the", " ", "operation", " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]"}], ")"}], "^", 
         RowBox[{"(", "2", ")"}]}], ")"}]}], " ", 
      RowBox[{"INT", "[", 
       RowBox[{
        RowBox[{"...", 
         RowBox[{"EXP", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], " ", "k1", " ", "\[Theta]1"}], " ", "-", " ", 
           
           RowBox[{"I", " ", "k2", " ", "\[Theta]2"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}]}], "]"}], " ", "on", 
      " ", "both", " ", 
      RowBox[{"sides", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     
     RowBox[{"to", " ", "the", " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]"}], ")"}], "^", 
         RowBox[{"(", "2", ")"}]}], ")"}]}], " ", 
      RowBox[{"prefactor", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG22CALC", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"A_", " ", "\[Equal]", " ", "B_"}], " ", "\[RuleDelayed]", 
          " ", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", "\[Pi]"}], ")"}], "^", 
               RowBox[{"(", "2", ")"}]}], ")"}]}], " ", 
            RowBox[{"INT", "[", 
             RowBox[{
              RowBox[{"A", " ", 
               RowBox[{"EXP", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", " ", "I"}], " ", "k1", " ", "\[Theta]1"}], " ",
                  "-", " ", 
                 RowBox[{"I", " ", "k2", " ", "\[Theta]2"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}]}], "]"}]}], " ",
            "\[Equal]", " ", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", "\[Pi]"}], ")"}], "^", 
               RowBox[{"(", "2", ")"}]}], ")"}]}], " ", 
            RowBox[{"INT", "[", 
             RowBox[{
              RowBox[{"B", "  ", 
               RowBox[{"EXP", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", " ", "I"}], " ", "k1", " ", "\[Theta]1"}], " ",
                  "-", " ", 
                 RowBox[{"I", " ", "k2", " ", "\[Theta]2"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ")"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "G22"}], ",", " ", 
     RowBox[{"we", " ", "perform", " ", "the", " ", "operation", " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]"}], ")"}], "^", 
         RowBox[{"(", "3", ")"}]}], ")"}]}], " ", 
      RowBox[{"INT", "[", 
       RowBox[{
        RowBox[{"...", 
         RowBox[{"EXP", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], " ", "k1", " ", "\[Theta]1"}], " ", "-", " ", 
           
           RowBox[{"I", " ", "k2", " ", "\[Theta]2"}], " ", "-", " ", 
           RowBox[{"I", " ", "k3", " ", "\[Theta]3"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "\[Theta]2", ",", "\[Theta]3"}], "}"}]}], 
       "]"}], " ", "on", " ", "both", " ", 
      RowBox[{"sides", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     
     RowBox[{"to", " ", "the", " ", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]"}], ")"}], "^", 
         RowBox[{"(", "3", ")"}]}], ")"}]}], " ", 
      RowBox[{"prefactor", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"A_", " ", "\[Equal]", " ", "B_"}], " ", "\[RuleDelayed]", 
          " ", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", "\[Pi]"}], ")"}], "^", 
               RowBox[{"(", "3", ")"}]}], ")"}]}], " ", 
            RowBox[{"INT", "[", 
             RowBox[{
              RowBox[{"A", " ", 
               RowBox[{"EXP", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", " ", "I"}], " ", "k1", " ", "\[Theta]1"}], " ",
                  "-", " ", 
                 RowBox[{"I", " ", "k2", " ", "\[Theta]2"}], " ", "-", " ", 
                 RowBox[{"I", " ", "k3", " ", "\[Theta]3"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]1", ",", "\[Theta]2", ",", "\[Theta]3"}], 
               "}"}]}], "]"}]}], " ", "\[Equal]", " ", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", "\[Pi]"}], ")"}], "^", 
               RowBox[{"(", "3", ")"}]}], ")"}]}], " ", 
            RowBox[{"INT", "[", 
             RowBox[{
              RowBox[{"B", "  ", 
               RowBox[{"EXP", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", " ", "I"}], " ", "k1", " ", "\[Theta]1"}], " ",
                  "-", " ", 
                 RowBox[{"I", " ", "k2", " ", "\[Theta]2"}], " ", "-", " ", 
                 RowBox[{"I", " ", "k3", " ", "\[Theta]3"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]1", ",", "\[Theta]2", ",", "\[Theta]3"}], 
               "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ")"}], "//",
       "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Our", " ", "goal", " ", "is", " ", "now", " ", "to", " ", "perform", " ",
      "all", " ", "the", " ", "integrations", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "the"}], " ", 
     RowBox[{"angles", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Before", " ", "being", " ", "able", " ", "to", " ", "compute", " ", 
      "all", " ", "the", " ", "angular", " ", "integrals"}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "push", " ", "the", " ", "angular", 
      " ", "INT", " ", "inwards"}], ",", " ", 
     RowBox[{
     "so", " ", "that", " ", "only", " ", "trivial", " ", "integrals", " ", 
      "of", " ", "exponentials", " ", 
      RowBox[{"remain", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesINT\[Theta]", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Interveting", " ", "SUM", " ", "and", " ", 
        RowBox[{"DER", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"SUM", "[", 
           RowBox[{"A_", ",", "ls_"}], "]"}], ",", "ld_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"DER", "[", 
           RowBox[{"A", ",", "ld"}], "]"}], ",", "ls"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Interverting", " ", "INT", " ", "and", " ", 
          RowBox[{"SUM", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
         " ", 
         RowBox[{"the", " ", "parentheses", " ", "around", " ", 
          RowBox[{"(", 
           RowBox[{"B_:", "1"}], ")"}], " ", "are", " ", 
          RowBox[{"mandatory", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"B_:", "1"}], ")"}], 
           RowBox[{"SUM", "[", 
            RowBox[{"A_", ",", "ls_"}], "]"}]}], ",", "li_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{
            RowBox[{"A", " ", "B"}], ",", "li"}], "]"}], ",", "ls"}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Merging", " ", "the", " ", 
         RowBox[{"sums", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SUM", "[", 
          RowBox[{"A_", ",", "lA_"}], "]"}], 
         RowBox[{"SUM", "[", 
          RowBox[{"B_", ",", "lB_"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"A", " ", "B"}], ",", 
          RowBox[{"Sort", "@", 
           RowBox[{"(", 
            RowBox[{"lA", "~", "Join", "~", "lB"}], ")"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"B_:", "1"}], ")"}], 
           RowBox[{"SUM", "[", 
            RowBox[{"A_", ",", "lA_"}], "]"}]}], ",", "lB_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"A", " ", "B"}], ",", 
          RowBox[{"Sort", "@", 
           RowBox[{"(", 
            RowBox[{"lA", "~", "Join", "~", "lB"}], ")"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Splitting", " ", "the", " ", "phase", " ", "space", " ", 
          "integrals", " ", "into", " ", "their", " ", "two", " ", 
          RowBox[{"components", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
         ",", " ", 
         RowBox[{"the", " ", "HoldPattern", " ", "is", " ", 
          RowBox[{"mandatory", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"(", 
          RowBox[{"INT", "[", 
           RowBox[{"A_", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Theta]_", "?", "AngleQ"}], ",", 
              RowBox[{"J_", "?", "ActionQ"}]}], "}"}]}], "]"}], ")"}]}], 
        "\[RuleDelayed]", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{"A", ",", 
            RowBox[{"{", "\[Theta]", "}"}]}], "]"}], ",", 
          RowBox[{"{", "J", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Merging", " ", "the", " ", "angular", " ", 
          RowBox[{"integrals", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
         ",", " ", 
         RowBox[{
         "we", " ", "need", " ", "to", " ", "check", " ", "that", " ", "the", 
          " ", "integration", " ", "variables", " ", "are", " ", "all", " ", 
          RowBox[{"angles", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
         " ", 
         RowBox[{"the", " ", "parentheses", " ", "around", " ", 
          RowBox[{"(", 
           RowBox[{"B_:", "1"}], ")"}], " ", "are", " ", 
          RowBox[{"mandatory", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"B_:", "1"}], ")"}], " ", 
           RowBox[{"INT", "[", 
            RowBox[{"A_", ",", "l\[Theta]A_"}], "]"}]}], ",", "l\[Theta]B_"}],
          "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{"A", " ", "B"}], ",", 
           RowBox[{"l\[Theta]A", "~", "Join", "~", "l\[Theta]B"}]}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"AngleQ", "/@", "l\[Theta]A"}], ")"}]}], ")"}], " ", "&&", 
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"AngleQ", "/@", "l\[Theta]B"}], ")"}]}], ")"}]}], 
          ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Joining", " ", "the", " ", "products", " ", "of", " ", 
         RowBox[{"exponentials", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"EXP", "[", "A_", "]"}], 
         RowBox[{"EXP", "[", "B_", "]"}]}], "\[RuleDelayed]", 
        RowBox[{"EXP", "[", 
         RowBox[{"A", "+", "B"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Taking", " ", "the", " ", "derivatives", " ", "of", " ", 
          RowBox[{"EXP", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
         " ", 
         RowBox[{"the", " ", "HoldPattern", " ", "is", " ", 
          RowBox[{"mandatory", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"(", 
          RowBox[{"DER", "[", 
           RowBox[{
            RowBox[{"EXP", "[", "A_", "]"}], ",", 
            RowBox[{"\[Theta]_", "?", "AngleQ"}]}], "]"}], ")"}]}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"A", ",", "\[Theta]"}], "]"}], 
         RowBox[{"EXP", "[", "A", "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", "simplification", " ", 
     RowBox[{"rules", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYFCALC", ",", "RulesINT\[Theta]"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG21CALC", ",", "RulesINT\[Theta]"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG22CALC", ",", "RulesINT\[Theta]"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG3CALC", ",", "RulesINT\[Theta]"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"At", " ", "this", " ", "stage"}], ",", " ", 
     RowBox[{
     "we", " ", "can", " ", "now", " ", "compute", " ", "all", " ", "the", 
      " ", "obvious", " ", "angular", " ", "integrals", " ", "of", " ", 
      RowBox[{"exponentials", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
     ",", " ", 
     RowBox[{
     "we", " ", "divide", " ", "by", " ", "I", " ", "in", " ", "the", " ", 
      "Kronecker", " ", 
      RowBox[{"symbol", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleINTEXP", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{"EXP", "[", "A_", "]"}], ",", "l\[Theta]_"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "listexponents", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"listexponents", " ", "=", " ", 
           RowBox[{"Coefficient", "[", 
            RowBox[{"A", ",", "l\[Theta]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", "\[Pi]"}], ")"}], " ", 
             RowBox[{"KRON", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"listexponents", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/", "I"}], ")"}], "//", 
               "Simplify"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "listexponents"}]}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYFCALC", ",", "RuleINTEXP"}], "]"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG21CALC", ",", "RuleINTEXP"}], "]"}], "//", "Expand"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG22CALC", ",", "RuleINTEXP"}], "]"}], "//", "Expand"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG3CALC", ",", "RuleINTEXP"}], "]"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "may", " ", "now", " ", "get", " ", "rid", " ", "of", " ", 
      "some", " ", "of", " ", "the", " ", "sums", " ", "over", " ", "the", 
      " ", "Fourier", " ", "numbers", " ", "by", " ", "using", " ", "the", 
      " ", "presence", " ", "of", " ", "the", " ", "Kronecker", " ", 
      RowBox[{"symbols", ".", "\[IndentingNewLine]", "In"}], " ", "order", 
      " ", "to", " ", "avoid", " ", "confusion"}], ",", " ", 
     RowBox[{
     "we", " ", "define", " ", "rules", " ", "specific", " ", "to", " ", 
      "each", " ", "of", " ", "the", " ", "evolution", " ", 
      RowBox[{"equations", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Rules", " ", "for", " ", 
     RowBox[{"dF", "/", 
      RowBox[{"dt", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYFCALC", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"HoldPattern", "@", 
           RowBox[{"(", 
            RowBox[{"SUM", "[", 
             RowBox[{
              RowBox[{"A_", " ", 
               RowBox[{"KRON", "[", "t1_", "]"}], " ", 
               RowBox[{"KRON", "[", "t2_", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"k1s", ",", "k2s", ",", "ks"}], "}"}]}], "]"}], 
            ")"}]}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "solKRON", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"solKRON", " ", "=", " ", 
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"t1", "\[Equal]", "0"}], ",", 
                    RowBox[{"t2", "\[Equal]", "0"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k1s", ",", "k2s"}], "}"}]}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"SUM", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"A", "/.", "solKRON"}], ")"}], ",", 
                RowBox[{"{", "ks", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
            "]"}], ")"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Rules", " ", "for", " ", 
     RowBox[{"dG21", "/", 
      RowBox[{"dt", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG21CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG21CALC", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{"A_", " ", 
                RowBox[{"KRON", "[", "t1_", "]"}], " ", 
                RowBox[{"KRON", "[", "t2_", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k1s", ",", "k2s"}], "}"}]}], "]"}], ")"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "solKRON", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"solKRON", " ", "=", " ", 
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"t1", "\[Equal]", "0"}], ",", 
                    RowBox[{"t2", "\[Equal]", "0"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k1s", ",", "k2s"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{"A", "/.", "solKRON"}], ")"}]}]}], 
             "\[IndentingNewLine]", "]"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{"A_", " ", 
                RowBox[{"KRON", "[", 
                 RowBox[{"k1", "-", "ks"}], "]"}]}], ",", 
               RowBox[{"{", "ks", "}"}]}], "]"}], ")"}]}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"A", " ", "/.", " ", 
             RowBox[{"{", 
              RowBox[{"ks", " ", "\[RuleDelayed]", "k1"}], "}"}]}], ")"}]}]}],
          "\[IndentingNewLine]", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Rules", " ", "for", " ", 
     RowBox[{"dG22", "/", 
      RowBox[{"dt", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG22CALC", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{"A_", " ", 
                RowBox[{"KRON", "[", "t1_", "]"}], " ", 
                RowBox[{"KRON", "[", "t2_", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k1s", ",", "k2s"}], "}"}]}], "]"}], ")"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "solKRON", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"solKRON", " ", "=", " ", 
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"t1", "\[Equal]", "0"}], ",", 
                    RowBox[{"t2", "\[Equal]", "0"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k1s", ",", "k2s"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{"A", "/.", "solKRON"}], ")"}]}]}], 
             "\[IndentingNewLine]", "]"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{"A_", " ", 
                RowBox[{"KRON", "[", "t1_", "]"}], " ", 
                RowBox[{"KRON", "[", "t2_", "]"}], " ", 
                RowBox[{"KRON", "[", "t3_", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k1s", ",", "k2s", ",", "k3s", ",", "ks"}], "}"}]}], 
              "]"}], ")"}]}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "solKRON", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"solKRON", " ", "=", " ", 
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"t1", "\[Equal]", "0"}], ",", 
                    RowBox[{"t2", "\[Equal]", "0"}], ",", 
                    RowBox[{"t3", "\[Equal]", "0"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k1s", ",", "k2s", ",", "k3s"}], "}"}]}], "]"}], 
                 "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"SUM", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"A", "/.", "solKRON"}], ")"}], ",", 
                 RowBox[{"{", "ks", "}"}]}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Rules", " ", "for", " ", 
     RowBox[{"dG3", "/", 
      RowBox[{"dt", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG3CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"BBGKYG3CALC", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{"A_", " ", 
                RowBox[{"KRON", "[", "t1_", "]"}], " ", 
                RowBox[{"KRON", "[", "t2_", "]"}], " ", 
                RowBox[{"KRON", "[", "t3_", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k1s", ",", "k2s", ",", "k3s"}], "}"}]}], "]"}], 
             ")"}]}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "solKRON", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"solKRON", " ", "=", " ", 
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"t1", "\[Equal]", "0"}], ",", 
                    RowBox[{"t2", "\[Equal]", "0"}], ",", 
                    RowBox[{"t3", "\[Equal]", "0"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k1s", ",", "k2s", ",", "k3s"}], "}"}]}], "]"}], 
                 "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{"A", "/.", "solKRON"}], ")"}]}]}], 
             "\[IndentingNewLine]", "]"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{"A_", " ", 
                RowBox[{"KRON", "[", "t1_", "]"}], 
                RowBox[{"KRON", "[", "t2_", "]"}], 
                RowBox[{"KRON", "[", "t3_", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k1s", ",", "k2s", ",", "ks"}], "}"}]}], "]"}], 
             ")"}]}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "solKRON", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"solKRON", " ", "=", " ", 
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"t1", "\[Equal]", "0"}], ",", 
                    RowBox[{"t2", "\[Equal]", "0"}], ",", 
                    RowBox[{"t3", "\[Equal]", "0"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k1s", ",", "k2s", ",", "ks"}], "}"}]}], "]"}], 
                 "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{"A", "/.", "solKRON"}], ")"}]}]}], 
             "\[IndentingNewLine]", "]"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{"A_", " ", 
                RowBox[{"KRON", "[", "t1_", "]"}], 
                RowBox[{"KRON", "[", "t2_", "]"}], 
                RowBox[{"KRON", "[", "t3_", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k1s", ",", "k3s", ",", "ks"}], "}"}]}], "]"}], 
             ")"}]}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "solKRON", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"solKRON", " ", "=", " ", 
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"t1", "\[Equal]", "0"}], ",", 
                    RowBox[{"t2", "\[Equal]", "0"}], ",", 
                    RowBox[{"t3", "\[Equal]", "0"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k1s", ",", "k3s", ",", "ks"}], "}"}]}], "]"}], 
                 "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{"A", "/.", "solKRON"}], ")"}]}]}], 
             "\[IndentingNewLine]", "]"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{"A_", " ", 
                RowBox[{"KRON", "[", "t1_", "]"}], 
                RowBox[{"KRON", "[", "t2_", "]"}], 
                RowBox[{"KRON", "[", "t3_", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k2s", ",", "k3s", ",", "ks"}], "}"}]}], "]"}], 
             ")"}]}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "solKRON", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"solKRON", " ", "=", " ", 
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"t1", "\[Equal]", "0"}], ",", 
                    RowBox[{"t2", "\[Equal]", "0"}], ",", 
                    RowBox[{"t3", "\[Equal]", "0"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k2s", ",", "k3s", ",", "ks"}], "}"}]}], "]"}], 
                 "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{"A", "/.", "solKRON"}], ")"}]}]}], 
             "\[IndentingNewLine]", "]"}], ")"}]}]}], "\[IndentingNewLine]", 
         "}"}]}], "]"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "now", " ", "change", " ", "the", " ", "name", " ", "of", " ", 
     "the", " ", "dummy", " ", "variables", " ", "of", " ", "summation", " ", 
     "to", " ", "avoid", " ", 
     RowBox[{"confusion", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", 
      RowBox[{"dF", "/", "dt"}]}], ",", " ", 
     RowBox[{
     "there", " ", "is", " ", "one", " ", "dummy", " ", "summation", " ", 
      "variables"}], ",", " ", 
     RowBox[{
      RowBox[{"ks", ".", "\[IndentingNewLine]", "We"}], " ", "replace", " ", 
      "them", " ", "with", " ", 
      RowBox[{"kp", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"ReplaceVariables", "[", 
       RowBox[{"BBGKYFCALC", ",", 
        RowBox[{"{", "ks", "}"}], ",", 
        RowBox[{"{", "kp", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", 
      RowBox[{"dG21", "/", "dt"}]}], ",", " ", 
     RowBox[{
     "there", " ", "are", " ", "no", " ", "dummy", " ", "summation", " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "So"}], " ", "that"}], 
     ",", " ", 
     RowBox[{"we", " ", "do", " ", "not", " ", "do", " ", 
      RowBox[{"anything", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", 
      RowBox[{"dG22", "/", "dt"}]}], ",", " ", 
     RowBox[{
     "there", " ", "is", " ", "one", " ", "dummy", " ", "summation", " ", 
      "variables"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "ks", "}"}], ".", "\[IndentingNewLine]", "We"}], " ", 
      "replace", " ", "it", " ", "with", " ", 
      RowBox[{"ks", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"ReplaceVariables", "[", 
       RowBox[{"BBGKYG22CALC", ",", 
        RowBox[{"{", "ks", "}"}], ",", 
        RowBox[{"{", "ks", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", 
      RowBox[{"dG3", "/", "dt"}]}], ",", " ", 
     RowBox[{
     "there", " ", "are", " ", "no", " ", "dummy", " ", "summation", " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "So"}], " ", "that"}], 
     ",", " ", 
     RowBox[{"we", " ", "do", " ", "not", " ", "do", " ", 
      RowBox[{"anything", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"To", " ", "avoid", " ", "confusion"}], ",", " ", 
     RowBox[{
     "we", " ", "also", " ", "replace", " ", "the", " ", "dummy", " ", 
      "action", " ", "variables", " ", "with", " ", "a", " ", "different", 
      " ", 
      RowBox[{"name", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", 
      RowBox[{"dF", "/", "dt"}]}], ",", " ", 
     RowBox[{
     "there", " ", "is", " ", "one", " ", "dummy", " ", "action", " ", 
      "variable"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "J2", "}"}], ".", "\[IndentingNewLine]", "We"}], " ", 
      "replace", " ", "it", " ", "with", " ", 
      RowBox[{
       RowBox[{"{", "Jp", "}"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYFCALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"ReplaceVariables", "[", 
       RowBox[{"BBGKYFCALC", ",", 
        RowBox[{"{", "J2", "}"}], ",", 
        RowBox[{"{", "Jp", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", 
      RowBox[{"dG21", "/", "dt"}]}], ",", " ", 
     RowBox[{"there", " ", "are", " ", "no", " ", "dummy", " ", "action", " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "So"}], " ", "that"}], 
     ",", " ", 
     RowBox[{"we", " ", "do", " ", "not", " ", "do", " ", 
      RowBox[{"anything", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", 
      RowBox[{"dG22", "/", "dt"}]}], ",", " ", 
     RowBox[{
     "there", " ", "is", " ", "one", " ", "dummy", " ", "action", " ", 
      "variable"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "J3", "}"}], ".", "\[IndentingNewLine]", "We"}], " ", 
      "replace", " ", "it", " ", "with", " ", 
      RowBox[{
       RowBox[{"{", "Jq", "}"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BBGKYG22CALC", " ", "=", " ", 
     RowBox[{
      RowBox[{"ReplaceVariables", "[", 
       RowBox[{"BBGKYG22CALC", ",", 
        RowBox[{"{", "J3", "}"}], ",", 
        RowBox[{"{", "Jq", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", 
      RowBox[{"dG3", "/", "dt"}]}], ",", " ", 
     RowBox[{"there", " ", "are", " ", "no", " ", "dummy", " ", "action", " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "So"}], " ", "that"}], 
     ",", " ", 
     RowBox[{"we", " ", "do", " ", "not", " ", "do", " ", 
      RowBox[{"anything", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"At", " ", "this", " ", "stage"}], ",", " ", 
     RowBox[{
     "none", " ", "of", " ", "the", " ", "evolution", " ", "equations", " ", 
      "share", " ", "dummy", " ", "variables", " ", "with", " ", "the", " ", 
      "same", " ", 
      RowBox[{"name", "."}]}]}], "*)"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.799064963545456*^9, 3.799065319657158*^9}, {
   3.7990654043505507`*^9, 3.799065567116992*^9}, {3.799065602336194*^9, 
   3.799065839390629*^9}, {3.7990659217867527`*^9, 3.799066131358088*^9}, {
   3.79914555301647*^9, 3.799145554062396*^9}, {3.799147556892563*^9, 
   3.799147641641652*^9}, {3.799147704643436*^9, 3.799147748080044*^9}, {
   3.799147827810278*^9, 3.799147896066934*^9}, {3.799148449394824*^9, 
   3.799148513662745*^9}, {3.799148698507691*^9, 3.799148764106989*^9}, {
   3.799148818456867*^9, 3.799149169199081*^9}, {3.799149217586547*^9, 
   3.799149347123714*^9}, {3.799149531009597*^9, 3.799149532288293*^9}, {
   3.7991535227426357`*^9, 3.799154207914158*^9}, {3.799154241556326*^9, 
   3.799154546585383*^9}, {3.799154645454197*^9, 3.799154776271173*^9}, {
   3.799154839047752*^9, 3.799155026623516*^9}, {3.799166471062872*^9, 
   3.799166684687043*^9}, {3.799166727048077*^9, 3.7991667880914917`*^9}, {
   3.799166852693635*^9, 3.799167109462927*^9}, {3.799167146600485*^9, 
   3.79916745034446*^9}, {3.7991675050735483`*^9, 3.7991676168464413`*^9}, {
   3.799167674676052*^9, 3.799167822287841*^9}, {3.7991678667072897`*^9, 
   3.799167867617091*^9}, {3.7991680683812017`*^9, 3.799168096175559*^9}, {
   3.7991681273781567`*^9, 3.7991681635906487`*^9}, {3.799168314457533*^9, 
   3.79916841439996*^9}, {3.799168454260335*^9, 3.799168472491365*^9}, {
   3.799168525365652*^9, 3.7991685892824907`*^9}, {3.799168628456707*^9, 
   3.7991687198303337`*^9}, {3.799168904541903*^9, 3.799168953952099*^9}, {
   3.799400172134601*^9, 3.799400212271805*^9}, {3.7994009705103407`*^9, 
   3.799400997550856*^9}, {3.7994841103615923`*^9, 3.799484125040661*^9}, {
   3.799484177412281*^9, 3.7994842437079144`*^9}, {3.7994842768295593`*^9, 
   3.799484285356642*^9}, {3.799484338986389*^9, 3.799484357665427*^9}, {
   3.799484388281691*^9, 3.7994844225765047`*^9}, {3.79948447771881*^9, 
   3.799484590357603*^9}, {3.7994846237899733`*^9, 3.799484654758442*^9}, {
   3.799484687625581*^9, 3.7994849072030373`*^9}, {3.799485010492318*^9, 
   3.7994850682263002`*^9}, {3.799485224710123*^9, 3.799485378218614*^9}, {
   3.79948655366648*^9, 3.799486708620409*^9}, 3.7994869308287573`*^9, {
   3.7994954258691483`*^9, 3.7994955550021667`*^9}, {3.799495593816104*^9, 
   3.799495812363255*^9}, {3.799495873121974*^9, 3.799496110824564*^9}, {
   3.799496156799477*^9, 3.7994962127943583`*^9}, {3.7995660106047077`*^9, 
   3.799566078246318*^9}, {3.799566124177087*^9, 3.799566124792198*^9}, {
   3.799566175325605*^9, 3.79956618582358*^9}, {3.799566237363867*^9, 
   3.799566372900838*^9}, {3.799566416177095*^9, 3.799566496929021*^9}, {
   3.799566573527341*^9, 3.799566661632134*^9}, {3.799933305587654*^9, 
   3.799933310294586*^9}, {3.8607320826140633`*^9, 3.860732083231122*^9}, {
   3.8607321213166103`*^9, 3.860732144446303*^9}, {3.860732343336087*^9, 
   3.860732417537492*^9}, {3.8607327233349867`*^9, 3.8607327291042*^9}, {
   3.8661896586775846`*^9, 3.8661897317940807`*^9}, {3.866189773295003*^9, 
   3.866189786922915*^9}, {3.8661898208743353`*^9, 3.866189910851801*^9}, {
   3.866190037617296*^9, 3.866190037881392*^9}, 3.866190108838191*^9, {
   3.86652037452805*^9, 3.866520375972066*^9}, {3.866520414644504*^9, 
   3.866520434539426*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["4/ TIME-EVOLUTION OF THE CORRELATIONS", \
"Subsubsection"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.799496230335713*^9, 3.799496250261012*^9}, 
   3.799501605757991*^9, {3.866178761082103*^9, 3.866178766050067*^9}, 
   3.8661788599302807`*^9, {3.8661790129808083`*^9, 3.866179013140521*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "evolution", " ", "equation", " ", "for", " ", "G21", 
     RowBox[{"(", "t", ")"}], " ", "has", " ", "now", " ", "been", " ", 
     "sufficiently", " ", "rewritten", " ", "so", " ", "that", " ", "we", " ",
      "can", " ", "explicitly", " ", "solve", " ", "it", " ", "in", " ", 
     RowBox[{"time", ".", "\[IndentingNewLine]", "As"}], " ", "we", " ", 
     "have", " ", "neglected", " ", "collective", " ", "effects"}], ",", " ", 
    
    RowBox[{
    "we", " ", "can", " ", "directly", " ", "solve", " ", "for", " ", "this", 
     " ", "time", " ", "evolution", " ", "using", " ", "an", " ", "explicit", 
     " ", 
     RowBox[{"integration", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"We", " ", "use", " ", "two", " ", "main", " ", 
     RowBox[{"assumptions", ":", " ", 
      RowBox[{
       RowBox[{"(", "i", ")"}], " ", 
       RowBox[{"Bogoliubov", "'"}], "s", " ", "ansatz"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "so", " ", "that", " ", "F", " ", "is", " ", "taken", " ", "to", " ", 
      "be", " ", "constant"}], ";", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "ii", ")"}], " ", "We", " ", "solve", " ", "for", " ", 
       "the", " ", "time", " ", "evolution", " ", "of", " ", "G21", 
       RowBox[{"(", "t", ")"}], " ", "using", " ", "the", " ", "initial", " ",
        "condition", " ", "G21", 
       RowBox[{"(", 
        RowBox[{"t", "=", "0"}], ")"}]}], "=", "0."}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Enforcing", " ", 
    RowBox[{"Bogoliubov", "'"}], "s", " ", 
    RowBox[{"ansatz", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EqG21k", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG21CALC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"J_", ",", "t_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"F", "[", "J", "]"}]}], "}"}]}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"We", " ", "write", " ", "G21k", " ", "as", " ", "G21k"}], "=", 
     RowBox[{"G21k0", "\[Times]", 
      RowBox[{
       RowBox[{"EXP", "[", 
        RowBox[{
         RowBox[{"-", "I"}], 
         RowBox[{"(", 
          RowBox[{"k1\[CapitalOmega]1", "+", "k2\[CapitalOmega]2"}], ")"}], 
         "t"}], "]"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqG21k0", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"EqG21k", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"G21k", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"k1", ",", "J1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"G21k0", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k1", ",", "J1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], "]"}], 
           " ", 
           RowBox[{"EXP", "[", 
            RowBox[{
             RowBox[{"-", " ", "I"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k1", " ", 
                RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], " ", "+", " ", 
               
               RowBox[{"k2", " ", 
                RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], ")"}], "t"}],
             "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Taking", " ", "explicitly", " ", "the", " ", "time", " ", "derivative", 
     " ", "of", " ", "the", " ", 
     RowBox[{"EXP", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqG21k0", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"EqG21k0", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"HoldPattern", "@", 
           RowBox[{"(", 
            RowBox[{"DER", "[", 
             RowBox[{
              RowBox[{"EXP", "[", "A_", "]"}], ",", "t_"}], "]"}], ")"}]}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"A", ",", "t"}], "]"}], 
           RowBox[{"EXP", "[", "A", "]"}]}]}], "\[IndentingNewLine]", "}"}]}],
        ")"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"We", " ", "can", " ", "now", " ", "solve", " ", "for", " ", 
     RowBox[{"dG21k0", "/", 
      RowBox[{"dt", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG21k0dt", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"EqG21k0", ",", 
           RowBox[{"DER", "[", 
            RowBox[{
             RowBox[{"G21k0", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"k1", ",", "J1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], 
              "]"}], ",", "t"}], "]"}]}], "]"}], "//", "First"}], "//", 
        "Last"}], "//", "Last"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bringing", " ", "the", " ", "EXP", " ", "back", " ", 
     RowBox[{"up", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG21k0dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dG21k0dt", "/.", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"EXP", "[", "A_", "]"}], ")"}]}], "\[RuleDelayed]", 
          RowBox[{"EXP", "[", 
           RowBox[{"-", "A"}], "]"}]}], "}"}]}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "can", " ", "now", " ", "integrate", " ", "this", " ", 
      "expression", " ", "in", " ", "time", " ", "from", " ", "0", " ", "to", 
      " ", 
      RowBox[{"t", ".", "\[IndentingNewLine]", "To"}], " ", "do", " ", "so"}],
      ",", 
     RowBox[{"we", " ", "change", " ", "the", " ", "variable", " ", 
      RowBox[{"`t", "'"}], " ", "with", " ", "t1"}], ",", " ", 
     RowBox[{
     "as", " ", "this", " ", "now", " ", "becomes", " ", "our", " ", 
      "integration", " ", "variable", " ", "for", " ", 
      RowBox[{"time", ".", "\[IndentingNewLine]", "Then"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "integrate", " ", "explicitly", " ", "in", " ", "time", " ", 
       "with", " ", "t1"}], "\[Element]", 
      RowBox[{
       RowBox[{"[", 
        RowBox[{"0", ",", "t"}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG21k0", " ", "=", " ", 
     RowBox[{
      RowBox[{"INTb", "[", 
       RowBox[{
        RowBox[{"ReplaceVariables", "[", 
         RowBox[{"dG21k0dt", ",", 
          RowBox[{"{", "t", "}"}], ",", 
          RowBox[{"{", "t1", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t1", ",", "0", ",", "t"}], "}"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "finally", " ", "use", " ", "this", " ", "expression", " ", 
      "of", " ", "G21k0", " ", "to", " ", "obtain", " ", "the", " ", 
      "expression", " ", "of", " ", "G21k"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"as", " ", "we", " ", "have", " ", "G21k"}], "=", 
      RowBox[{"G21k0", "\[Times]", 
       RowBox[{
        RowBox[{"EXP", "[", 
         RowBox[{
          RowBox[{"-", "I"}], 
          RowBox[{"(", 
           RowBox[{"k1\[CapitalOmega]1", "+", "k2\[CapitalOmega]2"}], ")"}], 
          "t"}], "]"}], "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG21k", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExpG21k0", " ", 
        RowBox[{"EXP", "[", 
         RowBox[{
          RowBox[{"-", "I"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], " ", "+", " ", 
            RowBox[{"k2", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], ")"}], "t"}], 
         "]"}]}], ")"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "simplify", " ", "this", " ", "expression", " ", "by", " ", 
      "gathering", " ", "all", " ", "the", " ", "EXP", " ", "in", " ", 
      RowBox[{"one", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "to", " ", "get", " ", "this", " ", "rule", " ", "to", " ", "work"}], 
     ",", " ", 
     RowBox[{"one", " ", "has", " ", "to", " ", "hold", " ", "some", " ", 
      RowBox[{"symbols", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG21k", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"ExpG21k", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"EXP", "[", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "t", " ", "A_"}], "]"}], " ", 
            RowBox[{"HoldPattern", "@", 
             RowBox[{"(", 
              RowBox[{"INTb", "[", 
               RowBox[{"B_", ",", 
                RowBox[{"{", 
                 RowBox[{"t1", ",", "0", ",", "t"}], "}"}]}], "]"}], 
              ")"}]}]}], "\[RuleDelayed]", 
           RowBox[{"INTbh", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"EXP", "[", 
               RowBox[{
                RowBox[{"-", "I"}], " ", "t", " ", "A"}], "]"}], " ", "B"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"t1", ",", "0", ",", "t"}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"EXP", "[", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "t", " ", "A_"}], "]"}], " ", 
            RowBox[{"EXP", "[", 
             RowBox[{"I", " ", "t1", " ", "A_"}], "]"}]}], "\[RuleDelayed]", 
           " ", 
           RowBox[{"EXP", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"(", 
              RowBox[{"t", "-", "t1"}], ")"}], "A"}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Removing", " ", "the", " ", "held", " ", 
     RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG21k", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExpG21k", "/.", 
        RowBox[{"{", 
         RowBox[{"INTbh", "\[RuleDelayed]", "INTb"}], "}"}]}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "can", " ", "now", " ", "solve", " ", "for", " ", "the", " ", 
      "evolution", " ", "equation", " ", "of", " ", 
      RowBox[{"G3", ".", "\[IndentingNewLine]", "We"}], " ", "use", " ", 
      "the", " ", "same", " ", "main", " ", "assumptions", " ", "as", " ", 
      "previously"}], ",", " ", 
     RowBox[{
      RowBox[{"namely", " ", 
       RowBox[{"(", "i", ")"}], " ", "F"}], "=", "cst"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "ii", ")"}], " ", "the", " ", "initial", " ", "condition",
        " ", "G3", 
       RowBox[{"(", 
        RowBox[{"t", "=", "0"}], ")"}]}], "=", 
      RowBox[{
      "0.", "\[IndentingNewLine]", "As", " ", "we", " ", "have", " ", 
       "neglected", " ", "collective", " ", "effects"}]}], ",", " ", 
     RowBox[{
     "the", " ", "time", " ", "solution", " ", "is", " ", "easy", " ", "to", 
      " ", 
      RowBox[{"obtain", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Enforcing", " ", 
     RowBox[{"Bogoliubov", "'"}], "s", " ", 
     RowBox[{"ansatz", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqG3k", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG3CALC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"J_", ",", "t_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"F", "[", "J", "]"}]}], "}"}]}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"We", " ", "write", " ", "G3k", " ", "as", " ", "G3k"}], "=", 
     RowBox[{"G3k0", "\[Times]", 
      RowBox[{
       RowBox[{"EXP", "[", 
        RowBox[{
         RowBox[{"-", "I"}], 
         RowBox[{"(", 
          RowBox[{
          "k1\[CapitalOmega]1", "+", "k2\[CapitalOmega]2", "+", 
           "k3\[CapitalOmega]3"}], ")"}], "t"}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqG3k0", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"EqG3k", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"G3k", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"k1", ",", "J1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k2", ",", "J2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"G3k0", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k1", ",", "J1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k2", ",", "J2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], "]"}], 
           " ", 
           RowBox[{"EXP", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k1", " ", 
                RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "+", 
               RowBox[{"k2", " ", 
                RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], "+", 
               RowBox[{"k3", " ", 
                RowBox[{"\[CapitalOmega]", "[", "J3", "]"}]}]}], ")"}], "t"}],
             "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Taking", " ", "explicitly", " ", "the", " ", "time", " ", "derivatives", 
     " ", "of", " ", "the", " ", 
     RowBox[{"EXP", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqG3k0", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"EqG3k0", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"HoldPattern", "@", 
           RowBox[{"(", 
            RowBox[{"DER", "[", 
             RowBox[{
              RowBox[{"EXP", "[", "A_", "]"}], ",", "t_"}], "]"}], ")"}]}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"A", ",", "t"}], "]"}], 
           RowBox[{"EXP", "[", "A", "]"}]}]}], "\[IndentingNewLine]", "}"}]}],
        ")"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"We", " ", "can", " ", "now", " ", "solve", " ", "for", " ", 
     RowBox[{"dG3k0", "/", 
      RowBox[{"dt", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG3k0dt", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"EqG3k0", ",", 
           RowBox[{"DER", "[", 
            RowBox[{
             RowBox[{"G3k0", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"k1", ",", "J1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k2", ",", "J2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k3", ",", "J3"}], "}"}]}], "}"}], ",", "t"}], 
              "]"}], ",", "t"}], "]"}]}], "]"}], "//", "First"}], "//", 
        "Last"}], "//", "Last"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bringing", " ", "the", " ", "EXP", " ", "back", " ", 
     RowBox[{"up", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG3k0dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dG3k0dt", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"EXP", "[", "A_", "]"}], ")"}]}], "\[RuleDelayed]", 
          RowBox[{"EXP", "[", 
           RowBox[{"-", "A"}], "]"}]}], "}"}]}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "must", " ", "now", " ", "replace", " ", "all", " ", "the", 
      " ", "occurrences", " ", "of", " ", "G21k", " ", "with", " ", "the", 
      " ", "solution", " ", "determined", " ", 
      RowBox[{"previously", ".", "\[IndentingNewLine]", "The"}], " ", "only", 
      " ", "dummy", " ", "variable", " ", "of", " ", "G21k", " ", "is", " ", 
      "t1"}], ",", " ", 
     RowBox[{"that", " ", "we", " ", "replace", " ", "with", " ", 
      RowBox[{"t2", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG3k0dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"dG3k0dt", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"G21k", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ka_", ",", "Ja_"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"kb_", ",", "Jb_"}], "}"}]}], "}"}], ",", "ta_"}], 
           "]"}], "\[RuleDelayed]", 
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"ExpG21k", ",", 
            RowBox[{"{", 
             RowBox[{
             "k1", ",", "J1", ",", "k2", ",", "J2", ",", "t", ",", "t1"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "ka", ",", "Ja", ",", "kb", ",", "Jb", ",", "ta", ",", "t2"}], 
             "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "can", " ", "now", " ", "integrate", " ", "this", " ", 
      "expression", " ", "explicitly", " ", "in", " ", "time", " ", "from", 
      " ", "0", " ", "to", " ", 
      RowBox[{"t", ".", "\[IndentingNewLine]", "To"}], " ", "do", " ", "so"}],
      ",", " ", 
     RowBox[{"we", " ", "change", " ", "the", " ", "variable", " ", 
      RowBox[{"`t", "'"}], " ", "with", " ", 
      RowBox[{"t1", ".", "\[IndentingNewLine]", "Then"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "integrate", " ", "explicitly", " ", "in", " ", "time", " ", 
       "with", " ", "t1"}], "\[Element]", 
      RowBox[{
       RowBox[{"[", 
        RowBox[{"0", ",", "t"}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG3k0", " ", "=", " ", 
     RowBox[{
      RowBox[{"INTb", "[", 
       RowBox[{
        RowBox[{"ReplaceVariables", "[", 
         RowBox[{"dG3k0dt", ",", 
          RowBox[{"{", "t", "}"}], ",", 
          RowBox[{"{", "t1", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t1", ",", "0", ",", "t"}], "}"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "finally", " ", "use", " ", "this", " ", "expression", " ", 
      "of", " ", "G3k0", " ", "to", " ", "obtain", " ", "the", " ", 
      "expression", " ", "of", " ", "G3k"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"as", " ", "we", " ", "have", " ", "G3k"}], "=", 
      RowBox[{"G3k0", "\[Times]", 
       RowBox[{
        RowBox[{"EXP", "[", 
         RowBox[{
          RowBox[{"-", "I"}], 
          RowBox[{"(", 
           RowBox[{
           "k1\[CapitalOmega]1", "+", "k2\[CapitalOmega]", "+", 
            "k3\[CapitalOmega]3"}], ")"}], "t"}], "]"}], "."}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG3k", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExpG3k0", " ", 
        RowBox[{"EXP", "[", 
         RowBox[{
          RowBox[{"-", "I"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], " ", "+", " ", 
            RowBox[{"k2", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], " ", "+", " ", 
            RowBox[{"k3", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J3", "]"}]}]}], ")"}], "t"}], 
         "]"}]}], ")"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "simplify", " ", "this", " ", "expression", " ", "by", " ", 
      "gathering", " ", "the", " ", "EXP", " ", "as", " ", "much", " ", "as", 
      " ", 
      RowBox[{"possible", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "to", " ", "get", " ", "these", " ", "rules", " ", "to", " ", "work"}], 
     ",", " ", 
     RowBox[{"one", " ", "has", " ", "to", " ", "hold", " ", "some", " ", 
      RowBox[{"symbols", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG3k", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"ExpG3k", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"EXP", "[", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "t", " ", "A_"}], "]"}], " ", 
            RowBox[{"HoldPattern", "@", 
             RowBox[{"(", 
              RowBox[{"INTb", "[", 
               RowBox[{"B_", ",", 
                RowBox[{"{", 
                 RowBox[{"t1", ",", "0", ",", "t"}], "}"}]}], "]"}], 
              ")"}]}]}], "\[RuleDelayed]", 
           RowBox[{"INTbh", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"EXP", "[", 
               RowBox[{
                RowBox[{"-", "I"}], " ", "t", " ", "A"}], "]"}], " ", "B"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"t1", ",", "0", ",", "t"}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"EXP", "[", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "t", " ", "A_"}], "]"}], " ", 
            RowBox[{"EXP", "[", 
             RowBox[{"I", " ", "t1", " ", "A_"}], "]"}]}], "\[RuleDelayed]", 
           RowBox[{"EXP", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"(", 
              RowBox[{"t", "-", "t1"}], ")"}], "A"}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"We", " ", "now", " ", "remove", " ", "the", " ", "held", " ", 
     RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG3k", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExpG3k", "/.", 
        RowBox[{"{", 
         RowBox[{"INTbh", "\[RuleDelayed]", "INTb"}], "}"}]}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "can", " ", "now", " ", "solve", " ", "for", " ", "the", " ", 
      "evolution", " ", "equation", " ", "of", " ", 
      RowBox[{"G22", ".", "\[IndentingNewLine]", "We"}], " ", "use", " ", 
      "the", " ", "same", " ", "main", " ", "assumption", " ", "as", " ", 
      "previously"}], ",", " ", 
     RowBox[{
      RowBox[{"namely", " ", 
       RowBox[{"(", "i", ")"}], " ", "F"}], "=", "cst"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "ii", ")"}], " ", "the", " ", "initial", " ", "condition",
        " ", "G22", 
       RowBox[{"(", 
        RowBox[{"t", "=", "0"}], ")"}]}], "=", 
      RowBox[{
      "0.", "\[IndentingNewLine]", "As", " ", "we", " ", "have", " ", 
       "neglected", " ", "collective", " ", "effects"}]}], ",", " ", 
     RowBox[{
     "this", " ", "solution", " ", "will", " ", "be", " ", "easy", " ", "to", 
      " ", 
      RowBox[{"obtain", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Enforcing", " ", 
     RowBox[{"Bogoliubov", "'"}], "s", " ", 
     RowBox[{"ansatz", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqG22k", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"BBGKYG22CALC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"J_", ",", "t_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"F", "[", "J", "]"}]}], "}"}]}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"We", " ", "write", " ", "G22k", " ", "as", " ", "G22k"}], "=", 
     RowBox[{"G22k0", "\[Times]", 
      RowBox[{
       RowBox[{"EXP", "[", 
        RowBox[{
         RowBox[{"-", "I"}], 
         RowBox[{"(", 
          RowBox[{"k1\[CapitalOmega]1", "+", "k2\[CapitalOmega]2"}], ")"}], 
         "t"}], "]"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqG22k0", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"EqG22k", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"G22k", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"k1", ",", "J1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"G22k0", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k1", ",", "J1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], "]"}], 
           " ", 
           RowBox[{"EXP", "[", 
            RowBox[{
             RowBox[{"-", " ", "I"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k1", " ", 
                RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "+", 
               RowBox[{"k2", " ", 
                RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], ")"}], "t"}],
             "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Taking", " ", "explicitly", " ", "the", " ", "time", " ", "derivative", 
     " ", "of", " ", "the", " ", 
     RowBox[{"EXP", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EqG22k0", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"EqG22k0", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"HoldPattern", "@", 
           RowBox[{"(", 
            RowBox[{"DER", "[", 
             RowBox[{
              RowBox[{"EXP", "[", "A_", "]"}], ",", "t_"}], "]"}], ")"}]}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"A", ",", "t"}], "]"}], 
           RowBox[{"EXP", "[", "A", "]"}]}]}], "\[IndentingNewLine]", "}"}]}],
        ")"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"We", " ", "can", " ", "now", " ", "solve", " ", "for", " ", 
     RowBox[{"dG22k0", "/", 
      RowBox[{"dt", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG22k0dt", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"EqG22k0", ",", 
           RowBox[{"DER", "[", 
            RowBox[{
             RowBox[{"G22k0", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"k1", ",", "J1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k2", ",", "J2"}], "}"}]}], "}"}], ",", "t"}], 
              "]"}], ",", "t"}], "]"}]}], "]"}], "//", "First"}], "//", 
        "Last"}], "//", "Last"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bringing", " ", "the", " ", "EXP", " ", "back", " ", 
     RowBox[{"up", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG22k0dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dG22k0dt", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"EXP", "[", "A_", "]"}], ")"}]}], "\[RuleDelayed]", 
          RowBox[{"EXP", "[", 
           RowBox[{"-", "A"}], "]"}]}], "}"}]}], ")"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "must", " ", "now", " ", "replace", " ", "all", " ", "the", 
      " ", "occurrences", " ", "of", " ", "G3k", " ", "with", " ", "the", " ",
       "solution", " ", "determined", " ", 
      RowBox[{"previously", ".", "\[IndentingNewLine]", "There"}], " ", "are",
       " ", "no", " ", "overlap", " ", "of", " ", "the", " ", "dummy", " ", 
      "variables", " ", "for", " ", "the", " ", "Fourier", " ", "summation", 
      " ", 
      RowBox[{"variables", ".", "\[IndentingNewLine]", "But"}]}], ",", " ", 
     RowBox[{"in", " ", "G3k"}], ",", " ", 
     RowBox[{
     "we", " ", "replace", " ", "the", " ", "time", " ", "variables"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"t1", ",", "t2"}], "}"}], ",", " ", 
     RowBox[{"with", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t2", ",", "t3"}], "}"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dG22k0dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"dG22k0dt", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"G3k", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ka_", ",", "Ja_"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"kb_", ",", "Jb_"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"kc_", ",", "Jc_"}], "}"}]}], "}"}], ",", "ta_"}], 
           "]"}], "\[RuleDelayed]", 
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"ExpG3k", ",", 
            RowBox[{"{", 
             RowBox[{
             "k1", ",", "J1", ",", "k2", ",", "J2", ",", "k3", ",", "J3", ",",
               "t", ",", "t1", ",", "t2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "ka", ",", "Ja", ",", "kb", ",", "Jb", ",", "kc", ",", "Jc", ",",
               "ta", ",", "t2", ",", "t3"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "can", " ", "now", " ", "integrate", " ", "this", " ", 
      "expression", " ", "in", " ", "time", " ", "from", " ", "0", " ", "to", 
      " ", 
      RowBox[{"t", ".", "\[IndentingNewLine]", "To"}], " ", "do", " ", "so"}],
      ",", " ", 
     RowBox[{
     "we", " ", "change", " ", "the", " ", "integration", " ", "variable", 
      " ", 
      RowBox[{"`t", "'"}], " ", "to", " ", 
      RowBox[{"t1", ".", "\[IndentingNewLine]", "Then"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "integrate", " ", "explicitly", " ", "in", " ", "time", " ", 
       "with", " ", "t1"}], "\[Element]", 
      RowBox[{
       RowBox[{"[", 
        RowBox[{"0", ",", "t"}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG22k0", " ", "=", " ", 
     RowBox[{
      RowBox[{"INTb", "[", 
       RowBox[{
        RowBox[{"ReplaceVariables", "[", 
         RowBox[{"dG22k0dt", ",", 
          RowBox[{"{", "t", "}"}], ",", 
          RowBox[{"{", "t1", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t1", ",", "0", ",", "t"}], "}"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "finally", " ", "use", " ", "this", " ", "expression", " ", 
      "of", " ", "G22k0", " ", "to", " ", "obtain", " ", "the", " ", 
      "expression", " ", "of", " ", "G22k"}], ",", " ", 
     RowBox[{
      RowBox[{"as", " ", "we", " ", "have", " ", "G22k"}], "=", 
      RowBox[{"G22k0", "\[Times]", 
       RowBox[{
        RowBox[{"EXP", "[", 
         RowBox[{
          RowBox[{"-", "I"}], 
          RowBox[{"(", 
           RowBox[{"k1\[CapitalOmega]1", "+", "k2\[CapitalOmega]2"}], ")"}], 
          "t"}], "]"}], "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG22k", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExpG22k0", " ", 
        RowBox[{"EXP", "[", 
         RowBox[{
          RowBox[{"-", "I"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], " ", "+", " ", 
            RowBox[{"k2", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], ")"}], "t"}], 
         "]"}]}], ")"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "simplify", " ", "this", " ", "expression", " ", "by", " ", 
      "gathering", " ", "the", " ", "EXP", " ", "as", " ", "much", " ", "as", 
      " ", 
      RowBox[{"possible", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "to", " ", "get", " ", "this", " ", "rule", " ", "to", " ", "work"}], 
     ",", " ", 
     RowBox[{"one", " ", "has", " ", "to", " ", "hold", " ", "some", " ", 
      RowBox[{"symbols", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG22k", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"ExpG22k", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"EXP", "[", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "t", " ", "A_"}], "]"}], " ", 
            RowBox[{"HoldPattern", "@", 
             RowBox[{"(", 
              RowBox[{"INTb", "[", 
               RowBox[{"B_", ",", 
                RowBox[{"{", 
                 RowBox[{"t1", ",", "0", ",", "t"}], "}"}]}], "]"}], 
              ")"}]}]}], "\[RuleDelayed]", 
           RowBox[{"INTbh", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"EXP", "[", 
               RowBox[{
                RowBox[{"-", "I"}], " ", "t", " ", "A"}], "]"}], " ", "B"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"t1", ",", "0", ",", "t"}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"EXP", "[", 
             RowBox[{
              RowBox[{"-", "I"}], " ", "t", " ", "A_"}], "]"}], " ", 
            RowBox[{"EXP", "[", 
             RowBox[{"I", " ", "t1", " ", "A_"}], "]"}]}], "\[RuleDelayed]", 
           " ", 
           RowBox[{"EXP", "[", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"(", 
              RowBox[{"t", "-", "t1"}], ")"}], "A"}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Removing", " ", "the", " ", "held", " ", 
     RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpG22k", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExpG22k", "/.", 
        RowBox[{"{", 
         RowBox[{"INTbh", "\[RuleDelayed]", "INTb"}], "}"}]}], ")"}], "//", 
      "Expand"}]}], ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.799497714144472*^9, 3.799497719769216*^9}, {
   3.799498315625883*^9, 3.799498730625317*^9}, {3.799499310758995*^9, 
   3.7994995021648083`*^9}, {3.799499569413342*^9, 3.7994997583522053`*^9}, {
   3.7994997926599913`*^9, 3.7994997943881683`*^9}, {3.799499839558166*^9, 
   3.7995000360713177`*^9}, 3.799501605759563*^9, {3.799671898671536*^9, 
   3.799671907745613*^9}, {3.86652067835417*^9, 3.866520690075067*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["5/ SIMPLIFYING THE COLLISION OPERATOR", \
"Subsubsection"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.79950158496741*^9, 3.799501597574175*^9}, 
   3.860733174720167*^9, {3.866178767818408*^9, 3.866178770362108*^9}, {
   3.8661788702825127`*^9, 3.866178872473864*^9}, {3.8661790141012917`*^9, 
   3.866179014341069*^9}, {3.866190359396596*^9, 3.866190374530572*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "We", " ", "can", " ", "now", " ", "compute", " ", "the", " ", "collision",
     " ", "operator", " ", "in", " ", "the", " ", "evolution", " ", 
    "equation", " ", "for", " ", 
    RowBox[{"dF", "/", 
     RowBox[{"dt", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"First", ",", " ", 
    RowBox[{"we", " ", "isolate", " ", 
     RowBox[{"dF", "/", "dt"}], " ", "on", " ", "one", " ", 
     RowBox[{"side", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{"BBGKYFCALC", ",", 
           RowBox[{"DER", "[", 
            RowBox[{
             RowBox[{"F", "[", 
              RowBox[{"J1", ",", "t"}], "]"}], ",", "t"}], "]"}]}], "]"}], "//",
          "First"}], "//", "Last"}], "//", "Last"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"To", " ", "avoid", " ", "confusion"}], ",", " ", 
     RowBox[{
     "we", " ", "relabel", " ", "the", " ", "outside", " ", "action", " ", 
      "variable", " ", "as", " ", 
      RowBox[{"J", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dFdt", " ", "=", " ", 
     RowBox[{"ReplaceVariables", "[", 
      RowBox[{"dFdt", ",", 
       RowBox[{"{", "J1", "}"}], ",", 
       RowBox[{"{", "J", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"We", " ", "already", " ", "know", " ", "the", " ", 
      RowBox[{"1", "/", "N"}], " ", "term"}], ",", " ", 
     RowBox[{
     "so", " ", "that", " ", "we", " ", "can", " ", "drop", " ", "the", " ", 
      "contributions", " ", "from", " ", 
      RowBox[{"G21k", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dFdt", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"G21k", "[", 
           RowBox[{"l_", ",", "t_"}], "]"}], "\[RuleDelayed]", "0"}], "}"}]}],
        ")"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Since", " ", "the", " ", "diffusion", " ", "equation", " ", "is", " ", 
      "the", " ", "divergence", " ", "of", " ", "a", " ", "flux"}], ",", " ", 
     
     RowBox[{
     "we", " ", "want", " ", "to", " ", "keep", " ", "the", " ", "outside", 
      " ", 
      RowBox[{"DER", "[", 
       RowBox[{",", 
        RowBox[{"{", "J", "}"}]}], "]"}], " ", "as", " ", 
      RowBox[{"is", ".", "\[IndentingNewLine]", "And"}], " ", "we", " ", "do",
       " ", "not", " ", "want", " ", "to", " ", "perform", " ", "any", " ", 
      "simplifications", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", "it", "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"dFdt", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Gathering", " ", "the", " ", "terms", " ", "in", " ", "a", " ", 
           "full", " ", 
           RowBox[{"derivative", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DER", "[", 
               RowBox[{
                RowBox[{"UPotk", "[", 
                 RowBox[{"A_", ",", "B_"}], "]"}], ",", "J"}], "]"}], " ", 
              RowBox[{"G22k", "[", 
               RowBox[{"C_", ",", "t_"}], "]"}]}], ")"}]}], "\[RuleDelayed]", 
           
           RowBox[{
            RowBox[{"DERh", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"UPotk", "[", 
                RowBox[{"A", ",", "B"}], "]"}], " ", 
               RowBox[{"G22k", "[", 
                RowBox[{"C", ",", "t"}], "]"}]}], ",", "J"}], "]"}], " ", "-",
             " ", 
            RowBox[{
             RowBox[{"UPotk", "[", 
              RowBox[{"A", ",", "B"}], "]"}], " ", 
             RowBox[{"DER", "[", 
              RowBox[{
               RowBox[{"G22k", "[", 
                RowBox[{"C", ",", "t"}], "]"}], ",", "J"}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Moving", " ", "the", " ", "derivative", " ", 
            RowBox[{"outside", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"INT", "[", 
              RowBox[{
               RowBox[{"DERh", "[", 
                RowBox[{"A_", ",", "J"}], "]"}], ",", 
               RowBox[{"{", "Jp_", "}"}]}], "]"}], ")"}]}], "\[RuleDelayed]", 
           
           RowBox[{"DERh", "[", 
            RowBox[{
             RowBox[{"INT", "[", 
              RowBox[{"A", ",", 
               RowBox[{"{", "Jp", "}"}]}], "]"}], ",", "J"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{"A_", " ", 
                RowBox[{"DERh", "[", 
                 RowBox[{"B_", ",", "J"}], "]"}]}], ",", 
               RowBox[{"{", "kp_", "}"}]}], "]"}], ")"}]}], "\[RuleDelayed]", 
           
           RowBox[{
            RowBox[{"DERh", "[", 
             RowBox[{
              RowBox[{"SUM", "[", 
               RowBox[{
                RowBox[{"A", " ", "B"}], ",", 
                RowBox[{"{", "kp", "}"}]}], "]"}], ",", "J"}], "]"}], "/;", 
            RowBox[{"(", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"A", ",", "J"}], "]"}], ")"}]}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Putting", " ", "the", " ", "outside", " ", "prefactors", " ", "inside", 
      " ", "the", " ", 
      RowBox[{"DER", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "we", " ", "make", " ", "sure", " ", "that", " ", "they", " ", "do", " ",
       "not", " ", "depend", " ", "on", " ", "the", " ", "variable", " ", 
      "used", " ", "to", " ", 
      RowBox[{"differentiate", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dFdt", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"A_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FreeQ", "[", 
               RowBox[{"#", ",", "J"}], "]"}], "&"}], ")"}]}], 
           RowBox[{"DERh", "[", 
            RowBox[{"B_", ",", "J"}], "]"}]}], "\[RuleDelayed]", 
          RowBox[{"DERh", "[", 
           RowBox[{
            RowBox[{"A", " ", "B"}], ",", "J"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], ")"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "extract", " ", "the", " ", "term", " ", "within",
       " ", "the", " ", 
      RowBox[{"DER", "[", 
       RowBox[{",", "J"}], "]"}]}], ",", " ", 
     RowBox[{
     "and", " ", "it", " ", "is", " ", "on", " ", "this", " ", "term", " ", 
      "that", " ", "we", " ", "will", " ", "make", " ", 
      RowBox[{"simplifications", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"(", 
      RowBox[{"dFdt", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DERh", "[", 
          RowBox[{"A_", ",", "J"}], "]"}], "\[RuleDelayed]", "A"}], "}"}]}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"In", " ", "that", " ", "integrand"}], ",", " ", 
     RowBox[{
     "we", " ", "can", " ", "now", " ", "replace", " ", "G22k", " ", "with", 
      " ", "the", " ", "previously", " ", "determined", " ", 
      RowBox[{"expression", ".", "\[IndentingNewLine]", "There"}], " ", "are",
       " ", "no", " ", "overlap", " ", "of", " ", "dummy", " ", "variables"}],
      ",", " ", 
     RowBox[{
     "so", " ", "that", " ", "we", " ", "can", " ", "safely", " ", "make", 
      " ", "this", " ", 
      RowBox[{"replacement", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"G22k", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ka_", ",", "Ja_"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"kb_", ",", "Jb_"}], "}"}]}], "}"}], ",", "ta_"}], 
           "]"}], "\[RuleDelayed]", 
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"ExpG22k", ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", "J1", ",", "k2", ",", "J2", ",", "t"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"ka", ",", "Ja", ",", "kb", ",", "Jb", ",", "ta"}], 
             "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"We", " ", "now", " ", "relabel", " ", "the", " ", "dummy", " ", 
     RowBox[{"variables", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"WrappedRelabelDummy", "[", "integranddFdt", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "To", " ", "get", " ", "the", " ", "asymptotic", " ", "behaviour"}], ",",
      " ", 
     RowBox[{
     "we", " ", "send", " ", "all", " ", "the", " ", "temporal", " ", 
      "bounds", " ", "to", " ", "infinity"}], ",", " ", 
     RowBox[{
     "without", " ", "any", " ", "corrections", " ", "in", " ", "the", " ", 
      "volume", " ", 
      RowBox[{"prefactor", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"INTb", "[", 
              RowBox[{"A_", ",", 
               RowBox[{"{", 
                RowBox[{"t1", ",", "0", ",", "t"}], "}"}]}], "]"}], ")"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"INTb", "[", 
            RowBox[{"A", ",", 
             RowBox[{"{", 
              RowBox[{"t1", ",", "0", ",", 
               RowBox[{"+", "\[Infinity]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"INTb", "[", 
              RowBox[{"A_", ",", 
               RowBox[{"{", 
                RowBox[{"t2", ",", "0", ",", "t1"}], "}"}]}], "]"}], ")"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"INTb", "[", 
            RowBox[{"A", ",", 
             RowBox[{"{", 
              RowBox[{"t2", ",", "0", ",", 
               RowBox[{"+", "\[Infinity]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"INTb", "[", 
              RowBox[{"A_", ",", 
               RowBox[{"{", 
                RowBox[{"t3", ",", "0", ",", "t2"}], "}"}]}], "]"}], ")"}]}], 
           "\[RuleDelayed]", 
           RowBox[{"INTb", "[", 
            RowBox[{"A", ",", 
             RowBox[{"{", 
              RowBox[{"t3", ",", "0", ",", 
               RowBox[{"+", "\[Infinity]"}]}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "have", " ", "a", " ", "better", " ",
       "looking", " ", "expression"}], ",", " ", 
     RowBox[{"we", " ", "push", " ", "the", " ", "SUM", " ", 
      RowBox[{"outside", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Pushing", " ", "the", " ", "SUM", " ", 
           RowBox[{"outwards", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"INT", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xINT_:", "1"}], ")"}], 
                RowBox[{"SUM", "[", 
                 RowBox[{"xSUM_", ",", "lSUM_"}], "]"}]}], ",", "lINT_"}], 
              "]"}], ")"}]}], "\[RuleDelayed]", 
           RowBox[{"SUM", "[", 
            RowBox[{
             RowBox[{"INT", "[", 
              RowBox[{
               RowBox[{"xSUM", " ", "xINT"}], ",", "lINT"}], "]"}], ",", 
             "lSUM"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"INTb", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xINTb_:", "1"}], ")"}], 
                RowBox[{"SUM", "[", 
                 RowBox[{"xSUM_", ",", "lSUM_"}], "]"}]}], ",", "lINTb_"}], 
              "]"}], ")"}]}], "\[RuleDelayed]", 
           RowBox[{"SUM", "[", 
            RowBox[{
             RowBox[{"INTb", "[", 
              RowBox[{
               RowBox[{"xSUM", " ", "xINTb"}], ",", "lINTb"}], "]"}], ",", 
             "lSUM"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"DER", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xDER_:", "1"}], ")"}], " ", 
                RowBox[{"SUM", "[", 
                 RowBox[{"xSUM_", ",", "lSUM_"}], "]"}]}], ",", "lDER_"}], 
              "]"}], ")"}]}], "\[RuleDelayed]", 
           RowBox[{"SUM", "[", 
            RowBox[{
             RowBox[{"DER", "[", 
              RowBox[{
               RowBox[{"xSUM", " ", "xDER"}], ",", "lDER"}], "]"}], ",", 
             "lSUM"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Merging", " ", "the", " ", 
            RowBox[{"SUM", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xA_:", "1"}], ")"}], " ", 
                RowBox[{"SUM", "[", 
                 RowBox[{"xB_", ",", "lB_"}], "]"}]}], ",", "lA_"}], "]"}], 
             ")"}]}], "\[RuleDelayed]", 
           RowBox[{"SUM", "[", 
            RowBox[{
             RowBox[{"xA", " ", "xB"}], ",", 
             RowBox[{"lA", "~", "Join", "~", "lB"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "perform", " ", "all", " ", "the", " ", "time", 
      " ", "integrals", " ", "replacing", " ", "them", " ", "with", " ", 
      "the", " ", "appropriate", " ", "resonant", " ", 
      RowBox[{"denominator", ".", "\[IndentingNewLine]", "We"}], " ", 
      "introduce", " ", "the", " ", "function", " ", 
      RowBox[{"Pos", "[", "\[Omega]R", "]"}]}], "=", 
     RowBox[{
      RowBox[{"\[Omega]R", "+", 
       RowBox[{"I\[Gamma]", " ", "with", " ", "\[Gamma]"}]}], ">", "0."}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesCauchy", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"INTb", "[", 
         RowBox[{
          RowBox[{"EXP", "[", 
           RowBox[{"I", " ", 
            RowBox[{"(", 
             RowBox[{"ta_", " ", "-", " ", "tb_"}], ")"}], " ", "\[Omega]_"}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"tb_", ",", "0", ",", 
            RowBox[{"+", "\[Infinity]"}]}], "}"}]}], "]"}], "\[RuleDelayed]", 
        
        RowBox[{"I", "/", 
         RowBox[{"Pos", "[", "\[Omega]", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"INTb", "[", 
         RowBox[{
          RowBox[{"EXP", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"(", 
             RowBox[{"ta_", " ", "-", " ", "tb_"}], ")"}], " ", "\[Omega]_"}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"tb_", ",", "0", ",", 
            RowBox[{"+", "\[Infinity]"}]}], "}"}]}], "]"}], "\[RuleDelayed]", 
        
        RowBox[{"I", "/", 
         RowBox[{"Pos", "[", 
          RowBox[{"-", "\[Omega]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "Cauchy", " ", 
      RowBox[{"rule", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{"it", " ", "is", " ", "essential", " ", "to", " ", "use", " ", 
      RowBox[{"RepeatedRules", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulesCauchy"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "have", " ", "a", " ", "better", " ",
       "looking", " ", "expression"}], ",", "\[IndentingNewLine]", 
     RowBox[{"we", " ", "push", " ", "the", " ", "DER", " ", "inside"}], ",", 
     
     RowBox[{"and", " ", "merge", " ", "the", " ", 
      RowBox[{"INT", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Pushing", " ", "the", " ", "DER", " ", 
           RowBox[{"inwards", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"DER", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xDER_:", "1"}], ")"}], " ", 
                RowBox[{"INT", "[", 
                 RowBox[{"xINT_", ",", "lINT_"}], "]"}]}], ",", "lDER_"}], 
              "]"}], ")"}]}], "\[RuleDelayed]", 
           RowBox[{"INT", "[", 
            RowBox[{
             RowBox[{"DER", "[", 
              RowBox[{
               RowBox[{"xDER", " ", "xINT"}], " ", ",", "lDER"}], "]"}], ",", 
             "lINT"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Merging", " ", "the", " ", 
            RowBox[{"INT", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"HoldPattern", "@", 
            RowBox[{"(", 
             RowBox[{"INT", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xA_:", "1"}], ")"}], 
                RowBox[{"INT", "[", 
                 RowBox[{"xB_", ",", "lB_"}], "]"}]}], ",", "lA_"}], "]"}], 
             ")"}]}], "\[RuleDelayed]", 
           RowBox[{"INT", "[", 
            RowBox[{
             RowBox[{"xA", " ", "xB"}], ",", 
             RowBox[{"lA", "~", "Join", "~", "lB"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Relabelling", " ", "the", " ", "equations"}], ",", " ", 
     RowBox[{"in", " ", "case", " ", "it", " ", 
      RowBox[{"helps", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"WrappedRelabelDummy", "[", "integranddFdt", "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "have", " ", "simpler", " ", 
      "resonance", " ", "conditions"}], ",", " ", 
     RowBox[{"we", " ", "make", " ", "sure", " ", "that", " ", 
      RowBox[{"UPotk", "[", 
       RowBox[{"k_", ","}], "]"}], " ", "only", " ", "has", " ", "for", " ", 
      "arguments", " ", 
      RowBox[{"UPotk", "[", "k1", "]"}]}], ",", " ", 
     RowBox[{"UPotk", "[", "k2", "]"}], ",", 
     RowBox[{
      RowBox[{"UPotk", "[", 
       RowBox[{"k1", "+", "k2"}], "]"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleNegk2", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SUM", "[", 
        RowBox[{"xSUM_", ",", "varSUM_"}], "]"}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"xSUM", ",", 
            RowBox[{"{", "k2", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"-", "k2"}], "}"}]}], "]"}], ",", "varSUM"}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"varSUM", ",", "k2"}], "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"xSUM", ",", 
             RowBox[{"UPotk", "[", 
              RowBox[{
               RowBox[{"k1", "-", "k2"}], ",", "_"}], "]"}]}], "]"}]}]}], 
         ")"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RuleNegk2"}], "]"}], "//", "Expand"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "want", " ", "the", " ", "resonant", " ", 
      "denominators", " ", "to", " ", "appear", " ", "with", " ", "a", " ", 
      "form", " ", "as", " ", "simple", " ", "as", " ", 
      RowBox[{"possible", ".", "\[IndentingNewLine]", "As"}], " ", "of", " ", 
      "now"}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "are", " ", "facing", " ", "the", " ", "following", " ", 
       "type", " ", "of", " ", "resonant", " ", "denominators", 
       "\[IndentingNewLine]", 
       RowBox[{"Pos", "[", 
        RowBox[{"\[Epsilon]k1", 
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
        "]"}], " ", "with", " ", "\[Epsilon]"}], "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"1", "\[IndentingNewLine]", 
       RowBox[{"Pos", "[", 
        RowBox[{"\[Epsilon]k2", 
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
        "]"}], " ", "with", " ", "\[Epsilon]"}], "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"1", "\[IndentingNewLine]", 
       RowBox[{"Pos", "[", 
        RowBox[{"\[Epsilon]", 
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
        "]"}], " ", "with", " ", "\[Epsilon]"}], "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{
      "1", "\[IndentingNewLine]", "as", " ", "well", " ", "as", " ", "the", 
       " ", "three"}], "-", 
      RowBox[{"body", " ", "resonances", "\[IndentingNewLine]", 
       RowBox[{"Pos", "[", 
        RowBox[{
         RowBox[{"k1", 
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
         "+", 
         RowBox[{"k2", 
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]c"}], ")"}]}]}], 
        "]"}], "\[IndentingNewLine]", 
       RowBox[{"Pos", "[", 
        RowBox[{
         RowBox[{"k1", 
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
         "+", 
         RowBox[{"k2", 
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]b", "-", "\[CapitalOmega]c"}], ")"}]}]}], 
        "]"}], "\[IndentingNewLine]", "Our", " ", "goal", " ", "is", " ", 
       "now", " ", "to", " ", "make", " ", "sure", " ", "that", " ", "in", 
       " ", "the", " ", "3"}], "-", 
      RowBox[{"body", " ", "resonances"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "the", " ", "velocity", " ", "that", " ", "appears", " ", "twice", " ",
         "appears", " ", "with", " ", "the", " ", "same", " ", 
        RowBox[{"sign", ".", "\[IndentingNewLine]", "The"}], " ", "key", " ", 
        "remark", " ", "is", " ", "to", " ", "note", " ", "that", 
        "\[IndentingNewLine]", "k1", 
        RowBox[{"(", 
         RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], "+", 
       
       RowBox[{"k2", 
        RowBox[{"(", 
         RowBox[{"\[CapitalOmega]b", "-", "\[CapitalOmega]c"}], ")"}], 
        "\[IndentingNewLine]", "under", " ", "the", " ", "change", " ", 
        RowBox[{"{", 
         RowBox[{"k1", ",", "k2"}], "}"}]}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k1", "+", "k2"}], ",", "k2"}], "}"}], " ", "becomes", 
        "\[IndentingNewLine]", "k1", 
        RowBox[{"(", 
         RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], "+", 
       
       RowBox[{"k2", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]c"}], ")"}], ".", 
         "\[IndentingNewLine]", "ATTENTION"}]}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "when", " ", "making", " ", "this", " ", "change", " ", "the", " ", 
       "coupling", " ", "factors", " ", "become", "\[IndentingNewLine]", 
       RowBox[{"UPotk", "[", "k1", "]"}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{
        RowBox[{"UPotk", "[", 
         RowBox[{"k1", "+", "k2"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"UPotk", "[", "k2", "]"}]}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{
         RowBox[{"UPotk", "[", "k2", "]"}], "\[IndentingNewLine]", 
         RowBox[{"UPotk", "[", 
          RowBox[{"k1", "+", "k2"}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"UPotk", "[", 
          RowBox[{"k1", "+", 
           RowBox[{"2", "k2"}]}], "]"}], "\[IndentingNewLine]", "We", " ", 
         "do", " ", "not", " ", "want", " ", "any", " ", "coupling", " ", 
         "factor", " ", "of", " ", "the", " ", "form", " ", 
         RowBox[{"UPotk", "[", 
          RowBox[{"k1", "+", 
           RowBox[{"2", "k2"}]}], "]"}], " ", "to", " ", 
         RowBox[{"appear", ".", "\[IndentingNewLine]", "As"}], " ", "a", " ", 
         "consequence"}]}]}]}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "make", " ", "sure", " ", "that", " ",
       "the", " ", "rule", " ", "is", " ", "only", " ", "applied", " ", "in", 
      " ", "expressions", "\[IndentingNewLine]", "that", " ", "do", " ", 
      "NOT", " ", "contain", " ", 
      RowBox[{
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", "+", "k2"}], "]"}], ".", "\[IndentingNewLine]", 
       "Fortunately"}]}], ",", " ", 
     RowBox[{
     "\"\<nasty\>\"", " ", "resonance", " ", "conditions", " ", "of", " ", 
      "the", " ", "form", "\[IndentingNewLine]", 
      RowBox[{"Pos", "[", 
       RowBox[{
        RowBox[{"k1", 
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], "+", 
        RowBox[{"k2", 
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]b", "-", "\[CapitalOmega]c"}], ")"}]}]}], 
       "]"}], " ", "only", " ", "appear", " ", "in", " ", "terms", " ", 
      "that", " ", "do", " ", "NOT", " ", "involve", " ", 
      RowBox[{
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", "+", "k2"}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleSimplerPos", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SUM", "[", 
        RowBox[{"xSUM_", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"xSUM", ",", 
            RowBox[{"{", "k1", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k1", "+", "k2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "/;", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Checking", " ", "that", " ", "the", " ", "expression", " ", "does",
            " ", "not", " ", "contain", " ", 
           RowBox[{
            RowBox[{"UPotk", "[", 
             RowBox[{"k1", "+", "k2"}], "]"}], "."}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"xSUM", ",", 
            RowBox[{"UPotk", "[", 
             RowBox[{
              RowBox[{"k1", "+", "k2"}], ",", "_"}], "]"}]}], "]"}], 
          "\[IndentingNewLine]", "&&", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Checking", " ", "that", " ", "the", " ", "expression", " ", 
             "contains", " ", "an", " ", "unpleasant", " ", "3"}], "-", 
            RowBox[{"body", " ", 
             RowBox[{"resonance", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"xSUM", ",", 
             RowBox[{"Pos", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ka_", "?", "WaveQ"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], "-", 
                  RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}],
                "+", 
               RowBox[{
                RowBox[{"kb_", "?", "WaveQ"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}], "-", 
                  RowBox[{"\[CapitalOmega]c_", "?", "FrequencyQ"}]}], 
                 ")"}]}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
         ")"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RuleSimplerPos"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Relabelling", " ", "in", " ", "case", " ", "it", " ", 
     RowBox[{"helps", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"integranddFdt", "//", "WrappedRelabelDummy"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "In", " ", "order", " ", "to", " ", "further", " ", "reduce", " ", 
       "the", " ", "diversity", " ", "of", " ", "non"}], "-", 
      RowBox[{"trivial", " ", "resonance", " ", "conditions"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "make", " ", "some", " ", "additional", " ", "substitutions",
        " ", 
       RowBox[{"{", 
        RowBox[{"J1", ",", "J2"}], "}"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"J2", ",", "J1"}], "}"}], ".", "\[IndentingNewLine]", 
        "Following"}], " ", "these", " ", "manipulations"}]}], ",", " ", 
     RowBox[{
      RowBox[{"the", " ", "only", " ", "non"}], "-", 
      RowBox[{
      "trivial", " ", "resonance", " ", "conditions", " ", "that", " ", 
       "remain", " ", "are", "\[IndentingNewLine]", 
       RowBox[{"Pos", "[", 
        RowBox[{
         RowBox[{"k1", 
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}], "+", 
         RowBox[{"k2", 
          RowBox[{"(", 
           RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}]}], 
        "]"}], " ", "and", " ", 
       RowBox[{
        RowBox[{"Pos", "[", 
         RowBox[{
          RowBox[{"k1", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}], 
          "-", 
          RowBox[{"k2", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]1", "-", "\[CapitalOmega]2"}], ")"}]}]}], 
         "]"}], "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesSimplererPos", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "For", " ", "resonances", " ", "of", " ", "the", " ", "form", 
         "\[IndentingNewLine]", 
         RowBox[{"Pos", "[", 
          RowBox[{
           RowBox[{"k1", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}], 
           "+", 
           RowBox[{"k2", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}]}], 
          "]"}], " ", "we", " ", "make", " ", "the", " ", "switch", " ", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"J2", ",", "J1"}], "}"}], "."}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"INT", "[", 
          RowBox[{"xINT_", ",", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{"ReplaceVariables", "[", 
            RowBox[{"xINT", ",", 
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"J2", ",", "J1"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"xINT", ",", 
             RowBox[{
              RowBox[{"k1", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
              RowBox[{"k2", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
              RowBox[{"k2", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
              RowBox[{"k1", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}]}], "]"}]}], 
          ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "For", " ", "resonances", " ", "of", " ", "the", " ", "form", 
          "\[IndentingNewLine]", 
          RowBox[{"Pos", "[", 
           RowBox[{
            RowBox[{"k1", 
             RowBox[{"(", 
              RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}], 
            "-", 
            RowBox[{"k2", 
             RowBox[{"(", 
              RowBox[{"\[CapitalOmega]1", "-", "\[CapitalOmega]2"}], 
              ")"}]}]}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"we", " ", "make", " ", "the", " ", "switch", " ", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "\[Rule]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"J2", ",", "J1"}], "}"}], "."}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"INT", "[", 
          RowBox[{"xINT_", ",", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{"ReplaceVariables", "[", 
            RowBox[{"xINT", ",", 
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"J2", ",", "J1"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"xINT", ",", 
             RowBox[{
              RowBox[{"k1", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
              RowBox[{"k2", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
              RowBox[{"k1", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], "+", 
              RowBox[{"k2", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}]}], "]"}]}], 
          ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "For", " ", "resonances", " ", "of", " ", "the", " ", "form", 
          "\[IndentingNewLine]", 
          RowBox[{"Pos", "[", 
           RowBox[{
            RowBox[{"k1", 
             RowBox[{"(", 
              RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}], 
            "+", 
            RowBox[{"k2", 
             RowBox[{"(", 
              RowBox[{"\[CapitalOmega]1", "-", "\[CapitalOmega]2"}], 
              ")"}]}]}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"we", " ", "make", " ", "the", " ", "switch", " ", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "\[Rule]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"J2", ",", "J1"}], "}"}], "."}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"INT", "[", 
          RowBox[{"xINT_", ",", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{"ReplaceVariables", "[", 
            RowBox[{"xINT", ",", 
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"J2", ",", "J1"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"xINT", ",", 
             RowBox[{
              RowBox[{"k1", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
              RowBox[{"k2", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
              RowBox[{"k1", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], "-", 
              RowBox[{"k2", " ", 
               RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}]}], "]"}]}], 
          ")"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulesSimplererPos"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "continue", " ", "simplifying", " ", "the", " ", "resonance", 
      " ", "condition", "\[IndentingNewLine]", "so", " ", "that", " ", "a", 
      " ", "single", " ", "type", " ", "of", " ", "three"}], "-", 
     RowBox[{"body", " ", "resonance", " ", "condition", " ", 
      RowBox[{"occurs", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleSimplerererPos", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Resonances", " ", "of", " ", "the", " ", "form", 
         "\[IndentingNewLine]", 
         RowBox[{"Pos", "[", 
          RowBox[{
           RowBox[{"k1", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}], 
           "-", 
           RowBox[{"k2", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]1", "-", "\[CapitalOmega]2"}], ")"}]}]}],
           "]"}], " ", "become", "\[IndentingNewLine]", 
         RowBox[{"Pos", "[", 
          RowBox[{
           RowBox[{"k1", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}], 
           "+", 
           RowBox[{"k2", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}]}], 
          "]"}], " ", "under", " ", "the", " ", "change", " ", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2"}], "}"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"k1", "+", "k2"}], ",", 
           RowBox[{"-", "k2"}]}], "}"}], "."}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"SUM", "[", 
         RowBox[{"xSUM_", ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"xSUM", ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", "k2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k1", "+", "k2"}], ",", 
              RowBox[{"-", "k2"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"xSUM", ",", 
            RowBox[{
             RowBox[{"k1", " ", 
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
             RowBox[{"k1", " ", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
             RowBox[{"k2", " ", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "+", 
             RowBox[{"k2", " ", 
              RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}]}], "]"}]}], 
         ")"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RuleSimplerererPos"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "Plemelj", " ", 
      RowBox[{"formula", ".", "\[IndentingNewLine]", "This"}], " ", "is", " ",
       "the", " ", "step", " ", "where", " ", "the", " ", "number", " ", "of",
       " ", "terms", " ", "is", " ", "going", " ", "to", " ", "become", " ", 
      "the", " ", 
      RowBox[{"largest", ".", "\[IndentingNewLine]", "We"}], " ", "have", " ", 
      RowBox[{"1", "/", 
       RowBox[{"Pos", "[", "\[Omega]", "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"\[Omega]", "+", "I\[Gamma]"}], ")"}]}], "=", 
      RowBox[{
       RowBox[{"PRPA", "[", 
        RowBox[{"1", "/", "\[Omega]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"I\[Pi]DIRAC", "[", "\[Omega]", "]"}], "."}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePlemelj", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "We", " ", "write", " ", "the", " ", "rule", " ", "in", " ", "that", 
         " ", "form"}], ",", " ", 
        RowBox[{
        "so", " ", "that", " ", "it", " ", "also", " ", "applies", " ", "to", 
         " ", "denominators", " ", 
         RowBox[{"squared", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Pos", "[", "\[Omega]_", "]"}], "^", 
        RowBox[{"(", 
         RowBox[{"n_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "2"}]}], "}"}], ",", "#"}], "]"}], "&"}], 
           ")"}]}], ")"}]}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"PRPA", "[", 
           RowBox[{"1", "/", "\[Omega]"}], "]"}], "-", " ", 
          RowBox[{"I", " ", "\[Pi]", " ", 
           RowBox[{"DIRAC", "[", "\[Omega]", "]"}]}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"-", "n"}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulePlemelj"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "All", " ", "the", " ", "functions", " ", "that", " ", "are", " ", 
      "present", " ", "in", " ", "the", " ", "expression", " ", "are", " ", 
      "now", " ", 
      RowBox[{"real", ".", "\[IndentingNewLine]", "As"}], " ", "a", " ", 
      "consequence"}], ",", " ", 
     RowBox[{
     "we", " ", "can", " ", "limit", " ", "ourselves", " ", "only", " ", "to",
       " ", "the", " ", "real", " ", 
      RowBox[{"part", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "this", " ", "might", " ", "not", " ", "be", " ", "the", " ", "most", 
      " ", "robust", " ", "coding"}], ",", " ", 
     RowBox[{"but", " ", "it", " ", "is", " ", 
      RowBox[{"fast", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleRe", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Complex", "[", 
        RowBox[{"0", ",", "x_"}], "]"}], "\[RuleDelayed]", "0"}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", 
      RowBox[{"rule", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{"by", " ", "safety"}], ",", " ", 
     RowBox[{
     "we", " ", "make", " ", "sure", " ", "that", " ", "the", " ", "term", 
      " ", "is", " ", 
      RowBox[{"expanded", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"integranddFdt", "//", "Expand"}], "//", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "/.", "RuleRe"}], "&"}], ")"}]}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Rule", " ", "that", " ", "removes", " ", "all", " ", "the", " ", 
      "occurrences", " ", "of", " ", "the", " ", "DER", " ", 
      RowBox[{"operator", ".", "\[IndentingNewLine]", "It"}], " ", "is", " ", 
      "important", " ", "to", " ", "make", " ", "this", " ", "change", " ", 
      "so", " ", "that", " ", "we", " ", "can", " ", "easily", " ", "make", 
      " ", "the", " ", "replacements", "\[IndentingNewLine]", "imposed", " ", 
      "by", " ", 
      RowBox[{
       RowBox[{"DIRAC", "[", 
        RowBox[{
         RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
         RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}], "]"}], ".", 
       "\[IndentingNewLine]", "Indeed"}]}], ",", " ", 
     RowBox[{
      RowBox[{"those", " ", "impose", " ", "Jb"}], "\[RuleDelayed]", "Ja"}], 
     ",", " ", 
     RowBox[{
     "since", " ", "the", " ", "frequency", " ", "profile", " ", "is", " ", 
      RowBox[{"monotonic", ".", "\[IndentingNewLine]", "In"}], " ", 
      "particular"}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "pay", " ", "attention", " ", "to", 
      " ", "the", " ", "fact", " ", "that", "\[IndentingNewLine]", 
      RowBox[{"DER", "[", 
       RowBox[{
        RowBox[{"UPotk", "[", 
         RowBox[{"J1", ",", "J2"}], "]"}], ",", "J2"}], "]"}], 
      RowBox[{"DIRAC", "[", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "J1", "]"}], "-", 
        RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], "]"}], " ", "is", " ", 
      "NOT", " ", "the", " ", "same", " ", "as", " ", 
      RowBox[{"DER", "[", 
       RowBox[{
        RowBox[{"UPotk", "[", 
         RowBox[{"J1", ",", "J1"}], "]"}], ",", "J1"}], "]"}], " ", 
      RowBox[{
       RowBox[{"DIRAC", "[", 
        RowBox[{
         RowBox[{"\[CapitalOmega]", "[", "J1", "]"}], "-", 
         RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], "]"}], ".", 
       "\[IndentingNewLine]", "This"}], " ", "is", " ", "one", " ", "the", 
      " ", "main", " ", "reason", " ", "why", " ", "we", " ", "give", " ", 
      "explicit", " ", "names", " ", "to", " ", "the", " ", "differentiated", 
      " ", 
      RowBox[{"functions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesDER", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Derivatives", " ", "of", " ", "the", " ", 
        RowBox[{"DF", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"F", "[", "Ja_", "]"}], ",", "Jb_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Ja", ",", "Jb"}], "]"}], " ", 
         RowBox[{"FP", "[", "Ja", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"FP", "[", "Ja_", "]"}], ",", "Jb_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Ja", ",", "Jb"}], "]"}], " ", 
         RowBox[{"FPP", "[", "Ja", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"FPP", "[", "Ja_", "]"}], ",", "Jb_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Ja", ",", "Jb"}], "]"}], 
         RowBox[{"FPPP", "[", "Ja", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Derivatives", " ", "of", " ", "the", " ", 
         RowBox[{"DIRAC", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"DIRAC", "[", "\[CapitalOmega]a_", "]"}], ",", "Jb_"}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"DER", "[", 
          RowBox[{"\[CapitalOmega]a", ",", "Jb"}], "]"}], " ", 
         RowBox[{"DIRACP", "[", "\[CapitalOmega]a", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"DIRACP", "[", "\[CapitalOmega]a_", "]"}], ",", "Jb_"}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"DER", "[", 
          RowBox[{"\[CapitalOmega]a", ",", "Jb"}], "]"}], " ", 
         RowBox[{"DIRACPP", "[", "\[CapitalOmega]a", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Derivatives", " ", "of", " ", "the", " ", 
         RowBox[{"PRPA", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"PRPA", "[", "\[CapitalOmega]a_", "]"}], ",", "Jb_"}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"DER", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", "\[CapitalOmega]a", ")"}]}], ",", "Jb"}], "]"}], " ", 
         RowBox[{"PRPAP", "[", "\[CapitalOmega]a", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"PRPAP", "[", "\[CapitalOmega]a_", "]"}], ",", "Jb_"}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"DER", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", "\[CapitalOmega]a", ")"}]}], ",", "Jb"}], "]"}], " ", 
         RowBox[{"PRPAPP", "[", "\[CapitalOmega]a", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Derivatives", " ", "of", " ", "the", " ", "frequency", " ", 
         RowBox[{"profile", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], ",", "Jb_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Ja", ",", "Jb"}], "]"}], 
         RowBox[{"\[CapitalOmega]P", "[", "Ja", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"\[CapitalOmega]P", "[", "Ja_", "]"}], ",", "Jb_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Ja", ",", "Jb"}], "]"}], " ", 
         RowBox[{"\[CapitalOmega]PP", "[", "Ja", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"\[CapitalOmega]PP", "[", "Ja_", "]"}], ",", "Jb_"}], "]"}],
         "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Ja", ",", "Jb"}], "]"}], " ", 
         RowBox[{"\[CapitalOmega]PPP", "[", "Ja", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Derivatives", " ", "for", " ", "the", " ", "inverse", " ", "of", " ",
          "\[CapitalOmega]P", " ", "that", " ", "arise", " ", "when", " ", 
         "performing", " ", "integration", " ", "by", " ", 
         RowBox[{"parts", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"\[CapitalOmega]P", "[", "Ja_", "]"}]}], ",", "Jb_"}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[CapitalOmega]PP", "[", "Ja", "]"}]}], " ", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"Ja", ",", "Jb"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]P", "[", "Ja", "]"}], "^", 
            RowBox[{"(", "2", ")"}]}], ")"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Rules", " ", "for", " ", "the", " ", "derivatives", " ", "of", " ", 
          "the", " ", "interaction", " ", 
          RowBox[{"potential", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
         ",", " ", 
         RowBox[{"we", " ", "need", " ", "to", " ", "be", " ", "careful"}], 
         ",", " ", 
         RowBox[{
         "as", " ", "both", " ", "action", " ", "coordinates", " ", "can", 
          " ", "get", " ", 
          RowBox[{"differentiated", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{"First", "-", 
         RowBox[{"order", " ", 
          RowBox[{"gradients", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k_", ",", 
            RowBox[{"{", 
             RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], ",", "Jc_"}], "]"}],
         "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"Ja", ",", "Jc"}], "]"}], 
           RowBox[{"UPotkP1", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"Ja", ",", "Jb"}], "}"}]}], "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"Jb", ",", "Jc"}], "]"}], 
           RowBox[{"UPotkP2", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"Ja", ",", "Jb"}], "}"}]}], "]"}]}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Second", "-", 
          RowBox[{"order", " ", 
           RowBox[{"gradients", ".", "\[IndentingNewLine]", "ATTENTION"}]}]}],
          ",", " ", 
         RowBox[{"we", " ", "use", " ", 
          RowBox[{"Schwarz", "'"}], " ", "theorem", " ", "for", " ", "the", 
          " ", "crossed", " ", 
          RowBox[{"derivative", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k_", ",", 
            RowBox[{"{", 
             RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], ",", "Jc_"}], "]"}],
         "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"Ja", ",", "Jc"}], "]"}], " ", 
           RowBox[{"UPotkP1P1", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"Ja", ",", "Jb"}], "}"}]}], "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"Jb", ",", "Jc"}], "]"}], " ", 
           RowBox[{"UPotkP1P2", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"Ja", ",", "Jb"}], "}"}]}], "]"}]}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DER", "[", 
         RowBox[{
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k_", ",", 
            RowBox[{"{", 
             RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], ",", "Jc_"}], "]"}],
         "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"Ja", ",", "Jc"}], "]"}], " ", 
           RowBox[{"UPotkP1P2", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"Ja", ",", "Jb"}], "}"}]}], "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"Jb", ",", "Jc"}], "]"}], 
           RowBox[{"UPotkP2P2", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"Ja", ",", "Jb"}], "}"}]}], "]"}]}]}], ")"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Applying", " ", "the", " ", "rule", " ", "to", " ", "get", " ", "rid", 
     " ", "of", " ", "the", " ", 
     RowBox[{"derivatives", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}],
      ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "simplify", " ", "the", " ", 
      "resonance", " ", "conditions", " ", "that", " ", "are", " ", 
      "present"}], ",", " ", 
     RowBox[{
     "we", " ", "also", " ", "take", " ", "out", " ", "all", " ", "the", " ", 
      "prefactors", " ", "from", " ", "the", " ", 
      RowBox[{"resonances", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesScaling", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Resonances", " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{"ka", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
          "]"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"DIRAC", "[", 
         RowBox[{
          RowBox[{"ka_", "?", "WaveQ"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
            RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
         "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"Abs", "[", "ka", "]"}], ")"}]}], " ", 
         RowBox[{"DIRAC", "[", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DIRACP", "[", 
         RowBox[{
          RowBox[{"ka_", "?", "WaveQ"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
            RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
         "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Abs", "[", "ka", "]"}], "ka"}], ")"}]}], " ", 
         RowBox[{"DIRACP", "[", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DIRACPP", "[", 
         RowBox[{
          RowBox[{"ka_", "?", "WaveQ"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
            RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
         "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Abs", "[", "ka", "]"}], " ", 
            RowBox[{"ka", "^", 
             RowBox[{"(", "2", ")"}]}]}], ")"}]}], " ", 
         RowBox[{"DIRACPP", "[", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Resonances", " ", "of", " ", "the", " ", "form", " ", 
         RowBox[{
          RowBox[{"DIRAC", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ka", "+", "kb"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
           "]"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DIRAC", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ka_", "?", "WaveQ"}], " ", "+", " ", 
            RowBox[{"kb_", "?", "WaveQ"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
            RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"Abs", "[", 
            RowBox[{"ka", "+", "kb"}], "]"}], ")"}]}], " ", 
         RowBox[{"DIRAC", "[", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DIRACP", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ka_", "?", "WaveQ"}], " ", "+", " ", 
            RowBox[{"kb_", "?", "WaveQ"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
            RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"ka", "+", "kb"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"ka", "+", "kb"}], ")"}]}], ")"}]}], " ", 
         RowBox[{"DIRACP", "[", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DIRACPP", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ka_", "?", "WaveQ"}], " ", "+", " ", 
            RowBox[{"kb_", "?", "WaveQ"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
            RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"ka", "+", "kb"}], "]"}], " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ka", "+", "kb"}], ")"}], "^", 
             RowBox[{"(", "2", ")"}]}]}], ")"}]}], " ", 
         RowBox[{"DIRACPP", "[", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Principal", " ", "values", " ", "of", " ", "the", " ", "form", " ", 
         RowBox[{
          RowBox[{"PRPA", "[", 
           RowBox[{"ka", "/", 
            RowBox[{"(", 
             RowBox[{"kb", 
              RowBox[{"(", 
               RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}],
              ")"}]}], "]"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PRPA", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ka", ":", 
            RowBox[{"_", "?", "WaveQ"}], ":", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kb_", "?", "WaveQ"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
              RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
           ")"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ka", "/", "kb"}], ")"}], " ", 
         RowBox[{"PRPA", "[", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PRPAP", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ka", ":", 
            RowBox[{"_", "?", "WaveQ"}], ":", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kb_", "?", "WaveQ"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
              RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
           ")"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ka", "/", "kb"}], ")"}], "^", 
          RowBox[{"(", "2", ")"}]}], " ", 
         RowBox[{"PRPAP", "[", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PRPAPP", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ka", ":", 
            RowBox[{"_", "?", "WaveQ"}], ":", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"kb_", "?", "WaveQ"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
              RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
           ")"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ka", "/", "kb"}], ")"}], "^", 
          RowBox[{"(", "3", ")"}]}], " ", 
         RowBox[{"PRPAPP", "[", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Principal", " ", "values", " ", "of", " ", "the", " ", "form", " ", 
         RowBox[{
          RowBox[{"PRPA", "[", 
           RowBox[{"ka", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"kb", "+", "kc"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}],
              ")"}]}], "]"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PRPA", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ka", ":", 
            RowBox[{"_", "?", "WaveQ"}], ":", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kb_", "?", "WaveQ"}], " ", "+", " ", 
              RowBox[{"kc_", "?", "WaveQ"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
              RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
           ")"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ka", "/", 
           RowBox[{"(", 
            RowBox[{"kb", "+", "kc"}], ")"}]}], ")"}], " ", 
         RowBox[{"PRPA", "[", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PRPAP", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ka", ":", 
            RowBox[{"_", "?", "WaveQ"}], ":", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kb_", "?", "WaveQ"}], " ", "+", " ", 
              RowBox[{"kc_", "?", "WaveQ"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
              RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
           ")"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ka", "/", 
            RowBox[{"(", 
             RowBox[{"kb", "+", "kc"}], ")"}]}], ")"}], "^", 
          RowBox[{"(", "2", ")"}]}], " ", 
         RowBox[{"PRPAP", "[", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PRPAPP", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ka", ":", 
            RowBox[{"_", "?", "WaveQ"}], ":", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kb_", "?", "WaveQ"}], " ", "+", " ", 
              RowBox[{"kc_", "?", "WaveQ"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]a_", "?", "FrequencyQ"}], " ", "-", " ", 
              RowBox[{"\[CapitalOmega]b_", "?", "FrequencyQ"}]}], ")"}]}], 
           ")"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ka", "/", 
            RowBox[{"(", 
             RowBox[{"kb", "+", "kc"}], ")"}]}], ")"}], "^", 
          RowBox[{"(", "3", ")"}]}], " ", 
         RowBox[{"PRPAPP", "[", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Applying", " ", "the", " ", "rule", " ", "to", " ", "get", " ", "rid", 
     " ", "of", " ", "as", " ", "many", " ", "front", " ", "factors", " ", 
     "as", " ", 
     RowBox[{"possible", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RulesScaling"}], "]"}], "//", 
       "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generic", " ", "rule", " ", "to", " ", "simplify", " ", "the", " ", 
     "absolute", " ", "values", " ", "squared", " ", "that", " ", "can", " ", 
     
     RowBox[{"arise", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleAbs", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "k_", "]"}], "^", 
         RowBox[{"(", 
          RowBox[{"n_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "\[NotEqual]", "1"}], "&&", 
              RowBox[{"#", "\[NotEqual]", 
               RowBox[{"-", "1"}]}]}], "&"}], ")"}]}], ")"}]}], 
        "\[RuleDelayed]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EvenQ", "@", "n"}], ",", "\[IndentingNewLine]", 
          RowBox[{"k", "^", 
           RowBox[{"(", "n", ")"}]}], ",", "\[IndentingNewLine]", "True", ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Abs", "[", "k", "]"}], 
           RowBox[{"k", "^", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Abs", "[", "k_", "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"-", "k"}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{"Internal`SyntacticNegativeQ", "[", "k", "]"}], ")"}]}]}]}],
       "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Simplifying", " ", "the", " ", "absolute", " ", 
     RowBox[{"value", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RuleAbs"}], "]"}], "//", "Expand"}]}], 
     ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "rules", " ", "that", " ", "use", " ", "the", " ", 
      "presence", " ", "of", " ", "the", " ", "resonance", " ", "conditions", 
      " ", "to", " ", "simplify", " ", "the", " ", "arguments", 
      "\[IndentingNewLine]", "of", " ", "the", " ", "other", " ", "functions",
       " ", 
      RowBox[{"present", ".", "\[IndentingNewLine]", "There"}], " ", "are", 
      " ", "only", " ", "two", " ", "types", " ", "of", " ", "resonance", " ", 
      RowBox[{"conditions", ":", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DIRAC", "[", 
         RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}], " ", 
        "and", " ", 
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{
           RowBox[{"k1", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}], 
           "+", 
           RowBox[{"k2", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}]}], 
          "]"}], ".", "\[IndentingNewLine]", "For"}], " ", "the", " ", "case",
         " ", 
        RowBox[{"DIRAC", "[", 
         RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}]}]}]}], 
     ",", " ", 
     RowBox[{
     "since", " ", "the", " ", "frequency", " ", "profile", " ", "is", " ", 
      "monotonic"}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "can", " ", "make", " ", "the", " ", "replacement", " ", 
       "Jb"}], "\[Rule]", 
      RowBox[{"Ja", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "essential", " ", "to", " ", "make", " ", "sure", 
      " ", "that", " ", "no", " ", "diverging", " ", "terms", " ", "are", " ", 
      RowBox[{"created", ".", "\[IndentingNewLine]", "For"}], " ", "the", " ",
       "case", " ", 
      RowBox[{"DIRAC", "[", 
       RowBox[{
        RowBox[{"k1", 
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}], "+", 
        
        RowBox[{"k2", 
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}]}], 
       "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "use", " ", "it", " ", "to", " ", "express", " ", 
       "\[CapitalOmega]"}], "-", 
      RowBox[{"\[CapitalOmega]2", " ", "and", " ", "\[CapitalOmega]1"}], "-", 
      
      RowBox[{
      "\[CapitalOmega]2", " ", "as", " ", "a", " ", "function", " ", "of", 
       " ", "\[CapitalOmega]"}], "-", 
      RowBox[{"\[CapitalOmega]1", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Rules", " ", "to", " ", "make", " ", "the", " ", 
      RowBox[{"replacements", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
     ",", " ", 
     RowBox[{
     "we", " ", "make", " ", "sure", " ", "that", " ", "the", " ", "rules", 
      " ", "are", " ", "applied", " ", "only", " ", "when", " ", "they", " ", 
      "do", " ", 
      RowBox[{"something", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesDIRACSub", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Resonances", " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}], 
         "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{"DIRAC", "[", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", 
              RowBox[{"Ja_", "?", "ActionQ"}], "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", 
              RowBox[{"Jb_", "?", "ActionQ"}], "]"}]}], "]"}]}], ",", 
          "varINT_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "DIFF\[CapitalOmega]a\[CapitalOmega]b", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"INT", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xINT", "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
                    RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}], 
                    "\[RuleDelayed]", 
                    "DIFF\[CapitalOmega]a\[CapitalOmega]b"}], "}"}]}], "/.", 
                  RowBox[{"{", 
                   RowBox[{"Jb", "\[RuleDelayed]", "Ja"}], "}"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                  "DIFF\[CapitalOmega]a\[CapitalOmega]b", "\[RuleDelayed]", 
                   RowBox[{
                    RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
                    RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}]}], "}"}]}], 
                ")"}], " ", 
               RowBox[{"DIRAC", "[", 
                RowBox[{
                 RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
                 RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}], "]"}]}], ",", 
              "varINT"}], "]"}]}], "\[IndentingNewLine]", "]"}], ")"}], "/;", 
         
         RowBox[{"(", 
          RowBox[{"DIRACSub1Q", "[", 
           RowBox[{"xINT", ",", "Ja", ",", "Jb"}], "]"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Same", " ", "but", " ", "with", " ", "the", " ", "square", " ", 
         RowBox[{
          RowBox[{"DIRAC", "[", 
           RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}], "^", 
          "2."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{
            RowBox[{"DIRAC", "[", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", 
               RowBox[{"Ja_", "?", "ActionQ"}], "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", 
               RowBox[{"Jb_", "?", "ActionQ"}], "]"}]}], "]"}], "^", 
            RowBox[{"(", "2", ")"}]}]}], ",", "varINT_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "DIFF\[CapitalOmega]a\[CapitalOmega]b", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"INT", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"xINT", "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
                    RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}], 
                    "\[RuleDelayed]", 
                    "DIFF\[CapitalOmega]a\[CapitalOmega]b"}], "}"}]}], "/.", 
                  RowBox[{"{", 
                   RowBox[{"Jb", "\[RuleDelayed]", "Ja"}], "}"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                  "DIFF\[CapitalOmega]a\[CapitalOmega]b", "\[RuleDelayed]", 
                   RowBox[{
                    RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
                    RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}]}], "}"}]}], 
                ")"}], " ", 
               RowBox[{
                RowBox[{"DIRAC", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
                  RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}], "]"}], "^", 
                RowBox[{"(", "2", ")"}]}]}], ",", "varINT"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ")"}], "/;", 
         RowBox[{"(", 
          RowBox[{"DIRACSub1Q", "[", 
           RowBox[{"xINT", ",", "Ja", ",", "Jb"}], "]"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Resonances", " ", "of", " ", "the", " ", "form", " ", 
           RowBox[{"DIRAC", "[", 
            RowBox[{
             RowBox[{"k1", 
              RowBox[{"(", 
               RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}], 
             "+", 
             RowBox[{"k2", 
              RowBox[{"(", 
               RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], 
               ")"}]}]}], "]"}]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"DIRAC", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"k1", "+", "k2"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}],
               "+", 
              RowBox[{"k2", 
               RowBox[{"(", 
                RowBox[{"\[CapitalOmega]1", "-", "\[CapitalOmega]2"}], 
                ")"}]}]}], "]"}], ".", "\[IndentingNewLine]", "For"}], " ", 
           "that", " ", "resonance"}]}], ",", " ", 
         RowBox[{
          RowBox[{"we", " ", "have", " ", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}], 
          "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"k1", "/", "k2"}], ")"}]}], 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}]}], 
         ",", " ", 
         RowBox[{
          RowBox[{"and", " ", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]1", "-", "\[CapitalOmega]2"}], ")"}]}], 
          "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"k1", "+", "k2"}], ")"}], "/", 
              RowBox[{"(", "k2", ")"}]}], ")"}]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}], ".",
             "\[IndentingNewLine]", "For"}], " ", "this", " ", 
           "resonance"}]}], ",", " ", 
         RowBox[{
         "there", " ", "is", " ", "no", " ", "need", " ", "to", " ", "be", 
          " ", "careful"}], ",", " ", 
         RowBox[{
         "as", " ", "we", " ", "cannot", " ", "create", " ", "diverging", " ", 
          RowBox[{"terms", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{"DIRAC", "[", 
            RowBox[{
             RowBox[{"k1", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "+", 
             RowBox[{"k2", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}]}]}], 
            "]"}]}], ",", "varINT_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"xINT", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                   RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}], 
                 "\[RuleDelayed]", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"k1", "/", "k2"}], ")"}]}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                    RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}]}], 
                ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[CapitalOmega]", "[", "J1", "]"}], "-", 
                   RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}], 
                 "\[RuleDelayed]", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k1", "+", "k2"}], ")"}], "/", 
                    RowBox[{"(", "k2", ")"}]}], ")"}]}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                    RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], 
                   ")"}]}]}]}], "}"}]}], ")"}], " ", 
            RowBox[{"DIRAC", "[", 
             RowBox[{
              RowBox[{"k1", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                 RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "+", 
              
              RowBox[{"k2", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                 RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}]}]}], 
             "]"}]}], ",", "varINT"}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{"DIRACSub2Q", "[", "xINT", "]"}], ")"}]}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Functions", " ", "that", " ", "determine", " ", "whether", " ", "or", 
     " ", "not", " ", "the", " ", "application", " ", "of", " ", 
     "RulesDIRACSub", " ", "does", " ", 
     RowBox[{"something", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Test", " ", "for", " ", 
     RowBox[{
      RowBox[{"DIRAC", "[", 
       RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}], "."}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DIRACSub1Q", "[", 
      RowBox[{"xINT_", ",", "Ja_", ",", "Jb_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "DIFF\[CapitalOmega]a\[CapitalOmega]b", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"UnsameQ", "[", 
        RowBox[{"xINT", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"xINT", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
                RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}], 
               "\[RuleDelayed]", "DIFF\[CapitalOmega]a\[CapitalOmega]b"}], 
              "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{"Jb", "\[RuleDelayed]", "Ja"}], "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
            "DIFF\[CapitalOmega]a\[CapitalOmega]b", "\[RuleDelayed]", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}]}], "}"}]}], 
          ")"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Test", " ", "for", " ", 
     RowBox[{
      RowBox[{"DIRAC", "[", 
       RowBox[{
        RowBox[{"k1", 
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]1"}], ")"}]}], "+", 
        
        RowBox[{"k2", 
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}]}], 
       "]"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DIRACSub2Q", "[", "xINT_", "]"}], ":=", 
     RowBox[{"UnsameQ", "[", 
      RowBox[{"xINT", ",", 
       RowBox[{"xINT", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"k1", "/", "k2"}], ")"}]}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "J1", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"k1", "+", "k2"}], ")"}], "/", 
               RowBox[{"(", "k2", ")"}]}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}]}]}], 
         "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Applying", " ", "the", " ", "rule", " ", "to", " ", "leverage", " ", 
      "the", " ", "resonance", " ", 
      RowBox[{"condition", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "we", " ", "also", " ", "use", " ", "the", " ", "rescaling", " ", 
      "function", " ", "along", " ", "with", " ", "the", " ", "rule", " ", 
      "for", " ", "the", " ", "absolute", " ", 
      RowBox[{"values", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", 
         RowBox[{
         "RulesDIRACSub", "~", "Join", "~", "RulesScaling", "~", "Join", "~", 
          "RuleAbs"}]}], "]"}], "//", "Expand"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Some", " ", "integrals", " ", "vanish", " ", "by", " ", 
      RowBox[{"symmetry", ".", "\[IndentingNewLine]", "We"}], " ", "define", 
      " ", "a", " ", "function", " ", "that", " ", "spots", " ", "the", " ", 
      "vanishing", " ", 
      RowBox[{"integral", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "this", " ", "function", " ", "should", " ", "not", " ", "be", " ", 
      "used", " ", "with", " ", 
      RowBox[{"RepeatedRules", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleVanishingIntegral", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{"xINT_", ",", "varINT_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"VanishingIntegral", "[", 
        RowBox[{"xINT", ",", "varINT"}], "]"}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "List", " ", "of", " ", "the", " ", "simple", " ", "integrals", " ", 
     "that", " ", "vanish", " ", "by", " ", 
     RowBox[{"symmetry", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LISTVanishingIntegral", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DIRAC", "[", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", 
             RowBox[{"Ja_", "?", "ActionQ"}], "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", 
             RowBox[{"Jb_", "?", "ActionQ"}], "]"}]}], "]"}], " ", 
          RowBox[{"DIRACP", "[", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", 
             RowBox[{"Ja_", "?", "ActionQ"}], "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", 
             RowBox[{"Jb_", "?", "ActionQ"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"Jb_", "?", "ActionQ"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DIRAC", "[", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", 
             RowBox[{"Ja_", "?", "ActionQ"}], "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", 
             RowBox[{"Jb_", "?", "ActionQ"}], "]"}]}], "]"}], " ", 
          RowBox[{"PRPA", "[", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", 
               RowBox[{"Ja_", "?", "ActionQ"}], "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", 
               RowBox[{"Jb_", "?", "ActionQ"}], "]"}]}], ")"}]}], "]"}]}], 
         " ", ",", 
         RowBox[{"{", 
          RowBox[{"Jb_", "?", "ActionQ"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "takes", " ", "an", " ", 
      "integrand"}], ",", " ", "xINT", ",", " ", 
     RowBox[{
     "and", " ", "a", " ", "list", " ", "of", " ", "integration", " ", 
      "variables"}], ",", " ", "varINT", ",", " ", 
     RowBox[{
     "and", " ", "tries", " ", "to", " ", "spot", " ", "vanishing", " ", 
      RowBox[{"integrals", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VanishingIntegral", "[", 
      RowBox[{"xINT_", ",", "varINT_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"LISTSimpleINT", ",", "test"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"For", " ", "every", " ", "integration", " ", "variable"}], 
         ",", " ", 
         RowBox[{"we", " ", "return", " ", 
          RowBox[{"INT", "[", 
           RowBox[{"integrand", ",", 
            RowBox[{"{", "var", "}"}]}], "]"}], " ", "for", " ", "that", " ", 
          "one", " ", "integration", " ", 
          RowBox[{"variable", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
         ",", " ", 
         RowBox[{
         "the", " ", "second", " ", "argument", " ", "of", " ", 
          "GetPrefactorIntegrand", " ", "has", " ", "to", " ", "be", " ", "a",
           " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LISTSimpleINT", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"INT", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"GetPrefactorIntegrand", "[", 
                RowBox[{"xINT", ",", 
                 RowBox[{"{", "#", "}"}]}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ")"}], "/@", 
          "varINT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "now", " ", "have", " ", "prepared", " ", "the", " ", 
           "list", " ", "of", " ", "the", " ", "simple", " ", 
           RowBox[{"integrals", ".", "\[IndentingNewLine]", "We"}], " ", 
           "check", " ", "whether", " ", "they", " ", "match", " ", "some", 
           " ", "integrals", " ", "that", " ", "vanish", " ", "by", " ", 
           RowBox[{"symmetry", ".", "\[IndentingNewLine]", "For"}], " ", 
           "every", " ", "simple", " ", "integral"}], ",", " ", 
          RowBox[{
          "we", " ", "compare", " ", "the", " ", "pattern", " ", "with", " ", 
           "the", " ", "known", " ", "vanishing", " ", 
           RowBox[{"integrals", ".", "\[IndentingNewLine]", "If"}], " ", 
           "one", " ", "element", " ", "is", " ", "False"}], ",", " ", 
          RowBox[{
          "then", " ", "we", " ", "have", " ", "been", " ", "able", " ", "to",
            " ", "spot", " ", "one", " ", "vanishing", " ", "integral"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"test", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"pp", ",", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"#", ",", "pp"}], "]"}]}], "]"}], ",", 
              "LISTVanishingIntegral"}], "]"}], ")"}], "&"}], "/@", 
          "LISTSimpleINT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "completely", " ", "flatten", " ", "the", " ", "array", 
          " ", "of", " ", 
          RowBox[{"test", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"test", " ", "=", " ", 
         RowBox[{"test", "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "If", " ", "at", " ", "least", " ", "one", " ", "element", " ", 
           "is", " ", "False"}], ",", " ", 
          RowBox[{
          "we", " ", "have", " ", "been", " ", "able", " ", "to", " ", "spot",
            " ", "a", " ", "vanishing", " ", 
           RowBox[{"integral", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"test", " ", "=", " ", 
         RowBox[{"And", "@@", "test"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "We", " ", "could", " ", "not", " ", "spot", " ", "any", " ", 
            "vanishing", " ", 
            RowBox[{"integrals", ".", "\[IndentingNewLine]", "Hence"}]}], ",",
            " ", 
           RowBox[{
           "we", " ", "return", " ", "the", " ", "initial", " ", 
            "integral"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"test", ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"INT", "[", 
            RowBox[{"xINT", ",", "varINT"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "We", " ", "could", " ", "spot", " ", "a", " ", "vanishing", " ", 
             
             RowBox[{"integral", ".", "\[IndentingNewLine]", "Hence"}]}], ",",
             " ", 
            RowBox[{"we", " ", "return", " ", "0."}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"!", "test"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "0", "]"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Applying", " ", "the", " ", "rule", " ", "to", " ", "get", " ", "rid", 
      " ", "of", " ", "the", " ", "simple", " ", 
      RowBox[{"integrals", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{"not", " ", "to", " ", "use", " ", 
      RowBox[{"RepeatedRules", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"integranddFdt", "/.", "RuleVanishingIntegral"}], ")"}], "//",
        "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "now", " ", "perform", " ", "an", " ", "integration", " ", 
     "by", " ", "parts", " ", "of", " ", "the", " ", 
     RowBox[{
      RowBox[{"DIRACPP", "[", 
       RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}], "."}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartDIRACPP", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "have", " ", 
          RowBox[{"DIRACPP", "[", 
           RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}]}], 
         "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]P", "[", "Jb", "]"}], ")"}]}], 
          RowBox[{"d", "/", 
           RowBox[{
            RowBox[{"Jb", "[", 
             RowBox[{"DIRACP", "[", 
              RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}], 
             "]"}], ".", "\[IndentingNewLine]", "Hence"}]}]}]}], ",", " ", 
        RowBox[{
        "no", " ", "need", " ", "for", " ", "a", " ", "negative", " ", "sign",
          " ", "in", " ", "the", " ", "integration", " ", "by", " ", 
         RowBox[{"parts", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
        " ", 
        RowBox[{
        "not", " ", "to", " ", "forget", " ", "to", " ", "divide", " ", "the",
          " ", "remaining", " ", "of", " ", "the", " ", "integrand", " ", 
         "by", " ", 
         RowBox[{"1", "/", 
          RowBox[{
           RowBox[{"\[CapitalOmega]P", "[", "Jb", "]"}], "."}]}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{"DIRACPP", "[", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "Jb_", "]"}]}], "]"}]}], ",", 
          "varINT_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DER", "[", 
             RowBox[{
              RowBox[{"xINT", "/", 
               RowBox[{"\[CapitalOmega]P", "[", "Jb", "]"}]}], ",", "Jb"}], 
             "]"}], " ", 
            RowBox[{"DIRACP", "[", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}], "]"}]}], ",", 
           "varINT"}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"varINT", ",", "Jb"}], "]"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Same", " ", "rule"}], ",", " ", 
         RowBox[{
          RowBox[{"but", " ", "this", " ", "time", " ", "integrating", " ", 
           RowBox[{
           "w", ".", "r", ".", "t", ".", " ", "Ja", ".", 
            "\[IndentingNewLine]", "We"}], " ", "have", " ", 
           RowBox[{"DIRACPP", "[", 
            RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}]}], 
          "=", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]P", "[", "Ja", "]"}], ")"}]}], 
           RowBox[{"d", "/", 
            RowBox[{"Ja", "[", 
             RowBox[{"DIRACP", "[", 
              RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], "]"}], 
             "]"}]}], "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
         RowBox[{
         "we", " ", "need", " ", "a", " ", "negative", " ", "sign", " ", 
          "when", " ", "performing", " ", "the", " ", "integration", " ", 
          "by", " ", 
          RowBox[{"parts", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
         " ", 
         RowBox[{
         "to", " ", "the", " ", "additional", " ", "test", " ", "to", " ", 
          "avoid", " ", "the", " ", "creation", " ", "of", " ", 
          RowBox[{
           RowBox[{"\[CapitalOmega]P", "[", "Ja", "]"}], "."}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{"DIRACPP", "[", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "Jb_", "]"}]}], "]"}]}], ",", 
          "varINT_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"INT", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"DER", "[", 
              RowBox[{
               RowBox[{"xINT", "/", 
                RowBox[{"\[CapitalOmega]P", "[", "Ja", "]"}]}], ",", "Ja"}], 
              "]"}], " ", 
             RowBox[{"DIRACP", "[", 
              RowBox[{
               RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
               RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}], "]"}]}], ",", 
            "varINT"}], "]"}]}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"varINT", ",", "Ja"}], "]"}], "&&", 
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"xINT", ",", 
              RowBox[{"\[CapitalOmega]P", "[", "Ja", "]"}]}], "]"}]}]}], 
          ")"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", "integration", " ", "by", " ", 
     RowBox[{"parts", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RulePartDIRACPP"}], "]"}], "//", 
       "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ATTENTION", ",", " ", 
     RowBox[{
     "we", " ", "also", " ", "make", " ", "sure", " ", "that", " ", "there", 
      " ", "remains", " ", "no", " ", "DER", " ", 
      RowBox[{"operators", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}],
      ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rule", " ", "for", " ", "the", " ", "integration", " ", "by", " ", 
     "part", " ", "of", " ", "the", " ", 
     RowBox[{"PRPAPP", ".", "\[IndentingNewLine]", "We"}], " ", 
     "systematically", " ", "use", " ", "the", " ", "second", " ", 
     "coordinate", " ", "as", " ", "the", " ", "one", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "which"}], " ", "we", " ", 
     "perform", " ", "the", " ", "integration", " ", "by", " ", 
     RowBox[{"parts", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartPRPAPP", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "have", " ", 
          RowBox[{"PRPAPP", "[", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], ")"}]}], 
           "]"}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", 
           RowBox[{"(", 
            RowBox[{"\[CapitalOmega]P", "[", "Jb", "]"}], ")"}]}], 
          RowBox[{"d", "/", 
           RowBox[{
            RowBox[{"dJb", "[", 
             RowBox[{"PRPAP", "[", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"\[CapitalOmega]a", "-", "\[CapitalOmega]b"}], 
                ")"}]}], "]"}], "]"}], ".", "\[IndentingNewLine]", 
            "Hence"}]}]}]}], ",", " ", 
        RowBox[{
        "no", " ", "need", " ", "to", " ", "a", " ", "negative", " ", "sign", 
         " ", "in", " ", "the", " ", "integration", " ", "by", " ", 
         RowBox[{"parts", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
        " ", 
        RowBox[{
        "not", " ", "to", " ", "forget", " ", "to", " ", "divide", " ", "the",
          " ", "remaining", " ", "of", " ", "the", " ", "integrand", " ", 
         "by", " ", 
         RowBox[{
          RowBox[{"\[CapitalOmega]P", "[", "Jb", "]"}], "."}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{"xINT_", " ", 
          RowBox[{"PRPAPP", "[", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "Jb_", "]"}]}], ")"}]}], 
           "]"}]}], ",", "varINT_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DER", "[", 
            RowBox[{
             RowBox[{"xINT", "/", 
              RowBox[{"\[CapitalOmega]P", "[", "Jb", "]"}]}], ",", "Jb"}], 
            "]"}], " ", 
           RowBox[{"PRPAP", "[", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
               RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}], ")"}]}], 
            "]"}]}], ",", "varINT"}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"varINT", ",", "Jb"}], "]"}], ")"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", "integration", " ", "by", " ", 
     RowBox[{"parts", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RulePartPRPAPP"}], "]"}], "//", 
       "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Making", " ", "sure", " ", "that", " ", "no", " ", "DER", " ", 
     "operators", " ", 
     RowBox[{"remain", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}],
      ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "rule", " ", "that", " ", "performs", " ", "an", " ", 
      "integration", " ", "by", " ", "parts", " ", "of", " ", "the", " ", 
      RowBox[{"DIRACP", ".", "\[IndentingNewLine]", "The"}], " ", 
      "argument"}], ",", " ", "listUnAllowed", ",", " ", 
     RowBox[{
     "lists", " ", "the", " ", "functions", " ", "which", " ", "should", " ", 
      "not", " ", "appear", " ", "in", " ", "the", " ", "integrand", 
      "\[IndentingNewLine]", "that", " ", "get", " ", 
      RowBox[{"differentiated", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RulePartDIRACP", "[", "listUnAllowed_", "]"}], ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Performing", " ", "an", " ", "integration", " ", "by", " ", "parts", 
        " ", "of", " ", "terms", " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{"xINT", " ", 
            RowBox[{"DIRACP", "[", "xDIRACP", "]"}]}], ",", "varINT"}], "]"}],
          "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{"xINT_", " ", 
          RowBox[{"DIRACP", "[", "xDIRACP_", "]"}]}], ",", "varINT_"}], "]"}],
        "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"PartDIRACPout", "[", 
         RowBox[{
         "xINT", ",", "xDIRACP", ",", "varINT", ",", "listUnAllowed"}], "]"}],
         "/;", 
        RowBox[{"(", 
         RowBox[{"PartDIRACPQ", "[", 
          RowBox[{
          "xINT", ",", "xDIRACP", ",", "varINT", ",", "listUnAllowed"}], 
          "]"}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "returns", " ", "True", " ", "if", " ", 
     "one", " ", "can", " ", "perform", " ", "an", " ", "integration", " ", 
     "by", " ", "parts", "\[IndentingNewLine]", "of", " ", 
     RowBox[{"INT", "[", 
      RowBox[{
       RowBox[{"xINT", " ", 
        RowBox[{"DIRACP", "[", "xDIRACP", "]"}]}], ",", "varINT"}], "]"}], 
     " ", "without", " ", "having", " ", "to", " ", "differentiate", " ", 
     "elements", " ", "from", " ", 
     RowBox[{"listUnAllowed", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PartDIRACPQ", "[", 
      RowBox[{
      "xINT_", ",", "xDIRACP_", ",", "varINT_", ",", "listUnAllowed_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"termsJ1", ",", "termsJ2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "For", " ", "every", " ", "integration", " ", "variable", " ", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], ",", " ", 
         RowBox[{
         "we", " ", "determine", " ", "the", " ", "list", " ", "of", " ", 
          "terms", " ", "that", " ", "depend", " ", "on", " ", "the", " ", 
          RowBox[{"variable", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"For", " ", "safety"}], ",", " ", 
         RowBox[{
         "we", " ", "make", " ", "sure", " ", "that", " ", "the", " ", "Head",
           " ", "of", " ", "xINT", " ", "is", " ", "Times"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "that"}], " ", "it", " ", "is", 
          " ", "a", " ", "product", " ", "of", " ", 
          RowBox[{"terms", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "We", " ", "have", " ", "a", " ", "product", " ", "of", " ", 
            "terms", " ", "at", " ", "our", " ", "disposal"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
           "where", " ", "only", " ", "a", " ", "subset", " ", "of", " ", 
            "them", " ", "depend", " ", "on", " ", "the", " ", "integration", 
            " ", 
            RowBox[{"variables", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
           ",", " ", 
           RowBox[{
           "the", " ", "second", " ", "argument", " ", "of", " ", 
            "GetPrefactorIntegrand", " ", "must", " ", "be", " ", "a", " ", 
            RowBox[{"list", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
           " ", 
           RowBox[{
           "we", " ", "only", " ", "keep", " ", "the", " ", "integrand", " ", 
            "from", " ", "the", " ", "output", " ", "of", " ", "the", " ", 
            "function"}], ",", " ", 
           RowBox[{
            RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "second", " ", 
            RowBox[{"element", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"Head", "@", "xINT"}], ",", "Times"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"termsJ1", " ", "=", " ", 
            RowBox[{
             RowBox[{"GetPrefactorIntegrand", "[", 
              RowBox[{"xINT", ",", 
               RowBox[{"{", "J1", "}"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"termsJ2", " ", "=", " ", 
            RowBox[{
             RowBox[{"GetPrefactorIntegrand", "[", 
              RowBox[{"xINT", ",", 
               RowBox[{"{", "J2", "}"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Otherwise", ",", " ", 
            RowBox[{
            "we", " ", "have", " ", "a", " ", "single", " ", "term", " ", 
             "at", " ", "our", " ", 
             RowBox[{"disposal", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"termsJ1", " ", "=", " ", "xINT"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"termsJ2", " ", "=", " ", "xINT"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "now", " ", "determine", " ", "whether", " ", "J1", " ", 
           "or", " ", "J2", " ", "can", " ", "be", " ", "used", " ", "as", 
           " ", "our", " ", "integration", " ", 
           RowBox[{"variables", ".", "\[IndentingNewLine]", "We"}], " ", 
           "must", " ", "make", " ", "sure", " ", "that", " ", "Ji", " ", 
           "appears", " ", "in", " ", "the", " ", "integration", " ", 
           "variables"}], ",", "\[IndentingNewLine]", 
          RowBox[{
          "that", " ", "the", " ", "argument", " ", "of", " ", "the", " ", 
           "DIRACP", " ", "contains", " ", "Ji"}], ",", "\[IndentingNewLine]", 
          RowBox[{
          "and", " ", "the", " ", "associated", " ", "integrand", " ", "does",
            " ", "not", " ", "contain", " ", "any", " ", "unallowed", " ", 
           RowBox[{"functions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"For", " ", 
           RowBox[{"J1", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"varINT", ",", "J1"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"xDIRACP", ",", "J1"}], "]"}]}], ")"}], "&&", 
           RowBox[{"CheckUnAllowedQ", "[", 
            RowBox[{"termsJ1", ",", "listUnAllowed"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "True", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"For", " ", 
            RowBox[{"J2", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"varINT", ",", "J2"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"xDIRACP", ",", "J2"}], "]"}]}], ")"}], "&&", 
           RowBox[{"CheckUnAllowedQ", "[", 
            RowBox[{"termsJ2", ",", "listUnAllowed"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "True", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Otherwise", ",", " ", 
            RowBox[{"we", " ", "cannot", " ", "apply", " ", "the", " ", 
             RowBox[{"rule", "."}]}]}], "*)"}], "\[IndentingNewLine]", "True",
           ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "False", "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "that", " ", "performs", " ", "an", " ", "integration", 
     " ", "by", " ", "parts", " ", "of", " ", 
     RowBox[{
      RowBox[{"INT", "[", 
       RowBox[{
        RowBox[{"xINT", " ", 
         RowBox[{"DIRACP", "[", "xDIRACP", "]"}]}], ",", "varINT"}], "]"}], 
      "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PartDIRACPout", "[", 
      RowBox[{
      "xINT_", ",", "xDIRACP_", ",", "varINT_", ",", "listUnAllowed_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"termsJ1", ",", "termsJ2", ",", "res"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"For", " ", "every", " ", "integration", " ", "variable"}], 
         ",", " ", 
         RowBox[{
         "we", " ", "determine", " ", "the", " ", "list", " ", "of", " ", 
          "terms", " ", "that", " ", "depend", " ", "on", " ", "the", " ", 
          RowBox[{"variable", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"For", " ", "safety"}], ",", " ", 
         RowBox[{
         "we", " ", "make", " ", "sure", " ", "that", " ", "the", " ", "Head",
           " ", "of", " ", "xINT", " ", "is", " ", "Times"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "that"}], " ", "it", " ", "is", 
          " ", "a", " ", "product", " ", "of", " ", 
          RowBox[{"terms", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "We", " ", "have", " ", "a", " ", "product", " ", "of", " ", 
            "terms", " ", "at", " ", "our", " ", "disposal"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
           "where", " ", "only", " ", "a", " ", "subset", " ", "of", " ", 
            "them", " ", "depend", " ", "on", " ", "the", " ", "integration", 
            " ", 
            RowBox[{"variables", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
           ",", " ", 
           RowBox[{
           "the", " ", "second", " ", "argument", " ", "of", " ", 
            "GetPrefactorIntegrand", " ", "must", " ", "be", " ", "a", " ", 
            RowBox[{"list", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
           " ", 
           RowBox[{
           "we", " ", "only", " ", "keep", " ", "the", " ", "prefactor", " ", 
            "from", " ", "the", " ", "output", " ", "of", " ", "the", " ", 
            RowBox[{"function", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{
            RowBox[{"Head", "@", "xINT"}], ",", "Times"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"termsJ1", " ", "=", " ", 
            RowBox[{
             RowBox[{"GetPrefactorIntegrand", "[", 
              RowBox[{"xINT", ",", 
               RowBox[{"{", "J1", "}"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"termsJ2", " ", "=", " ", 
            RowBox[{
             RowBox[{"GetPrefactorIntegrand", "[", 
              RowBox[{"xINT", ",", 
               RowBox[{"{", "J2", "}"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Otherwise", ",", " ", 
            RowBox[{
            "we", " ", "have", " ", "a", " ", "single", " ", "term", " ", 
             "at", " ", "our", " ", 
             RowBox[{"disposal", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"termsJ1", " ", "=", " ", "xINT"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"termsJ2", " ", "=", " ", "xINT"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "now", " ", "determine", " ", "whether", " ", "J1", " ", 
           "or", " ", "J2", " ", "can", " ", "be", " ", "used", " ", "as", 
           " ", "our", " ", "integration", " ", 
           RowBox[{"variables", ".", "\[IndentingNewLine]", "We"}], " ", 
           "must", " ", "make", " ", "sure", " ", "that", " ", "Ji", " ", 
           "appears", " ", "in", " ", "the", " ", "integration", " ", 
           "variables"}], ",", "\[IndentingNewLine]", 
          RowBox[{
          "that", " ", "the", " ", "argument", " ", "of", " ", "the", " ", 
           "DIRACP", " ", "contains", " ", "Ji"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "and", " ", "the", " ", "associated", " ", "integrand", " ", 
            "does", " ", "not", " ", "contain", " ", "any", " ", "unallowed", 
            " ", 
            RowBox[{"functions", ".", "\[IndentingNewLine]", "We"}], " ", 
            "generically", " ", "have", " ", 
            RowBox[{"DIRACP", "[", 
             RowBox[{"f", "[", "Ja", "]"}], "]"}]}], "=", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"DER", "[", 
               RowBox[{
                RowBox[{"f", "[", "Ja", "]"}], ",", "Ja"}], "]"}], ")"}]}], 
            " ", 
            RowBox[{"d", "/", 
             RowBox[{
              RowBox[{"dJa", "[", 
               RowBox[{"DIRAC", "[", 
                RowBox[{"f", "[", "Ja", "]"}], "]"}], "]"}], ".", 
              "\[IndentingNewLine]", "ATTENTION"}]}]}]}], ",", " ", 
          RowBox[{
          "not", " ", "to", " ", "forget", " ", "the", " ", "minus", " ", 
           "sign", " ", "in", " ", "the", " ", "integration", " ", "by", " ", 
           
           RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Determining", " ", "if", " ", "J1", " ", "can", " ", "be", " ", 
           "used", " ", "as", " ", "an", " ", "integration", " ", 
           RowBox[{"variable", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"varINT", ",", "J1"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"xDIRACP", ",", "J1"}], "]"}]}], ")"}], "&&", 
           RowBox[{"CheckUnAllowedQ", "[", 
            RowBox[{"termsJ1", ",", "listUnAllowed"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Performing", " ", "an", " ", "integration", " ", "by", " ", 
             "parts", " ", 
             RowBox[{
             "w", ".", "r", ".", "t", ".", " ", "J1", ".", 
              "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
            RowBox[{
            "not", " ", "to", " ", "forget", " ", "the", " ", "minus", " ", 
             RowBox[{"sign", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"-", " ", 
             RowBox[{"INT", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"DIRAC", "[", "xDIRACP", "]"}], " ", 
                RowBox[{"DER", "[", 
                 RowBox[{
                  RowBox[{"xINT", "/", 
                   RowBox[{"(", 
                    RowBox[{"DER", "[", 
                    RowBox[{"xDIRACP", ",", "J1"}], "]"}], ")"}]}], ",", 
                  "J1"}], "]"}]}], ",", "varINT"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Computing", " ", "all", " ", "the", " ", "DER", " ", "that", " ",
              "have", " ", 
             RowBox[{"appeared", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"res", " ", "=", " ", 
            RowBox[{
             RowBox[{"RepeatedRules", "[", 
              RowBox[{"res", ",", "RulesDER"}], "]"}], "//", "Expand"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "res", "]"}]}], ",", "\[IndentingNewLine]", 
          
          RowBox[{"(*", 
           RowBox[{
           "Determining", " ", "if", " ", "J2", " ", "can", " ", "be", " ", 
            "used", " ", "as", " ", "an", " ", "integration", " ", 
            RowBox[{"variable", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"varINT", ",", "J2"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"xDIRACP", ",", "J2"}], "]"}]}], ")"}], "&&", 
           RowBox[{"CheckUnAllowedQ", "[", 
            RowBox[{"termsJ2", ",", "listUnAllowed"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Performing", " ", "an", " ", "integration", " ", "by", " ", 
             "parts", " ", 
             RowBox[{
             "w", ".", "r", ".", "t", ".", " ", "J2", ".", 
              "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
            RowBox[{
            "not", " ", "to", " ", "forget", " ", "the", " ", "minus", " ", 
             RowBox[{"sign", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{"-", " ", 
             RowBox[{"INT", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"DIRAC", "[", "xDIRACP", "]"}], " ", 
                RowBox[{"DER", "[", 
                 RowBox[{
                  RowBox[{"xINT", "/", 
                   RowBox[{"(", 
                    RowBox[{"DER", "[", 
                    RowBox[{"xDIRACP", ",", "J2"}], "]"}], ")"}]}], ",", 
                  "J2"}], "]"}]}], ",", "varINT"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Computing", " ", "all", " ", "the", " ", "DER", " ", "that", " ",
              "have", " ", 
             RowBox[{"appeared", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"res", " ", "=", " ", 
            RowBox[{
             RowBox[{"RepeatedRules", "[", 
              RowBox[{"res", ",", "RulesDER"}], "]"}], "//", "Expand"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "If", " ", "we", " ", "are", " ", "out", " ", "of", " ", "this", 
           " ", "loop"}], ",", " ", 
          RowBox[{
          "it", " ", "means", " ", "that", " ", "we", " ", "have", " ", 
           "encountered", " ", "a", " ", 
           RowBox[{"bug", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<BUG | PartDIRACPout\>\"", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generic", " ", "function", " ", "that", " ", "returns", " ", "True", " ",
      "if", " ", "exp", " ", "contains", " ", "none", " ", "of", " ", "the", 
     " ", "functions", " ", "present", " ", "in", " ", 
     RowBox[{"listUnAllowed", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CheckUnAllowedQ", "[", 
      RowBox[{"exp_", ",", "listUnAllowed_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "occurr", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "For", " ", "every", " ", "term", " ", "in", " ", "the", " ", 
          "UnAllowed", " ", "list"}], ",", " ", 
         RowBox[{
         "we", " ", "return", " ", "True", " ", "if", " ", "it", " ", "does", 
          " ", "not", " ", "appear", " ", "in", " ", "the", " ", 
          RowBox[{"expression", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"occurr", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{"exp", ",", "#"}], "]"}], "&"}], "/@", 
          "listUnAllowed"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Checking", " ", "that", " ", "this", " ", "list", " ", "only", " ", 
          "contains", " ", 
          RowBox[{"True", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"And", "@@", "occurr"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Performing", " ", "an", " ", "integration", " ", "by", " ", "parts", " ",
      "of", " ", "the", " ", "DIRACP", " ", 
     RowBox[{"present", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", 
         RowBox[{"RulePartDIRACP", "[", 
          RowBox[{"{", 
           RowBox[{
           "FPPP", ",", "DIRACPP", ",", "PRPAPP", ",", "UPotkP1P1", ",", 
            "UPotkP1P2", ",", "UPotkP2P2"}], "}"}], "]"}]}], "]"}], "//", 
       "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Applying", " ", "the", " ", "rule", " ", "to", " ", "use", " ", "the", 
      " ", "resonance", " ", 
      RowBox[{"condition", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "we", " ", "also", " ", "use", " ", "the", " ", "rescaling", " ", 
      "function", " ", "along", " ", "with", " ", "the", " ", "rule", " ", 
      "for", " ", "the", " ", "absolute", " ", 
      RowBox[{"values", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", 
         RowBox[{
         "RulesDIRACSub", "~", "Join", "~", "RulesScaling", "~", "Join", "~", 
          "RuleAbs"}]}], "]"}], "//", "Expand"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Applying", " ", "the", " ", "rule", " ", "to", " ", "get", " ", "rid", 
      " ", "of", " ", "the", " ", "simple", " ", 
      RowBox[{"integrals", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{"not", " ", "to", " ", "use", " ", 
      RowBox[{"RepeatedRules", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"integranddFdt", "/.", "RuleVanishingIntegral"}], ")"}], "//",
        "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"We", " ", "perform", " ", "integrals", " ", "involving", " ", 
       RowBox[{
        RowBox[{"DIRAC", "[", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
          RowBox[{"\[CapitalOmega]", "[", "Ji", "]"}]}], "]"}], ".", 
        "\[IndentingNewLine]", "We"}], " ", "give", " ", "a", " ", "name", 
       " ", "to", " ", "the", " ", "following", " ", "integrals", 
       "\[IndentingNewLine]", 
       RowBox[{"IDIRAC", "[", "J", "]"}]}], " ", "=", " ", 
      RowBox[{"INT", "[", 
       RowBox[{
        RowBox[{"DIRAC", "[", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
          RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}]}], "]"}], ",", 
        RowBox[{"{", "Ja", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IDIRACSQ", "[", "J", "]"}], " ", "=", " ", 
      RowBox[{"INT", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
           RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}]}], "]"}], "^", "2"}], 
        ",", 
        RowBox[{"{", "Ja", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IDIRACPRPAP", "[", "J", "]"}], " ", "=", " ", 
      RowBox[{"INT", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
           RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}]}], "]"}], 
         RowBox[{"PRPAP", "[", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}]}], ")"}]}], "]"}]}], 
        ",", 
        RowBox[{"{", "Ja", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesComputeDIRAC", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Computing", " ", "the", " ", "DIRAC", " ", "integrals", " ", "that", 
         " ", "do", " ", "not", " ", "involve", " ", "any", " ", "diverging", 
         " ", 
         RowBox[{"terms", ".", "\[IndentingNewLine]", "Here"}]}], ",", " ", 
        RowBox[{
        "we", " ", "use", " ", "a", " ", "very", " ", "strict", " ", "rule"}],
         ",", " ", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "we"}], " ", "check", " ", "that", 
         " ", "the", " ", "integrand", " ", "does", " ", "not", " ", 
         "involve", " ", "Ja"}], ",", " ", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "all"}], " ", "the", " ", 
         "occurences", " ", "of", " ", "Ja", " ", "have", " ", "already", " ",
          "been", " ", "replaced", " ", "previously", " ", "using", " ", 
         "the", " ", "presence", " ", "of", " ", "the", " ", 
         RowBox[{"DIRAC", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{"xINT_", " ", 
            RowBox[{"DIRAC", "[", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "Jb_", "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IDIRAC", "[", "Ja", "]"}], 
            RowBox[{"(", 
             RowBox[{"xINT", "/.", 
              RowBox[{"{", 
               RowBox[{"Jb", "\[RuleDelayed]", "Ja"}], "}"}]}], ")"}]}], ",", 
           
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}], ",", 
             RowBox[{
              RowBox[{"UnsameQ", "[", 
               RowBox[{"#", ",", "Jb"}], "]"}], "&"}]}], "]"}]}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}], ",", "Jb"}], "]"}], "&&", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"xINT", ",", "Jb"}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Computing", " ", "the", " ", 
          RowBox[{"DIRAC", "^", "2"}], " ", "integrals", " ", "that", " ", 
          "do", " ", "not", " ", "involve", " ", "any", " ", "diverging", " ", 
          RowBox[{"terms", ".", "\[IndentingNewLine]", "Here"}]}], ",", " ", 
         RowBox[{
         "we", " ", "use", " ", "a", " ", "very", " ", "strict", " ", 
          "rule"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "we"}], " ", "check", " ", "that", 
          " ", "the", " ", "integrand", " ", "does", " ", "not", " ", 
          "involve", " ", "Ja"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "all"}], " ", "the", " ", 
          "occurences", " ", "of", " ", "Ja", " ", "have", " ", "already", 
          " ", "been", " ", "replaced", " ", "previously", " ", "using", " ", 
          "the", " ", "presence", " ", "of", " ", "the", " ", 
          RowBox[{"DIRAC", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{"xINT_", " ", 
            RowBox[{
             RowBox[{"DIRAC", "[", 
              RowBox[{
               RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "-", 
               RowBox[{"\[CapitalOmega]", "[", "Jb_", "]"}]}], "]"}], "^", 
             RowBox[{"(", "2", ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IDIRACSQ", "[", "Ja", "]"}], 
            RowBox[{"(", 
             RowBox[{"xINT", "/.", 
              RowBox[{"{", 
               RowBox[{"Jb", "\[RuleDelayed]", "Ja"}], "}"}]}], ")"}]}], ",", 
           
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}], ",", 
             RowBox[{
              RowBox[{"UnsameQ", "[", 
               RowBox[{"#", ",", "Jb"}], "]"}], "&"}]}], "]"}]}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}], ",", "Jb"}], "]"}], "&&", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"xINT", ",", "Jb"}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Computing", " ", "the", " ", "DIRAC", "\[Times]", "PRPAP", " ", 
          "integrals", " ", "that", " ", "do", " ", "not", " ", "involve", 
          " ", "any", " ", "diverging", " ", 
          RowBox[{"terms", ".", "\[IndentingNewLine]", "Here"}]}], ",", " ", 
         RowBox[{
         "we", " ", "use", " ", "a", " ", "very", " ", "strict", " ", 
          "rule"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "we"}], " ", "check", " ", "that", 
          " ", "the", " ", "integrand", " ", "does", " ", "not", " ", 
          "involve", " ", "Ja"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "all"}], " ", "the", " ", 
          "occurences", " ", "of", " ", "Ja", " ", "have", " ", "already", 
          " ", "been", " ", "replaced", " ", "previously", " ", "using", " ", 
          "the", " ", "presence", " ", "of", " ", "the", " ", 
          RowBox[{"DIRAC", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{"xINT_", " ", 
            RowBox[{"DIRAC", "[", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "Jb_", "]"}]}], "]"}], 
            RowBox[{"PRPAP", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "-", 
                RowBox[{"\[CapitalOmega]", "[", "Jb_", "]"}]}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IDIRACPRPAP", "[", "Ja", "]"}], 
            RowBox[{"(", 
             RowBox[{"xINT", "/.", 
              RowBox[{"{", 
               RowBox[{"Jb", "\[RuleDelayed]", "Ja"}], "}"}]}], ")"}]}], ",", 
           
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}], ",", 
             RowBox[{
              RowBox[{"UnsameQ", "[", 
               RowBox[{"#", ",", "Jb"}], "]"}], "&"}]}], "]"}]}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}], ",", "Jb"}], "]"}], "&&", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"xINT", ",", "Jb"}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "We", " ", "give", " ", "a", " ", "name", " ", "to", " ", "the", " ",
           "integral", " ", 
          RowBox[{"INT", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"DIRAC", "[", 
              RowBox[{
               RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
               RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}]}], "]"}], "^", 
             "2"}], ",", 
            RowBox[{"{", "Ja", "}"}]}], "]"}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{"IDIRACSQ", "[", "J", "]"}], "."}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DIRAC", "[", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "Jb_", "]"}]}], "]"}], "^", 
            RowBox[{"(", "2", ")"}]}], ",", 
           RowBox[{"{", "Jb_", "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"IDIRACSQ", "[", "Ja", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Relabelling", " ", "as", " ", 
          RowBox[{"INT", "[", 
           RowBox[{",", 
            RowBox[{"{", "J1", "}"}]}], "]"}], " ", "the", " ", "integral", 
          " ", "over", " ", "a", " ", "single", " ", 
          RowBox[{"action", ".", "\[IndentingNewLine]", "For"}], " ", 
          "safety"}], ",", " ", 
         RowBox[{
         "we", " ", "still", " ", "check", " ", "that", " ", "xINT", " ", 
          "does", " ", "not", " ", "contain", " ", "J1", " ", "before", " ", 
          "the", " ", 
          RowBox[{"replacement", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"INT", "[", 
          RowBox[{"xINT_", ",", 
           RowBox[{"{", "J2", "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{"ReplaceVariables", "[", 
            RowBox[{"xINT", ",", 
             RowBox[{"{", "J2", "}"}], ",", 
             RowBox[{"{", "J1", "}"}]}], "]"}], ",", 
           RowBox[{"{", "J1", "}"}]}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"xINT", ",", "J1"}], "]"}], ")"}]}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Applying", " ", "the", " ", "rule", " ", "to", " ", "compute", " ", 
     "the", " ", "DIRAC", " ", 
     RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RulesComputeDIRAC"}], "]"}], "//", 
       "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rule", " ", "to", " ", "perform", " ", "an", " ", "integration", " ", 
     "by", " ", "parts", " ", "of", " ", "integrals", " ", "of", " ", "the", 
     " ", "form", " ", 
     RowBox[{
      RowBox[{"INT", "[", 
       RowBox[{
        RowBox[{"xINT", " ", 
         RowBox[{
          RowBox[{"DIRACP", "[", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}]}], "]"}], "^", 
          RowBox[{"(", "2", ")"}]}]}], ",", "..."}], "]"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartDIRACPSQ", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "have", " ", 
          RowBox[{
           RowBox[{"DIRACP", "[", 
            RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]a"}], "]"}], "^", 
           "2"}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"DIRACP", "[", 
            RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]a"}], "]"}]}], 
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"\[CapitalOmega]P", "[", "Ja", "]"}]}], ")"}], 
          RowBox[{"d", "/", 
           RowBox[{
            RowBox[{"dJa", "[", 
             RowBox[{"DIRAC", "[", 
              RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]a"}], "]"}], 
             "]"}], ".", "\[IndentingNewLine]", "Hence"}]}]}]}], ",", " ", 
        RowBox[{
        "no", " ", "need", " ", "for", " ", "a", " ", "negative", " ", "sign",
          " ", "in", " ", "the", " ", "integration", " ", "by", " ", 
         RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{"xINT_", " ", 
          RowBox[{
           RowBox[{"DIRACP", "[", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "J_", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}]}], "]"}], "^", 
           RowBox[{"(", "2", ")"}]}]}], ",", "varINT_"}], "]"}], 
       "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DER", "[", 
            RowBox[{
             RowBox[{"xINT", " ", 
              RowBox[{
               RowBox[{"DIRACP", "[", 
                RowBox[{
                 RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                 RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}]}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"\[CapitalOmega]P", "[", "Ja", "]"}], ")"}]}]}], ",", 
             "Ja"}], "]"}], " ", 
           RowBox[{"DIRAC", "[", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}]}], "]"}]}], ",", 
          "varINT"}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"varINT", ",", "Ja"}], "]"}], ")"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Applying", " ", "the", " ", "rule", " ", "and", " ", "computing", " ", 
     "all", " ", "the", " ", 
     RowBox[{"derivatives", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", 
         RowBox[{"RulePartDIRACPSQ", "~", "Join", "~", "RulesDER"}]}], "]"}], 
       "//", "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Using", " ", "the", " ", "newly", " ", "created", " ", "DIRAC", " ", 
     "to", " ", "make", " ", 
     RowBox[{"simplifications", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", 
         RowBox[{
         "RulesDIRACSub", "~", "Join", "~", "RulesScaling", "~", "Join", "~", 
          "RuleAbs"}]}], "]"}], "//", "Expand"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Possibly", " ", "computing", " ", "simple", " ", "integrals", " ", 
     "that", " ", "have", " ", 
     RowBox[{"appeared", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RulesComputeDIRAC"}], "]"}], "//", 
       "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Removing", " ", "vanishing", " ", 
      RowBox[{"integrals", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{"not", " ", "to", " ", "use", " ", 
      RowBox[{"RepeatedRules", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"integranddFdt", "/.", "RuleVanishingIntegral"}], ")"}], "//",
        "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "We", " ", "remove", " ", "all", " ", "the", " ", "terms", " ", "that", 
       " ", "are", " ", "equal", " ", "to", " ", "0", " ", "under", " ", 
       "the", " ", "symmetrisation", " ", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2"}], "}"}]}], "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "k1"}], ",", "k2"}], "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{"k1", ",", 
        RowBox[{"-", "k2"}]}], "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{"or", " ", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2"}], "}"}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "k1"}], ",", 
         RowBox[{"-", "k2"}]}], "}"}], ".", "\[IndentingNewLine]", 
       "ATTENTION"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "not", " ", "to", " ", "forget", " ", "the", " ", "Simplify", " ", "in",
        " ", "the", " ", "equality", " ", 
       RowBox[{"test", " ", "--"}], " ", "this", " ", "is", " ", "needed", 
       " ", "for", " ", "MMA", " ", "to", " ", "write", " ", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"-", "k1"}], "+", "k2"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"k1", "-", "k2"}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleSymk1k2", " ", "=", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"(", 
         RowBox[{"SUM", "[", 
          RowBox[{"xSUM_", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], ")"}]}], 
       "\[RuleDelayed]", 
       RowBox[{"0", "/;", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Symmetry", " ", 
            RowBox[{"{", 
             RowBox[{"k1", ",", "k2"}], "}"}]}], "\[Rule]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "k1"}], ",", "k2"}], "}"}], "."}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ReplaceVariables", "[", 
                RowBox[{"xSUM", ",", 
                 RowBox[{"{", 
                  RowBox[{"k1", ",", "k2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "k1"}], ",", "k2"}], "}"}]}], "]"}], "+", 
               "xSUM"}], ")"}], "//", "Simplify"}]}], "]"}], 
          "\[IndentingNewLine]", "||", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Symmetry", " ", 
             RowBox[{"{", 
              RowBox[{"k1", ",", "k2"}], "}"}]}], "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"k1", ",", 
               RowBox[{"-", "k2"}]}], "}"}], "."}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"SameQ", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ReplaceVariables", "[", 
                RowBox[{"xSUM", ",", 
                 RowBox[{"{", 
                  RowBox[{"k1", ",", "k2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k1", ",", 
                   RowBox[{"-", "k2"}]}], "}"}]}], "]"}], "+", "xSUM"}], 
              ")"}], "//", "Simplify"}]}], "]"}], "\[IndentingNewLine]", "||",
           "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Symmetry", " ", 
             RowBox[{"{", 
              RowBox[{"k1", ",", "k2"}], "}"}]}], "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "k1"}], ",", 
               RowBox[{"-", "k2"}]}], "}"}], "."}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"SameQ", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ReplaceVariables", "[", 
                RowBox[{"xSUM", ",", 
                 RowBox[{"{", 
                  RowBox[{"k1", ",", "k2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "k1"}], ",", 
                   RowBox[{"-", "k2"}]}], "}"}]}], "]"}], "+", "xSUM"}], 
              ")"}], "//", "Simplify"}]}], "]"}]}], "\[IndentingNewLine]", 
         ")"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", 
      RowBox[{"rule", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{"not", " ", "to", " ", "apply", " ", "RepeatedRules"}], ",", " ", 
     RowBox[{
     "otherwise", " ", "the", " ", "rule", " ", "is", " ", "very", " ", 
      RowBox[{"slow", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"integranddFdt", "/.", "RuleSymk1k2"}], ")"}], "//", 
       "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "We", " ", "now", " ", "use", " ", "the", " ", "fact", " ", "that", " ",
        "we", " ", "can", " ", "make", " ", "the", " ", "identification", 
       "\[IndentingNewLine]", 
       RowBox[{"PRPA", "[", 
        RowBox[{"1", "/", "x"}], "]"}]}], "=", 
      RowBox[{"1", "/", "x"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PRPAP", "[", 
       RowBox[{"1", "/", "x"}], "]"}], "=", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"x", "^", "2"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PRPAPP", "[", 
       RowBox[{"1", "/", "x"}], "]"}], "=", 
      RowBox[{
       RowBox[{"2", "/", 
        RowBox[{"x", "^", "3"}]}], "\[IndentingNewLine]", "Therefore"}]}], 
     ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "can", " ", "make", " ", "the", " ", "identification", 
       "\[IndentingNewLine]", 
       RowBox[{"PRPA", "[", 
        RowBox[{"1", "/", "x"}], "]"}], 
       RowBox[{"PRPAPP", "[", 
        RowBox[{"1", "/", "x"}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"2", "/", 
        RowBox[{"x", "^", "4"}]}], "=", 
       RowBox[{"2", " ", 
        RowBox[{
         RowBox[{"PRPAP", "[", 
          RowBox[{"1", "/", "x"}], "]"}], "^", "2."}], "\[IndentingNewLine]", 
        "ATTENTION"}]}]}], ",", " ", 
     RowBox[{
     "not", " ", "to", " ", "forget", " ", "the", " ", "factor", " ", 
      "2."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleIdentifyPRPAPRPAPP", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"PRPA", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "Jb_", "]"}]}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}]}], "]"}], " ", 
        RowBox[{"PRPAPP", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "Jb_", "]"}]}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"2", " ", 
        RowBox[{
         RowBox[{"PRPAP", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "Ja", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "Jb", "]"}]}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}]}], "]"}], "^", 
         RowBox[{"(", "2", ")"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RuleIdentifyPRPAPRPAPP"}], "]"}], "//",
        "Expand"}]}], ";"}], "//", "AbsoluteTiming"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{
  3.7999334258972473`*^9, {3.799933919618437*^9, 3.799933919828909*^9}, {
   3.799983030114184*^9, 3.799983242327568*^9}, 3.799983349069899*^9, {
   3.799983440536951*^9, 3.7999834741816387`*^9}, {3.7999838775703783`*^9, 
   3.79998388112204*^9}, 3.799989614855021*^9, 3.7999907464952593`*^9, {
   3.799991837766157*^9, 3.799991838156365*^9}, {3.799998546667645*^9, 
   3.7999985621201277`*^9}, {3.799998623997346*^9, 3.799998627576325*^9}, {
   3.7999987272284*^9, 3.799998728175029*^9}, {3.799998784971298*^9, 
   3.799998798552534*^9}, {3.799998886177251*^9, 3.7999989216539297`*^9}, {
   3.800000099578959*^9, 3.80000009979457*^9}, {3.800001901391706*^9, 
   3.800001901586732*^9}, {3.860671413172793*^9, 3.860671415079358*^9}, {
   3.860732909040215*^9, 3.860732940624032*^9}, {3.86073309209547*^9, 
   3.8607330955263033`*^9}, 3.860733174720299*^9, {3.8607454309138193`*^9, 
   3.860745437433703*^9}, {3.860745467979698*^9, 3.860745545686048*^9}, {
   3.8607455992628517`*^9, 3.860745674991144*^9}, {3.860745726788878*^9, 
   3.860745870516857*^9}, {3.86074597759242*^9, 3.860746101630022*^9}, 
   3.860746151718657*^9, {3.8607461894863577`*^9, 3.860746202835249*^9}, {
   3.8607463242263412`*^9, 3.860746339850181*^9}, {3.860746436430368*^9, 
   3.860746502903326*^9}, {3.860746566804759*^9, 3.860746611604979*^9}, {
   3.860746678843775*^9, 3.8607467297641706`*^9}, {3.860746771595324*^9, 
   3.8607472483565807`*^9}, {3.860747359314616*^9, 3.860747360841277*^9}, {
   3.8607475028716927`*^9, 3.860747551219391*^9}, {3.860748244894886*^9, 
   3.860748607263945*^9}, {3.8607489242545347`*^9, 3.860748930068654*^9}, {
   3.8607490955022383`*^9, 3.860749192588585*^9}, {3.8607492641461887`*^9, 
   3.860749264334402*^9}, {3.8607497261645947`*^9, 3.860749824137314*^9}, {
   3.860749872350466*^9, 3.8607499821224937`*^9}, {3.860751662669351*^9, 
   3.860751907278297*^9}, {3.860751997793127*^9, 3.860752033840148*^9}, {
   3.860752078928564*^9, 3.8607521403427477`*^9}, {3.860752317778885*^9, 
   3.860752352028068*^9}, {3.860752385426425*^9, 3.860752462333984*^9}, {
   3.860752510445146*^9, 3.8607525139053783`*^9}, 3.860752569433927*^9, {
   3.8607526129647408`*^9, 3.860752620831132*^9}, {3.8607527992932653`*^9, 
   3.860752836890088*^9}, {3.860753131829145*^9, 3.860753143377919*^9}, {
   3.86075317834734*^9, 3.860753178716367*^9}, {3.860753219411849*^9, 
   3.860753219571384*^9}, {3.860753552376075*^9, 3.860753576850568*^9}, {
   3.8607536403528223`*^9, 3.860753654104268*^9}, {3.860753747970407*^9, 
   3.860753748229444*^9}, {3.860753828930995*^9, 3.860753829058476*^9}, {
   3.860753927208907*^9, 3.860753954898678*^9}, {3.860754043419425*^9, 
   3.860754138430646*^9}, {3.8607545909755*^9, 3.860754743017556*^9}, {
   3.860754798852704*^9, 3.860754840612995*^9}, {3.8607549607791224`*^9, 
   3.860754960911716*^9}, {3.860831681252692*^9, 3.860831685694178*^9}, {
   3.860838769037352*^9, 3.860838816505939*^9}, {3.8608389852006207`*^9, 
   3.8608389853941193`*^9}, {3.860839138845559*^9, 3.860839178014247*^9}, {
   3.860846125385133*^9, 3.860846125513575*^9}, {3.8610878692832613`*^9, 
   3.861087976085218*^9}, {3.861088090041589*^9, 3.8610880901994133`*^9}, {
   3.8611581636805487`*^9, 3.861158164104282*^9}, {3.861158576702718*^9, 
   3.861158576887437*^9}, {3.861160947424965*^9, 3.8611610178391533`*^9}, {
   3.8611610965222683`*^9, 3.861161118609953*^9}, {3.8611619675516367`*^9, 
   3.861161995044327*^9}, {3.86116238644337*^9, 3.8611624132994127`*^9}, {
   3.861245310289328*^9, 3.861245310419182*^9}, {3.8612466114459057`*^9, 
   3.861246659696471*^9}, {3.8612467203804693`*^9, 3.861246757412092*^9}, {
   3.8612467966839533`*^9, 3.861246868446203*^9}, {3.861246907176997*^9, 
   3.861246912567758*^9}, {3.861247421386861*^9, 3.861247421620329*^9}, {
   3.861248046475336*^9, 3.86124806673111*^9}, {3.861248231208488*^9, 
   3.861248231689193*^9}, {3.861248393985241*^9, 3.861248395793161*^9}, {
   3.861248601654648*^9, 3.8612486438623857`*^9}, {3.8612488324117737`*^9, 
   3.861248893169448*^9}, {3.861248925737842*^9, 3.86124895102635*^9}, {
   3.8612490580009727`*^9, 3.86124906065554*^9}, {3.8612510176876783`*^9, 
   3.861251017831867*^9}, {3.861252429647243*^9, 3.861252429750943*^9}, {
   3.8612691257928867`*^9, 3.8612691260293913`*^9}, {3.861270802479439*^9, 
   3.86127080293078*^9}, {3.861284377848374*^9, 3.8612843800163937`*^9}, 
   3.862755930517662*^9, {3.86282455645953*^9, 3.862824559493536*^9}, {
   3.862887499728551*^9, 3.862887500837346*^9}, {3.866190423481346*^9, 
   3.866190423661291*^9}, {3.8661904688336067`*^9, 3.8661904691497593`*^9}, {
   3.866190499348732*^9, 3.866190501201769*^9}, {3.866190579849985*^9, 
   3.8661905812744102`*^9}, {3.866190629542395*^9, 3.866190649556432*^9}, {
   3.866190683605476*^9, 3.866190684253684*^9}, 3.866190731359385*^9, {
   3.866190788139249*^9, 3.8661908290460453`*^9}, {3.866190904294438*^9, 
   3.866190906071612*^9}, {3.866193952766502*^9, 3.866193953197198*^9}, {
   3.866520847671777*^9, 3.8665208477907*^9}, {3.8665209389666452`*^9, 
   3.8665209870441933`*^9}, {3.8665210469381313`*^9, 3.866521073531502*^9}, {
   3.866521116959825*^9, 3.866521144215397*^9}, {3.866521244294379*^9, 
   3.8665212643735037`*^9}, {3.8665213322966423`*^9, 3.866521387974306*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"18.323916`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpCeMDHb+BKQBgAfrLZH
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.302732`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpDWzi41vQSkARvAtcg=
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.494538`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpC+6NNqeglIAwAgd7Zf
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15.885037`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpA+cqPR/BKQBgAj1bbc
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.142422`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpCeOWGZ+SUgDQAhY7aO
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.344738`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpCes36j+SUgDQAilra7
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.599569`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpCe/VTF4hKQBgAgv7Zk
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.33462`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpCet1Lf4hKQBgAfdbY2
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.194954`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpA+8WarxSUgDQAlvrcp
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"13.92816`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpDWvlNsdQlIAwAe5LY8
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"12.255971`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpDeJfTH+hKQBgAhEbaL
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.002683`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpCW1ZWxuQSkARertSo=
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.537614`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpAOmOBrcwlIAwAdHrXx
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.671947`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpCuVVpscwlIAwAdiLYG
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.852877`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpA+VbjP5hKQBgAiu7a9
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.185664`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpDekHHE5hKQBgAh0Lag
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.750699`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpDmK75jcwlIAwAdnbYh
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"27.80668`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpDeEBHmcAlIAwAe4LYm
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.157216`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOLGaZPL9h154+j0U7cBRB94I8q2H0iHBdnzguhLeQpK
YDolwBxEe4jMDQXRrAcXdoJoqdq7tQeAtNyKWr2DQFpBJOfuESDtcGtm+Ekg
PafTX/cUkDZ/ULUJRC8pquU5DaTjjk1dAaI/e1kdvACk57koOb8G0lOvTf34
H6RvVoY5w9E3jgzfFv4WANKGgX77BYG037am/6JAutGAz10KSPO8kJBVANJt
L6uvHDwGNDf7xz8QPTtlWwfvcaC5Ko3XzIH0pelyZ5KA9JKT0dOnAmmHtUuW
TgPSEptVVr0G0nlKdjtAtIbqZw+xE0B3WYscBNG7ljTeAdEbQneelALS5jNv
ZKqfA/r/EI+EHpB2yY92uASkARw/tdY=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "We", " ", "try", " ", "to", " ", "reduce", " ", "the", " ", "number", 
      " ", "of", " ", "terms", " ", "that", " ", "do", " ", "not", " ", 
      "involve", " ", "the", " ", "three"}], "-", 
     RowBox[{"body", " ", "resonance", " ", 
      RowBox[{"condition", ".", "\[IndentingNewLine]", "These"}], " ", "are", 
      " ", "annoying", " ", "manipulations", " ", "because"}]}], ",", " ", 
    RowBox[{"for", " ", "a", " ", "given", " ", "term"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "not", " ", "obvious", " ", "to", " ", "determine", 
     " ", "which", " ", "symmetrisations", " ", "is", " ", 
     RowBox[{"appropriate", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Generic", " ", "function", " ", "that", " ", "returns", " ", "the", " ", 
     "list", " ", "of", " ", "all", " ", "the", " ", "nasty", " ", 
     "integrals"}], ",", " ", 
    RowBox[{
     RowBox[{"INT", "[", 
      RowBox[{",", 
       RowBox[{"{", "J1", "}"}]}], "]"}], " ", "that", " ", "are", " ", 
     RowBox[{"present", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NastyINTLIST", "[", "expinit_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"expinit", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"HoldPattern", "@", 
                RowBox[{"INT", "[", " ", 
                 RowBox[{"A_", ",", 
                  RowBox[{"{", "J1", "}"}]}], "]"}]}], "\[RuleDelayed]", 
               RowBox[{"Sow", "[", 
                RowBox[{"INT", "[", " ", 
                 RowBox[{"A", ",", 
                  RowBox[{"{", "J1", "}"}]}], "]"}], "]"}]}], "}"}]}], ")"}], 
           "//", "Reap"}], "//", "Last"}], "//", "Last"}], "//", "Counts"}], "//",
        "Normal"}], "//", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "subsequent", " ", "symmetrisations", " ", "are", " ", 
      "more", " ", "difficult", " ", "because", " ", "they", " ", "involve", 
      " ", "nasty", " ", "integrals", " ", "that", " ", "are", " ", "not", 
      " ", "invariant", " ", "under", " ", "arbitrary", " ", "permutations", 
      " ", "of", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2", ",", 
         RowBox[{"k1", "+", "k2"}]}], "}"}], ".", "\[IndentingNewLine]", 
       "So"}]}], ",", " ", 
     RowBox[{
     "the", " ", "first", " ", "step", " ", "is", " ", "to", " ", "reduce", 
      " ", "the", " ", "number", " ", "of", " ", "nasty", " ", "integrals", 
      " ", "that", " ", "are", " ", "present", " ", "by", " ", "already", " ",
       "performing", " ", "relabellings", " ", "of", " ", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], " ", "so", " ", "that", " ", "nasty",
       " ", "integrals", " ", "are", " ", "all", " ", "reduced", " ", "to", 
      " ", "their", " ", "\"\<fundamental\>\"", " ", 
      RowBox[{"types", ".", "\[IndentingNewLine]", "Once"}], " ", "again"}], 
     ",", " ", 
     RowBox[{
     "this", " ", "is", " ", "challenging", " ", "to", " ", "perform", " ", 
      RowBox[{"systematically", ".", "\[IndentingNewLine]", "We"}], " ", 
      "determine", " ", "the", " ", "fundamental", " ", "type", " ", "of", 
      " ", "an", " ", "integral", " ", "in", " ", "particular", " ", "by", 
      " ", "considering", " ", "its", " ", "integrand", " ", "and", " ", 
      "the", " ", "type", " ", "of", " ", "UPotk", " ", "dependence", " ", 
      "that", " ", 
      RowBox[{"appear", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "is", " ", "given", " ", 
      "an", " ", "expression"}], ",", " ", 
     RowBox[{
     "a", " ", "nasty", " ", "integral", " ", "and", " ", "a", " ", 
      "symmetrisation", " ", "rule", " ", "for", " ", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], " ", "and", " ", "applies", " ", 
      "the", " ", "replacement", " ", "suggested", " ", "by", " ", "the", " ", 
      RowBox[{"rule", ".", "\[IndentingNewLine]", "The"}], " ", "goal", " ", 
      "of", " ", "this", " ", "function", " ", "is", " ", "to", " ", 
      "perform", " ", "relabellings", " ", "of", " ", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], " ", "so", " ", "that", " ", "nasty",
       " ", "integrals", " ", "are", " ", "reduced", " ", "to", " ", "their", 
      " ", "\"\<fundamental\>\"", " ", 
      RowBox[{"types", ".", "\[IndentingNewLine]", "Phrased"}], " ", 
      "differently"}], ",", " ", 
     RowBox[{
     "we", " ", "do", " ", "not", " ", "want", " ", "to", " ", "have", " ", 
      "to", " ", "deal", " ", "with", " ", "too", " ", "many", " ", 
      "different", " ", "type", " ", "of", " ", 
      RowBox[{"integrals", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "we", " ", "also", " ", "allow", " ", "for", " ", "optional", " ", 
      "arguments", " ", "in", " ", "the", " ", 
      RowBox[{"sum", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NastyINTSymk1k2", "[", 
      RowBox[{"expinit_", ",", "INTnasty_", ",", "newk1k2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "exp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Applying", " ", "the", " ", 
         RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"expinit", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"HoldPattern", "@", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xSUM_:", "1"}], ")"}], " ", "INTnasty"}], ",", 
               RowBox[{"{", 
                RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
            RowBox[{"SUM", "[", 
             RowBox[{
              RowBox[{"ReplaceVariables", "[", 
               RowBox[{
                RowBox[{"xSUM", " ", "INTnasty"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k1", ",", "k2"}], "}"}], ",", "newk1k2"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "takes", " ", "an", " ", 
      "initial", " ", "expression"}], ",", " ", 
     RowBox[{"a", " ", "symmetrisation", " ", "rule"}], ",", " ", 
     RowBox[{
     "and", " ", "performs", " ", "a", " ", "symmetrisation", " ", "of", " ", 
      "the", " ", "nasty", " ", "integrals", " ", "to", " ", "try", " ", 
      "and", " ", "reduce", " ", "their", " ", 
      RowBox[{"number", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReduceNastyINT", "[", 
      RowBox[{"expinit_", ",", "newk1k2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "exp", ",", "listNASTY", ",", "listNASTYsym", ",", "listNASTYinter", 
         ",", "intinter", ",", "ind", ",", "int"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{"we", " ", "copy", " ", "the", " ", "initial", " ", 
          RowBox[{"expression", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", "expinit"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "determine", " ", "the", " ", "initial", " ", "list", " ",
           "of", " ", "nasty", " ", 
          RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNASTY", " ", "=", " ", 
         RowBox[{"NastyINTLIST", "[", "exp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "limit", " ", "ourselves", " ", "only", " ", "to", " ", 
          "nasty", " ", "integrals", " ", "that", " ", "change", " ", "upon", 
          " ", 
          RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNASTY", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"listNASTY", ",", 
           RowBox[{
            RowBox[{"UnsameQ", "[", 
             RowBox[{"#", ",", 
              RowBox[{"ReplaceVariables", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"k1", ",", "k2"}], "}"}], ",", "newk1k2"}], "]"}]}], 
             "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "consider", " ", "the", " ", "symmetrised", " ", 
          "version", " ", "of", " ", "the", " ", "nasty", " ", 
          RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNASTYsym", " ", "=", " ", 
         RowBox[{"ReplaceVariables", "[", 
          RowBox[{"listNASTY", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}], ",", "newk1k2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Computing", " ", "the", " ", "intersection", " ", "of", " ", "the", 
          " ", "two", " ", 
          RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNASTYinter", " ", "=", " ", 
         RowBox[{"Intersection", "[", 
          RowBox[{"listNASTY", ",", "listNASTYsym"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "As", " ", "long", " ", "as", " ", "there", " ", "is", " ", "some", 
           " ", "overlap", " ", "between", " ", "the", " ", "two", " ", 
           "lists"}], ",", " ", 
          RowBox[{
          "we", " ", "are", " ", "going", " ", "to", " ", "perform", " ", 
           RowBox[{"symmetrisations", "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"UnsameQ", "[", 
           RowBox[{"listNASTYinter", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Nasty", " ", "integral", " ", "that", " ", "can", " ", "be", " ", 
            
            RowBox[{"symmetrised", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"intinter", " ", "=", " ", 
            RowBox[{"listNASTYinter", "//", "First"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "We", " ", "find", " ", "its", " ", "position", " ", "in", " ", 
             "the", " ", "symmetrised", " ", 
             RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ind", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"listNASTYsym", ",", "intinter"}], "]"}], "//", 
              "First"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "The", " ", "integral", " ", "to", " ", "symmetrise", " ", "is", 
              " ", "then", " ", "the", " ", "following", " ", 
              RowBox[{"one", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",",
              " ", 
             RowBox[{
             "it", " ", "is", " ", "important", " ", "to", " ", "proceed", 
              " ", "that", " ", "way", " ", "to", " ", "prevent", " ", 
              "falling", " ", "into", " ", "infinite", " ", "loops", " ", 
              "of", " ", 
              RowBox[{"replacements", "."}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"int", " ", "=", " ", 
            RowBox[{"listNASTY", "[", 
             RowBox[{"[", "ind", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Performing", " ", "the", " ", 
             RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"exp", " ", "=", " ", 
            RowBox[{"NastyINTSymk1k2", "[", 
             RowBox[{"exp", ",", "int", ",", "newk1k2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Determining", " ", "the", " ", "new", " ", "list", " ", "of", 
              " ", "nasty", " ", 
              RowBox[{
              "integrals", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
             " ", 
             RowBox[{
             "we", " ", "limit", " ", "ourselves", " ", "only", " ", "to", 
              " ", "nasty", " ", "integrals", " ", "that", " ", "change", " ",
               "upon", " ", 
              RowBox[{"symmetrisation", "."}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"listNASTY", " ", "=", " ", 
            RowBox[{"NastyINTLIST", "[", "exp", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"listNASTY", " ", "=", " ", 
            RowBox[{"Select", "[", 
             RowBox[{"listNASTY", ",", 
              RowBox[{
               RowBox[{"UnsameQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"ReplaceVariables", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{"k1", ",", "k2"}], "}"}], ",", "newk1k2"}], 
                  "]"}]}], "]"}], "&"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Updating", " ", "the", " ", "list", " ", "of", " ", 
             "symmetrised", " ", "nasty", " ", 
             RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"listNASTYsym", " ", "=", " ", 
            RowBox[{"ReplaceVariables", "[", 
             RowBox[{"listNASTY", ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", "k2"}], "}"}], ",", "newk1k2"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Updating", " ", "the", " ", "intersection", " ", "of", " ", 
             "the", " ", "two", " ", 
             RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"listNASTYinter", " ", "=", " ", 
            RowBox[{"Intersection", "[", 
             RowBox[{"listNASTY", ",", "listNASTYsym"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "takes", " ", "as", " ", 
      "an", " ", "argument", " ", "an", " ", 
      RowBox[{"(", "intricate", ")"}], " ", "integral", " ", 
      RowBox[{"INT", "[", 
       RowBox[{",", 
        RowBox[{"{", "J1", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "isolates", " ", "in", " ", "integranddFdt", " ", "the", " ", "term", 
      " ", "that", " ", "involve", " ", "this", " ", "integral"}], ",", 
     "\[IndentingNewLine]", "performs", ",", " ", 
     RowBox[{"in", " ", "order"}], ",", " ", 
     RowBox[{"the", " ", "symmetrisations", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2"}], "}"}]}], " ", "given", " ", "in", " ", 
      "argument"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "and", " ", "checks", " ", "that", " ", "it", " ", "gives", " ", 
      RowBox[{"zero", ".", "\[IndentingNewLine]", "This"}], " ", "function", 
      " ", "returns", " ", "True", " ", "if"}], ",", " ", 
     RowBox[{"after", " ", "symmetrisation"}], ",", " ", 
     RowBox[{
      RowBox[{
      "these", " ", "integrals", " ", "give", " ", "a", " ", "vanishing", " ", 
       RowBox[{"contribution", ".", "\[IndentingNewLine]", "This"}], " ", 
       "is", " ", "a", " ", "convenient", " ", "function", " ", "to", " ", 
       "prevent", " ", "copy"}], "-", 
      RowBox[{"pastes", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NastyINTQ", "[", 
      RowBox[{"expinit_", ",", "INTnasty_", ",", "RULES_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rule", ",", "LISTexp", ",", "exp"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{
         "we", " ", "transform", " ", "integranddFdt", " ", "into", " ", "a", 
          " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LISTexp", " ", "=", " ", 
         RowBox[{"List", "@@", 
          RowBox[{"(", 
           RowBox[{"expinit", "//", "Expand"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "select", " ", "the", " ", "elements", " ", "that", " ", 
          "involve", " ", "the", " ", 
          RowBox[{"integral", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"LISTexp", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"#", ",", "INTnasty"}], "]"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Putting", " ", "back", " ", "as", " ", "a", " ", "sum", " ", "of", 
          " ", 
          RowBox[{"terms", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"Plus", "@@", "exp"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "we", " ", "perform", " ", "the", " ", "symmetrisation",
            " ", "as", " ", "given", " ", "in", " ", 
           RowBox[{"argument", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
          ",", " ", 
          RowBox[{
          "we", " ", "apply", " ", "all", " ", "the", " ", "rules", " ", "in",
            " ", 
           RowBox[{"order", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exp", " ", "=", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"exp", "/.", "rule"}], ")"}], "//", "Expand"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"rule", ",", "RULES"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "now", " ", "try", " ", "to", " ", "simplify", " ", "the",
           " ", "resulting", " ", 
          RowBox[{"expression", ".", "\[IndentingNewLine]", "We"}], " ", 
          "temporarily", " ", "remove", " ", "the", " ", "SUM", " ", "to", 
          " ", "let", " ", "Mathematica", " ", "simplify"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"exp", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SUM", "[", 
             RowBox[{"xSUM_", ",", "varSUM_"}], "]"}], "\[RuleDelayed]", 
            "xSUM"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Simplifying", " ", "and", " ", "crossing", " ", "our", " ", 
          RowBox[{"fingers", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"exp", "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determining", " ", "if", " ", "the", " ", "result", " ", 
          RowBox[{"vanishes", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"SameQ", "[", 
          RowBox[{"exp", ",", "0"}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "removes", " ", "all", " ",
       "the", " ", "contributions", " ", "from", " ", "a", " ", "NastyINT"}], 
     ",", " ", 
     RowBox[{
     "which", " ", "we", " ", "just", " ", "check", " ", "gives", " ", "a", 
      " ", "vanishing", " ", 
      RowBox[{"contribution", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NastyINTRemove", "[", 
      RowBox[{"expinit_", ",", "INTnasty_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "exp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Replacing", " ", "the", " ", "integrals", " ", "by", " ", "0."}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"expinit", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"INTnasty", "\[RuleDelayed]", "0"}], "\[IndentingNewLine]",
            "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "takes", " ", "an", " ", 
      "expression", " ", "and", " ", "replacement", " ", "rules"}], ",", " ", 
     
     RowBox[{
     "and", " ", "removes", " ", "all", " ", "the", " ", "integrals", " ", 
      "that", " ", 
      RowBox[{"vanish", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NastyINTWrapped", "[", 
      RowBox[{"expinit_", ",", "RULES_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "exp", ",", "listNastyINT", ",", "listNastyINTQ", ",", 
         "listNastyINTind", ",", "listNastyINTvanish"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Copying", " ", "the", " ", "initial", " ", 
         RowBox[{"expressions", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", "expinit"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"List", " ", "of", " ", "all", " ", "the", " ", "nasty", " ", 
          RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNastyINT", " ", "=", " ", 
         RowBox[{"NastyINTLIST", "[", "exp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"For", " ", "every", " ", "integral"}], ",", " ", 
          RowBox[{
          "we", " ", "try", " ", "to", " ", "simplify", " ", "using", " ", 
           "the", " ", "symmetrisation", " ", 
           RowBox[{"rule", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNastyINTQ", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"NastyINTQ", "[", 
            RowBox[{"exp", ",", "#", ",", "RULES"}], "]"}], "&"}], "/@", 
          "listNastyINT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "find", " ", "the", " ", "index", " ", "of", " ", "all", 
          " ", "the", " ", "nasty", " ", "integrals", " ", "that", " ", 
          RowBox[{"vanish", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNastyINTind", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"listNastyINTQ", ",", "True"}], "]"}], "//", 
          RowBox[{
           RowBox[{"First", "/@", "#"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "construct", " ", "the", " ", "list", " ", "of", " ", 
          "the", " ", "nasty", " ", "integrals", " ", "that", " ", 
          RowBox[{"vanish", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNastyINTvanish", " ", "=", " ", 
         RowBox[{"listNastyINT", "[", 
          RowBox[{"[", "listNastyINTind", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", ",", " ", 
          RowBox[{
          "for", " ", "every", " ", "vanishing", " ", "nasty", " ", 
           "integral"}], ",", " ", 
          RowBox[{
          "we", " ", "remove", " ", "it", " ", "from", " ", "the", " ", 
           RowBox[{"expressions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Initial nb. terms | \>\"", ",", 
          RowBox[{"exp", "//", "Length"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exp", " ", "=", " ", 
           RowBox[{"NastyINTRemove", "[", 
            RowBox[{"exp", ",", "INTNasty"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"INTNasty", ",", "listNastyINTvanish"}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Final nb. terms | \>\"", ",", 
          RowBox[{"exp", "//", "Length"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", ",", " ", 
     RowBox[{
     "we", " ", "reduce", " ", "the", " ", "number", " ", "of", " ", "nasty", 
      " ", "integrals", " ", "that", " ", "are", " ", 
      RowBox[{"present", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Initial nb. of types of nasty INT | \>\"", ",", 
      RowBox[{
       RowBox[{"NastyINTLIST", "[", "integranddFdt", "]"}], "//", 
       "Length"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Performing", " ", "symmetrisations", " ", "of", " ", "the", " ", 
      "nasty", " ", 
      RowBox[{"integrals", ".", "\[IndentingNewLine]", "In"}], " ", 
      "practice"}], ",", " ", 
     RowBox[{
     "we", " ", "found", " ", "that", " ", "there", " ", "was", " ", "no", 
      " ", "need", " ", "to", " ", "perform", " ", "more", " ", 
      "symmetrisations", " ", "than", " ", "the", " ", "two", " ", 
      RowBox[{"below", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNastyINT", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", 
         RowBox[{"k2", ",", "k1"}], "}"}]}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NastyINTLIST", "[", "integranddFdt", "]"}], "//", "Length"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNastyINT", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k1", "+", "k2"}], ",", 
          RowBox[{"-", "k2"}]}], "}"}]}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NastyINTLIST", "[", "integranddFdt", "]"}], "//", "Length"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Getting", " ", "the", " ", "final", " ", "number", " ", "of", " ", 
     "nasty", " ", "integrals", " ", 
     RowBox[{"present", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Final nb. of types of nasty INT | \>\"", ",", 
      RowBox[{
       RowBox[{"NastyINTLIST", "[", "integranddFdt", "]"}], "//", 
       "Length"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Removing", " ", "nasty", " ", "integrals", " ", "that", " ", "vanish", 
     " ", "without", " ", "any", " ", 
     RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Current", " ", "list", " ", "of", " ", "replacement", " ", "rules", " ", 
     "that", " ", "is", " ", 
     RowBox[{"used", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesTemp", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NastyINTWrapped", "[", 
       RowBox[{"integranddFdt", ",", "RulesTemp"}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Another", " ", "simplification", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesTemp", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SUM", "[", 
        RowBox[{
         RowBox[{"xSUM_", " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J"}], "}"}]}], "]"}]}], ",", "varSUM_"}], 
        "]"}], "\[RuleDelayed]", 
       RowBox[{"SUM", "[", 
        RowBox[{
         RowBox[{"ReplaceVariables", "[", 
          RowBox[{
           RowBox[{"xSUM", " ", 
            RowBox[{"UPotk", "[", 
             RowBox[{
              RowBox[{"k1", "+", "k2"}], ",", 
              RowBox[{"{", 
               RowBox[{"J", ",", "J"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"k1", "+", "k2"}], ",", 
             RowBox[{"-", "k2"}]}], "}"}]}], "]"}], ",", "varSUM"}], "]"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NastyINTWrapped", "[", 
       RowBox[{"integranddFdt", ",", "RulesTemp"}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Yet", " ", "another", " ", 
     RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesTemp", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"SUM", "[", 
         RowBox[{
          FractionBox["xSUM_", 
           RowBox[{"Abs", "[", "k2", "]"}]], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"SUM", "[", 
        RowBox[{
         RowBox[{"ReplaceVariables", "[", 
          RowBox[{
           RowBox[{"xSUM", "/", 
            RowBox[{"Abs", "[", "k2", "]"}]}], ",", 
           RowBox[{"{", "k2", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k1", "+", "k2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NastyINTWrapped", "[", 
       RowBox[{"integranddFdt", ",", "RulesTemp"}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Performing", " ", "an", " ", "even", " ", "more", " ", "deft", " ", 
     RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesTemp", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"SUM", "[", 
          RowBox[{
           FractionBox["xSUM_", 
            RowBox[{"Abs", "[", "k2", "]"}]], ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{
            FractionBox["xSUM", 
             RowBox[{"Abs", "[", "k2", "]"}]], ",", 
            RowBox[{"{", "k2", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "k1"}], "-", "k2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"SUM", "[", 
          RowBox[{"xSUM_", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"xSUM", ",", 
            RowBox[{"{", "k2", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "k1"}], "-", "k2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"SUM", "[", 
          RowBox[{"xSUM_", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"xSUM", " ", "+", " ", 
             RowBox[{"ReplaceVariables", "[", 
              RowBox[{"xSUM", ",", 
               RowBox[{"{", "k1", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"-", "k1"}], "}"}]}], "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NastyINTWrapped", "[", 
       RowBox[{"integranddFdt", ",", "RulesTemp"}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Similar", " ", "deft", " ", "symmetrisations"}], ",", " ", 
     RowBox[{"this", " ", "time", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", "k1", "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesTemp", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"SUM", "[", 
          RowBox[{
           FractionBox["xSUM_", 
            RowBox[{"Abs", "[", "k1", "]"}]], ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{
            FractionBox["xSUM", 
             RowBox[{"Abs", "[", "k1", "]"}]], ",", 
            RowBox[{"{", "k1", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "k1"}], "-", "k2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"SUM", "[", 
          RowBox[{"xSUM_", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"xSUM", ",", 
            RowBox[{"{", "k1", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "k1"}], "-", "k2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"SUM", "[", 
          RowBox[{"xSUM_", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"xSUM", " ", "+", " ", 
             RowBox[{"ReplaceVariables", "[", 
              RowBox[{"xSUM", ",", 
               RowBox[{"{", "k1", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"-", "k1"}], "}"}]}], "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NastyINTWrapped", "[", 
       RowBox[{"integranddFdt", ",", "RulesTemp"}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "To", " ", "further", " ", "reduce", " ", "the", " ", "type", " ", "of", 
      " ", "nasty", " ", "integrals", " ", "that", " ", "are", " ", 
      "present"}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "perform", " ", "an", " ", "integration", " ", "by", " ", 
       RowBox[{"parts", ".", "\[IndentingNewLine]", "We"}], " ", "note", " ", 
       "that", " ", 
       RowBox[{"IDIRAC", "[", "J1", "]"}]}], "=", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{"\[CapitalOmega]1", "-", "\[CapitalOmega]2"}], "]"}], ",", 
         RowBox[{"{", "J2", "}"}]}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/"}], "|", 
         RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}], "|", " ", 
         RowBox[{"satisfies", "\[IndentingNewLine]", 
          RowBox[{"d", "/", 
           RowBox[{"dJ1", "[", 
            RowBox[{"I", 
             RowBox[{"(", "J1", ")"}]}], "]"}]}]}]}], "=", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]PP", "[", "1", "]"}], "/", 
            RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}]}], ")"}]}], 
         RowBox[{
          RowBox[{"I", "[", "J1", "]"}], ".", "\[IndentingNewLine]", 
          "Hence"}]}]}]}]}], ",", " ", 
     RowBox[{
     "no", " ", "need", " ", "for", " ", "a", " ", "negative", " ", "sign", 
      " ", "when", " ", "performing", " ", "the", " ", "integration", " ", 
      "by", " ", 
      RowBox[{"part", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartIDIRAC", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"INT", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"xINT_", " ", 
            RowBox[{"IDIRAC", "[", "Ja_", "]"}], " ", 
            RowBox[{"\[CapitalOmega]PP", "[", "Ja_", "]"}]}], 
           RowBox[{"\[CapitalOmega]P", "[", "Ja_", "]"}]], ",", 
          RowBox[{"{", "Ja_", "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IDIRAC", "[", "Ja", "]"}], 
          RowBox[{"DER", "[", 
           RowBox[{"xINT", ",", "Ja"}], "]"}]}], ",", 
         RowBox[{"{", "Ja", "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", "integration", " ", "by", " ", 
     RowBox[{"parts", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", "RulePartIDIRAC"}], "]"}], "//", 
       "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Computing", " ", "all", " ", "the", " ", "derivatives", " ", "that", " ",
      "have", " ", 
     RowBox[{"appeared", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{
       RowBox[{"RepeatedRules", "[", 
        RowBox[{"integranddFdt", ",", 
         RowBox[{"RulesDER", "~", "Join", "~", "RuleAbs"}]}], "]"}], "//", 
       "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "have", " ", "created", " ", "redundant", " ", "nasty", " ", 
      "integrals"}], ",", " ", 
     RowBox[{
     "so", " ", "that", " ", "we", " ", "reduce", " ", "again", " ", "the", 
      " ", "type", " ", "of", " ", "nasty", " ", "integrals", " ", "that", 
      " ", "are", " ", 
      RowBox[{"present", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNastyINT", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", 
         RowBox[{"k2", ",", "k1"}], "}"}]}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "A", " ", "simple", " ", "Simplify", " ", "allows", " ", "for", " ", "a", 
     " ", "further", " ", "reduction", " ", "of", " ", "the", " ", "number", 
     " ", "of", " ", 
     RowBox[{"terms", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Current", " ", "list", " ", "of", " ", "replacement", " ", "rules", " ", 
     "that", " ", "is", " ", 
     RowBox[{"used", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesTemp", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NastyINTWrapped", "[", 
       RowBox[{"integranddFdt", ",", "RulesTemp"}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"At", " ", "this", " ", "stage"}], ",", " ", 
     RowBox[{
     "there", " ", "remain", " ", "no", " ", "nasty", " ", "integrals", " ", 
      "of", " ", "the", " ", "form", " ", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{",", 
         RowBox[{"{", "J1", "}"}]}], "]"}], ".", "\[IndentingNewLine]", 
       "We"}], " ", "made", " ", "good", " ", 
      RowBox[{"progress", "."}]}]}], "*)"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861270972544757*^9, 3.8612709781449137`*^9}, {
   3.861271016982847*^9, 3.86127101755549*^9}, {3.8612722261105003`*^9, 
   3.861272233060635*^9}, {3.8613386558436403`*^9, 3.861338747909751*^9}, {
   3.861338972604476*^9, 3.8613392613113527`*^9}, 3.8613394137595577`*^9, {
   3.861358049739546*^9, 3.861358050176886*^9}, {3.861358137456541*^9, 
   3.861358140943252*^9}, {3.861380798506886*^9, 3.861380845662416*^9}, {
   3.8614258571772947`*^9, 3.861425857312812*^9}, {3.861426262265983*^9, 
   3.8614262980447817`*^9}, {3.861431975255334*^9, 3.861431978093981*^9}, {
   3.8614322603347483`*^9, 3.861432261213476*^9}, {3.862302424811661*^9, 
   3.862302424963111*^9}, 3.8623027117666407`*^9, {3.866194115465515*^9, 
   3.866194120513648*^9}, {3.866194210311593*^9, 3.8661942150378437`*^9}, {
   3.8665214258882933`*^9, 3.866521426013874*^9}, {3.8665215498501883`*^9, 
   3.866521552160173*^9}, {3.86652159064419*^9, 3.866521592457881*^9}, 
   3.8665216301036997`*^9, {3.866528894084673*^9, 3.866528925794765*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. of types of nasty INT | \"\>", "\[InvisibleSpace]",
    "120"}],
  SequenceForm["Initial nb. of types of nasty INT | ", 120],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.866530307200123*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9.551795`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.866530316752016*^9}],

Cell[BoxData["79"], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.866530316922001*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.301417`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.866530320224329*^9}],

Cell[BoxData["66"], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.8665303204182177`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. of types of nasty INT | \"\>", "\[InvisibleSpace]", 
   "66"}],
  SequenceForm["Final nb. of types of nasty INT | ", 66],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.866530320636504*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "1957"}],
  SequenceForm["Initial nb. terms | ", 1957],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.8665303254442463`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "1833"}],
  SequenceForm["Final nb. terms | ", 1833],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.86653032575537*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.120023`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.866530325762713*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "1833"}],
  SequenceForm["Initial nb. terms | ", 1833],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.866530330564476*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "1657"}],
  SequenceForm["Final nb. terms | ", 1657],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.8665303308982573`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.141732`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.866530330905385*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "1657"}],
  SequenceForm["Initial nb. terms | ", 1657],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.86653033362834*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "1625"}],
  SequenceForm["Final nb. terms | ", 1625],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.866530333885518*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.983838`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.866530333892877*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "1625"}],
  SequenceForm["Initial nb. terms | ", 1625],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.866530336255623*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "1135"}],
  SequenceForm["Final nb. terms | ", 1135],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.866530336726191*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.842411`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.866530336733436*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "1135"}],
  SequenceForm["Initial nb. terms | ", 1135],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.866530337593976*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "1117"}],
  SequenceForm["Final nb. terms | ", 1117],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.8665303376424*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.908728`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.866530337650342*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.116621`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.86653033776115*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.043763`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.86653033880581*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.12797`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.866530338934557*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "1063"}],
  SequenceForm["Initial nb. terms | ", 1063],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.866530338999361*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "1035"}],
  SequenceForm["Final nb. terms | ", 1035],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393328360157`*^9, 3.8613396750645037`*^9, 
  3.861380861345001*^9, 3.86138092911578*^9, 3.8613811856065197`*^9, 
  3.861381223716289*^9, 3.861381687775392*^9, 3.86141600785119*^9, 
  3.861417578862273*^9, 3.861426284233794*^9, 3.8614350473561296`*^9, 
  3.861447001223391*^9, 3.862302515495879*^9, 3.862302711766707*^9, 
  3.862457516427369*^9, 3.86254416250554*^9, 3.862632139357724*^9, 
  3.86273616267943*^9, 3.862738327423605*^9, 3.8629125535892*^9, 
  3.862999736298916*^9, 3.86300091581703*^9, 3.863008955268771*^9, 
  3.866180538518628*^9, 3.8661942559480333`*^9, 3.8665303390812893`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.146662`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.8613393431194553`*^9, 3.86133968563769*^9, 
  3.861380871642508*^9, 3.861380939540393*^9, 3.861381195736561*^9, 
  3.8613812341760683`*^9, 3.861381697938242*^9, 3.861416017519145*^9, 
  3.8614175893125896`*^9, 3.861426294738678*^9, 3.8614350572764463`*^9, 
  3.861447012156836*^9, 3.862302526301735*^9, 3.8623027117667627`*^9, 
  3.8624575269741583`*^9, 3.862544172346472*^9, 3.862632150090417*^9, 
  3.862736172623454*^9, 3.862738337405466*^9, 3.86291256313395*^9, 
  3.862999747082258*^9, 3.8630009263196373`*^9, 3.8630089654810247`*^9, 
  3.866180548681102*^9, 3.866194266228726*^9, 3.86653033908928*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "now", " ", "move", " ", "on", " ", "to", " ", "simplifying", 
     " ", "all", " ", "the", " ", "terms", " ", "that", " ", "involve", " ", 
     "no", " ", "integrals", " ", "at", " ", 
     RowBox[{"all", ".", "\[IndentingNewLine]", "First"}]}], ",", " ", 
    RowBox[{
    "we", " ", "try", " ", "to", " ", "reduce", " ", "the", " ", "types", " ",
      "of", " ", "nasty", " ", "sum", " ", "that", " ", "are", " ", 
     RowBox[{"present", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Generic", " ", "function", " ", "that", " ", "returns", " ", "the", " ", 
     "list", " ", "of", " ", "all", " ", "the", " ", "nasty", " ", "sums"}], 
    ",", " ", 
    RowBox[{"SUM", "[", "..", "]"}], ",", " ", 
    RowBox[{"that", " ", "are", " ", 
     RowBox[{"present", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
    RowBox[{
    "here", " ", "we", " ", "only", " ", "focus", " ", "on", " ", "SUM", " ", 
     "that", " ", "do", " ", "not", " ", "involve", " ", "any", " ", 
     "integrals"}], ",", " ", 
    RowBox[{
     RowBox[{"INT", "[", 
      RowBox[{",", 
       RowBox[{"{", 
        RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "."}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NastySUMLIST", "[", "expinit_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"listSUM", ",", "listSUMarg", ",", "listSUMcore"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{
         "we", " ", "extract", " ", "the", " ", "list", " ", "of", " ", "all",
           " ", "the", " ", "nasty", " ", 
          RowBox[{"sums", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"listSUM", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"expinit", "/.", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"HoldPattern", "@", 
                    RowBox[{"SUM", "[", 
                    RowBox[{"xSUM_", ",", 
                    RowBox[{"{", 
                    RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], 
                   "\[RuleDelayed]", 
                   RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{"SUM", "[", 
                    RowBox[{"xSUM", ",", 
                    RowBox[{"{", 
                    RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "]"}], "/;", 
                    RowBox[{"(", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"xSUM", ",", 
                    RowBox[{"INT", "[", "__", "]"}]}], "]"}], ")"}]}]}], 
                  "\[IndentingNewLine]", "}"}]}], ")"}], "//", "Reap"}], "//",
               "Last"}], "//", "Last"}], "//", "Counts"}], "//", "Normal"}], "//", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Actually", ",", " ", 
          RowBox[{
          "we", " ", "want", " ", "to", " ", "use", " ", "a", " ", "more", 
           " ", "complicated", " ", "criteria", " ", "to", " ", "decide", " ",
            "the", " ", "type", " ", "of", " ", "a", " ", 
           RowBox[{"sum", ".", "\[IndentingNewLine]", "A"}], " ", "typical", 
           " ", "sum", " ", "is", " ", "of", " ", "the", " ", "form", 
           "\[IndentingNewLine]", 
           RowBox[{"SUM", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"ka", " ", 
               RowBox[{"UPotk", "[", "kb", "]"}]}], 
              RowBox[{"kc", " ", 
               RowBox[{"Abs", "[", "kd", "]"}]}]], ",", 
             RowBox[{"{", 
              RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "The", " ", "terms", " ", "that", " ", 
           "determine", " ", "the", " ", "type", " ", "of", " ", "the", " ", 
           "sum", " ", "are", " ", "only", "\[IndentingNewLine]", 
           FractionBox[
            RowBox[{"UPotk", "[", "kb", "]"}], 
            RowBox[{"Abs", "[", "kd", "]"}]], "\[IndentingNewLine]", "and", 
           " ", "it", " ", "is", " ", "these", " ", "terms", " ", "that", " ",
            "we", " ", "want", " ", "to", " ", "make", " ", "as", " ", 
           "simple", " ", "as", " ", 
           RowBox[{"possible", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "extract", " ", "the", " ", "argument", " ", "from", " ", 
          "all", " ", "the", " ", 
          RowBox[{"SUM", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listSUMarg", "=", " ", 
         RowBox[{"listSUM", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"HoldPattern", "@", 
             RowBox[{"SUM", "[", 
              RowBox[{"xSUM_", ",", 
               RowBox[{"{", 
                RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]",
             "xSUM"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "now", " ", "extract", " ", "the", " ", "core", " ", 
           "part", " ", "of", " ", "the", " ", "arguments", " ", "of", " ", 
           "the", " ", 
           RowBox[{"sum", ".", "\[IndentingNewLine]", "In"}], " ", 
           "essence"}], ",", " ", 
          RowBox[{
          "this", " ", "amounts", " ", "to", " ", "removing", " ", "the", " ",
            "occurrences", " ", "of", " ", "k1"}], ",", " ", 
          RowBox[{"k2", " ", "and", " ", 
           RowBox[{"(", 
            RowBox[{"k1", "+", "k2"}], ")"}], " ", "at", " ", "the", " ", 
           "numerator", " ", "and", " ", 
           RowBox[{"denominator", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listSUMcore", " ", "=", " ", 
         RowBox[{"RepeatedRules", "[", 
          RowBox[{"listSUMarg", ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"xx_", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"k_", "?", "WaveQ"}], ")"}], "^", 
                RowBox[{"(", "n_.", ")"}]}]}], "\[RuleDelayed]", "xx"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"xx_", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ka_", "?", "WaveQ"}], " ", "+", " ", 
                  RowBox[{"kb_", "?", "WaveQ"}]}], ")"}], "^", 
                RowBox[{"(", "n_.", ")"}]}]}], "\[RuleDelayed]", "xx"}]}], 
            "\[IndentingNewLine]", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"We", " ", "remove", " ", "all", " ", "the", " ", 
          RowBox[{"duplicates", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listSUMcore", " ", "=", " ", 
         RowBox[{"listSUMcore", "//", "DeleteDuplicates"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "listSUMcore", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "checks", " ", "that", " ",
       "a", " ", "given", " ", "summand", " ", "from", " ", "a", " ", "SUM", 
      " ", "is", " ", "not", " ", "part", " ", "of", " ", "the", " ", 
      RowBox[{"core", ".", "\[IndentingNewLine]", "In"}], " ", "essence"}], 
     ",", " ", 
     RowBox[{
     "it", " ", "must", " ", "be", " ", "free", " ", "from", " ", "any", " ", 
      "INT"}], ",", " ", "Abs", ",", " ", 
     RowBox[{
     "and", " ", "any", " ", "UPotk", " ", "and", " ", "associated", " ", 
      RowBox[{"derivatives", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SummandNastySUMQ", "[", "xSUM_", "]"}], ":=", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"xSUM", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"INT", "[", "__", "]"}], ",", 
          RowBox[{"Abs", "[", "__", "]"}], ",", 
          RowBox[{"UPotk", "[", "__", "]"}], ",", 
          RowBox[{"UPotkP1", "[", "__", "]"}], ",", 
          RowBox[{"UPotkP2", "[", "__", "]"}], ",", 
          RowBox[{"UPotkP1P1", "[", "__", "]"}], ",", 
          RowBox[{"UPotkP1P2", "[", "__", "]"}], ",", 
          RowBox[{"UPotkP2P2", "[", "__", "]"}]}], "}"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "is", " ", "given", " ", 
      "an", " ", "expression"}], ",", " ", 
     RowBox[{
     "a", " ", "nasty", " ", "core", " ", "part", " ", "of", " ", "a", " ", 
      "sum"}], ",", " ", 
     RowBox[{
     "and", " ", "a", " ", "symmetrisation", " ", "rule", " ", "for", " ", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], " ", "and", " ", "applies", " ", 
      "the", " ", 
      RowBox[{"symmetrisation", ".", "\[IndentingNewLine]", "The"}], " ", 
      "goal", " ", "of", " ", "this", " ", "function", " ", "is", " ", "to", 
      " ", "perform", " ", "relabellings", " ", "of", " ", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], " ", "so", " ", "that", " ", "nasty",
       " ", "sums", " ", "are", " ", "reduced", " ", "to", " ", "their", " ", 
      "\"\<fundamental\>\"", " ", 
      RowBox[{"types", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NastySUMSymk1k2", "[", 
      RowBox[{"expinit_", ",", "SUMcore_", ",", "newk1k2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "exp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Applying", " ", "the", " ", 
          RowBox[{"rule", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
         " ", 
         RowBox[{
         "the", " ", "other", " ", "argument", " ", "in", " ", "the", " ", 
          "SUM", " ", "is", " ", "optional"}], ",", " ", 
         RowBox[{"just", " ", "in", " ", 
          RowBox[{"case", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
         " ", 
         RowBox[{
          RowBox[{
          "we", " ", "also", " ", "make", " ", "sure", " ", "that", " ", 
           "xSUM", " ", "is", " ", "a", " ", "non"}], "-", 
          RowBox[{"core", " ", 
           RowBox[{"summand", ".", "\[IndentingNewLine]", "ATTENTION"}]}]}], 
         ",", " ", 
         RowBox[{"in", " ", "this", " ", "rule"}], ",", " ", 
         RowBox[{
         "we", " ", "cannot", " ", "use", " ", "HoldPattern", " ", 
          "otherwise", " ", "the", " ", "expression", " ", "do", " ", "not", 
          " ", "get", " ", 
          RowBox[{"matched", ":", " ", 
           RowBox[{
           "we", " ", "let", " ", "MMA", " ", "make", " ", "some", " ", 
            RowBox[{"rewritings", ".", "\[IndentingNewLine]", "As"}], " ", 
            "a", " ", "consequence"}]}]}], ",", " ", 
         RowBox[{
         "we", " ", "can", " ", "write", " ", "explicitly", " ", "in", " ", 
          "the", " ", "rule", " ", "the", " ", "arguments", " ", "of", " ", 
          "summation"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"expinit", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SUM", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xSUM_:", "1"}], ")"}], "SUMcore"}], ",", "varSUM_"}],
              "]"}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{"ReplaceVariables", "[", 
                RowBox[{
                 RowBox[{"xSUM", " ", "SUMcore"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k1", ",", "k2"}], "}"}], ",", "newk1k2"}], "]"}], 
               ",", "varSUM"}], "]"}], "/;", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"SummandNastySUMQ", "[", "xSUM", "]"}], "&&", 
               RowBox[{"SameQ", "[", 
                RowBox[{"varSUM", ",", 
                 RowBox[{"{", 
                  RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "takes", " ", "an", " ", 
      "initial", " ", "expression"}], ",", " ", 
     RowBox[{"a", " ", "symmetrisation", " ", "rule"}], ",", " ", 
     RowBox[{
     "and", " ", "performs", " ", "a", " ", "symmetrisation", " ", "of", " ", 
      "the", " ", "nasty", " ", "sums", " ", "to", " ", "try", " ", "and", 
      " ", "reduce", " ", "their", " ", 
      RowBox[{"number", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReduceNastySUM", "[", 
      RowBox[{"expinit_", ",", "newk1k2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "exp", ",", "listNASTY", ",", "listNASTYsym", ",", "listNASTYinter", 
         ",", "intinter", ",", "ind", ",", "sum"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{"we", " ", "copy", " ", "the", " ", "initial", " ", 
          RowBox[{"expression", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", "expinit"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "determine", " ", "the", " ", "initial", " ", "list", " ",
           "of", " ", "nasty", " ", 
          RowBox[{"sums", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNASTY", " ", "=", " ", 
         RowBox[{"NastySUMLIST", "[", "exp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "limit", " ", "ourselves", " ", "only", " ", "to", " ", 
          "nasty", " ", "sums", " ", "that", " ", "change", " ", "upon", " ", 
          
          RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNASTY", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"listNASTY", ",", 
           RowBox[{
            RowBox[{"UnsameQ", "[", 
             RowBox[{"#", ",", 
              RowBox[{"ReplaceVariables", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"k1", ",", "k2"}], "}"}], ",", "newk1k2"}], "]"}]}], 
             "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "consider", " ", "the", " ", "symmetrised", " ", 
          "version", " ", "of", " ", "the", " ", "nasty", " ", 
          RowBox[{"sums", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNASTYsym", " ", "=", " ", 
         RowBox[{"ReplaceVariables", "[", 
          RowBox[{"listNASTY", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}], ",", "newk1k2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Computing", " ", "the", " ", "intersection", " ", "of", " ", "the", 
          " ", "two", " ", 
          RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNASTYinter", " ", "=", " ", 
         RowBox[{"Intersection", "[", 
          RowBox[{"listNASTY", ",", "listNASTYsym"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "As", " ", "long", " ", "as", " ", "there", " ", "is", " ", "some", 
           " ", "overlap", " ", "between", " ", "the", " ", "two", " ", 
           "lists"}], ",", " ", 
          RowBox[{
          "we", " ", "are", " ", "going", " ", "to", " ", "perform", " ", 
           RowBox[{"symmetrisations", "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"UnsameQ", "[", 
           RowBox[{"listNASTYinter", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Nasty", " ", "sum", " ", "that", " ", "can", " ", "be", " ", 
            RowBox[{"symmetrised", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"intinter", " ", "=", " ", 
            RowBox[{"listNASTYinter", "//", "First"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "We", " ", "find", " ", "its", " ", "position", " ", "in", " ", 
             "the", " ", "symmetrised", " ", 
             RowBox[{"sums", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ind", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"listNASTYsym", ",", "intinter"}], "]"}], "//", 
              "First"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "The", " ", "sum", " ", "to", " ", "symmetrise", " ", "is", " ", 
              "then", " ", "the", " ", "following", " ", 
              RowBox[{"one", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",",
              " ", 
             RowBox[{
             "it", " ", "is", " ", "important", " ", "to", " ", "proceed", 
              " ", "in", " ", "that", " ", "order", " ", "to", " ", "prevent",
               " ", "falling", " ", "into", " ", "infinite", " ", "loops", 
              " ", "of", " ", 
              RowBox[{"replacements", "."}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"sum", " ", "=", " ", 
            RowBox[{"listNASTY", "[", 
             RowBox[{"[", "ind", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Performing", " ", "the", " ", 
             RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"exp", " ", "=", " ", 
            RowBox[{"NastySUMSymk1k2", "[", 
             RowBox[{"exp", ",", "sum", ",", "newk1k2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Determining", " ", "the", " ", "new", " ", "list", " ", "of", 
              " ", "nasty", " ", 
              RowBox[{"sums", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
             ",", " ", 
             RowBox[{
             "we", " ", "limit", " ", "ourselves", " ", "only", " ", "to", 
              " ", "nasty", " ", "sums", " ", "that", " ", "change", " ", 
              "upon", " ", 
              RowBox[{"symmetrisation", "."}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"listNASTY", " ", "=", " ", 
            RowBox[{"NastySUMLIST", "[", "exp", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"listNASTY", " ", "=", " ", 
            RowBox[{"Select", "[", 
             RowBox[{"listNASTY", ",", 
              RowBox[{
               RowBox[{"UnsameQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"ReplaceVariables", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{"k1", ",", "k2"}], "}"}], ",", "newk1k2"}], 
                  "]"}]}], "]"}], "&"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Updating", " ", "the", " ", "list", " ", "of", " ", 
             "symmetrised", " ", "nasty", " ", 
             RowBox[{"sums", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"listNASTYsym", " ", "=", " ", 
            RowBox[{"ReplaceVariables", "[", 
             RowBox[{"listNASTY", ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", "k2"}], "}"}], ",", "newk1k2"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Updating", " ", "the", " ", "intersection", " ", "of", " ", 
             "the", " ", "two", " ", 
             RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"listNASTYinter", " ", "=", " ", 
            RowBox[{"Intersection", "[", 
             RowBox[{"listNASTY", ",", "listNASTYsym"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "returns", " ", "True", 
      " ", "if", " ", "ever", " ", "a", " ", "given", " ", "term", " ", 
      "contains", " ", "a", " ", "SUM", " ", "with", " ", "the", " ", 
      "expected", " ", "core", " ", 
      RowBox[{"component", ".", "\[IndentingNewLine]", "It"}], " ", "is", " ",
       "important", " ", "to", " ", "check", " ", "that", " ", "the", " ", 
      "rest", " ", "of", " ", "the", " ", "summand", " ", "is", " ", "non"}], 
     "-", 
     RowBox[{"core", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ContainsCoreSUMQ", "[", 
      RowBox[{"exp_", ",", "SUMcore_"}], "]"}], ":=", 
     RowBox[{"!", 
      RowBox[{"FreeQ", "[", 
       RowBox[{"exp", ",", 
        RowBox[{
         RowBox[{"SUM", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"xSUM_:", "1"}], ")"}], " ", "SUMcore"}], ",", 
           "varSUM_"}], "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"SummandNastySUMQ", "[", "xSUM", "]"}], "&&", 
           RowBox[{"SameQ", "[", 
            RowBox[{"varSUM", ",", 
             RowBox[{"{", 
              RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], ")"}]}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "takes", " ", "as", " ", 
      "an", " ", "argument", " ", "an", " ", 
      RowBox[{"(", "intricate", ")"}], " ", "nasty", " ", "core", " ", 
      "SUM"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "isolates", " ", "in", " ", "the", " ", "expression", " ", "the", " ", 
      "terms", " ", "that", " ", "involve", " ", "this", " ", "sum"}], ",", 
     "\[IndentingNewLine]", "performs", ",", " ", 
     RowBox[{"in", " ", "order"}], ",", " ", 
     RowBox[{"the", " ", "symmetrisations", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2"}], "}"}]}], " ", "given", " ", "in", " ", 
      "argument"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "and", " ", "checks", " ", "that", " ", "it", " ", "gives", " ", 
      RowBox[{"zero", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NastySUMQ", "[", 
      RowBox[{"expinit_", ",", "SUMcore_", ",", "RULES_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rule", ",", "LISTexp", ",", "exp"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{
         "we", " ", "transform", " ", "the", " ", "expression", " ", "into", 
          " ", "a", " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LISTexp", " ", "=", " ", 
         RowBox[{"List", "@@", 
          RowBox[{"(", 
           RowBox[{"expinit", "//", "Expand"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "select", " ", "the", " ", "elements", " ", "that", " ", 
           "involve", " ", "the", " ", 
           RowBox[{"sum", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
          " ", 
          RowBox[{
          "we", " ", "must", " ", "make", " ", "sure", " ", "that", " ", 
           "the", " ", "term", " ", "contains", " ", "a", " ", "SUM", " ", 
           "with", " ", "the", " ", "expected", " ", "core", " ", 
           RowBox[{"element", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"LISTexp", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ContainsCoreSUMQ", "[", 
              RowBox[{"#", ",", "SUMcore"}], "]"}], "&"}], ")"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Putting", " ", "back", " ", "as", " ", "a", " ", "sum", " ", "of", 
          " ", 
          RowBox[{"terms", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"Plus", "@@", "exp"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "we", " ", "perform", " ", "the", " ", "symmetrisation",
            " ", "as", " ", "given", " ", "in", " ", 
           RowBox[{"argument", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
          ",", " ", 
          RowBox[{
          "we", " ", "apply", " ", "all", " ", "the", " ", "rules", " ", "in",
            " ", 
           RowBox[{"order", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exp", " ", "=", 
           RowBox[{
            RowBox[{"(", " ", 
             RowBox[{"exp", "/.", "rule"}], ")"}], "//", "Expand"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"rule", ",", "RULES"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "now", " ", "try", " ", "to", " ", "simplify", " ", "the",
           " ", "resulting", " ", 
          RowBox[{"expression", ".", "\[IndentingNewLine]", "We"}], " ", 
          "temporarily", " ", "remove", " ", "the", " ", "SUM", " ", "to", 
          " ", "let", " ", "MMA", " ", "simplify"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"exp", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SUM", "[", 
             RowBox[{"xSUM_", ",", "varSUM_"}], "]"}], "\[RuleDelayed]", 
            "xSUM"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Simplifying", " ", "and", " ", "crossing", " ", "our", " ", 
          RowBox[{"fingers", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"exp", "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determining", " ", "if", " ", "the", " ", "result", " ", 
          RowBox[{"vanishes", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"SameQ", "[", 
          RowBox[{"exp", ",", "0"}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "removes", " ", "all", " ",
       "the", " ", "contributions", " ", "from", " ", "a", " ", "NastySUM"}], 
     ",", " ", 
     RowBox[{
     "which", " ", "we", " ", "just", " ", "checked", " ", "gives", " ", "a", 
      " ", "vanishing", " ", 
      RowBox[{"contribution", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NastySUMRemove", "[", 
      RowBox[{"expinit_", ",", "SUMcore_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "exp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Replacing", " ", "the", " ", "sums", " ", "by", " ", "0."}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"expinit", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"ATTENTION", ",", " ", 
             RowBox[{
              RowBox[{
              "we", " ", "make", " ", "sure", " ", "that", " ", "the", " ", 
               "summand", " ", "is", " ", "a", " ", "non"}], "-", 
              RowBox[{"core", " ", 
               RowBox[{"type", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SUM", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xSUM_:", "1"}], ")"}], "SUMcore"}], ",", "varSUM_"}],
              "]"}], "\[RuleDelayed]", 
            RowBox[{"0", "/;", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"SummandNastySUMQ", "[", "xSUM", "]"}], "&&", 
               RowBox[{"SameQ", "[", 
                RowBox[{"varSUM", ",", 
                 RowBox[{"{", 
                  RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "takes", " ", "an", " ", 
      "expression", " ", "and", " ", "replacement", " ", "rules"}], ",", " ", 
     
     RowBox[{
     "and", " ", "removes", " ", "all", " ", "the", " ", "sums", " ", "that", 
      " ", 
      RowBox[{"vanish", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NastySUMWrapped", "[", 
      RowBox[{"expinit_", ",", "RULES_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "exp", ",", "listNastySUM", ",", "listNastySUMQ", ",", 
         "listNastySUMind", ",", "listNastySUMvanish"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Copying", " ", "the", " ", "initial", " ", 
         RowBox[{"expressions", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", "expinit"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"List", " ", "of", " ", "all", " ", "the", " ", "nasty", " ", 
          RowBox[{"sum", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNastySUM", " ", "=", " ", 
         RowBox[{"NastySUMLIST", "[", "exp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"For", " ", "every", " ", "sum"}], ",", " ", 
          RowBox[{
          "we", " ", "try", " ", "to", " ", "simplify", " ", "using", " ", 
           "the", " ", "symmetrisation", " ", 
           RowBox[{"rule", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNastySUMQ", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"NastySUMQ", "[", 
            RowBox[{"exp", ",", "#", ",", "RULES"}], "]"}], "&"}], "/@", 
          "listNastySUM"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "find", " ", "the", " ", "index", " ", "of", " ", "all", 
          " ", "the", " ", "nasty", " ", "sums", " ", "that", " ", 
          RowBox[{"vanish", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNastySUMind", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"listNastySUMQ", ",", "True"}], "]"}], "//", 
          RowBox[{
           RowBox[{"First", "/@", "#"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "construct", " ", "the", " ", "list", " ", "of", " ", 
          "the", " ", "nasty", " ", "sums", " ", "that", " ", 
          RowBox[{"vanish", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNastySUMvanish", " ", "=", " ", 
         RowBox[{"listNastySUM", "[", 
          RowBox[{"[", "listNastySUMind", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", ",", " ", 
          RowBox[{
          "for", " ", "every", " ", "vanishing", " ", "nasty", " ", "sum"}], 
          ",", " ", 
          RowBox[{
          "we", " ", "remove", " ", "it", " ", "from", " ", "the", " ", 
           RowBox[{"expressions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Initial nb. terms | \>\"", ",", 
          RowBox[{"exp", "//", "Length"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exp", " ", "=", " ", 
           RowBox[{"NastySUMRemove", "[", 
            RowBox[{"exp", ",", "SUMNasty"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"SUMNasty", ",", "listNastySUMvanish"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Final nb. terms | \>\"", ",", 
          RowBox[{"exp", "//", "Length"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", ",", " ", 
     RowBox[{
     "we", " ", "reduce", " ", "the", " ", "number", " ", "of", " ", "nasty", 
      " ", "integrals", " ", "that", " ", "are", " ", 
      RowBox[{"present", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Initial nb. of types of nasty SUM | \>\"", ",", 
      RowBox[{
       RowBox[{"NastySUMLIST", "[", "integranddFdt", "]"}], "//", 
       "Length"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Performing", " ", "symmetrisations", " ", "of", " ", "the", " ", "nasty",
      " ", 
     RowBox[{"sums", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNastySUM", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", 
         RowBox[{"k2", ",", "k1"}], "}"}]}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNastySUM", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k1", "+", "k2"}], ",", 
          RowBox[{"-", "k1"}]}], "}"}]}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNastySUM", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k1", "+", "k2"}], ",", 
          RowBox[{"-", "k2"}]}], "}"}]}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNastySUM", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "k1"}], ",", 
          RowBox[{"k1", "+", "k2"}]}], "}"}]}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNastySUM", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "k2"}], ",", 
          RowBox[{"k1", "+", "k2"}]}], "}"}]}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Getting", " ", "the", " ", "final", " ", "number", " ", "of", " ", 
     "nasty", " ", "integrals", " ", 
     RowBox[{"present", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Final nb. of types of nasty SUM | \>\"", ",", 
      RowBox[{
       RowBox[{"NastySUMLIST", "[", "integranddFdt", "]"}], "//", 
       "Length"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Removing", " ", "nasty", " ", "sums", " ", "by", " ", 
     RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Not", " ", "doing", " ", 
     RowBox[{"anything", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesTemp", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NastySUMWrapped", "[", 
       RowBox[{"integranddFdt", ",", "RulesTemp"}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Simply", " ", "switching", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesTemp", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"SUM", "[", 
         RowBox[{"xSUM_", ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"SUM", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"xSUM", " ", "+", " ", 
            RowBox[{"ReplaceVariables", "[", 
             RowBox[{"xSUM", ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", "k2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k2", ",", "k1"}], "}"}]}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NastySUMWrapped", "[", 
       RowBox[{"integranddFdt", ",", "RulesTemp"}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Performing", " ", "an", " ", "even", " ", "more", " ", "deft", " ", 
     RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesTemp", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"SUM", "[", 
          RowBox[{
           FractionBox["xSUM_", 
            RowBox[{"Abs", "[", "k2", "]"}]], ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{
            FractionBox["xSUM", 
             RowBox[{"Abs", "[", "k2", "]"}]], ",", 
            RowBox[{"{", "k2", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "k1"}], "-", "k2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"SUM", "[", 
          RowBox[{"xSUM_", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"ReplaceVariables", "[", 
           RowBox[{"xSUM", ",", 
            RowBox[{"{", "k2", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "k1"}], "-", "k2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HoldPattern", "@", 
         RowBox[{"SUM", "[", 
          RowBox[{"xSUM_", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"xSUM", " ", "+", " ", 
             RowBox[{"ReplaceVariables", "[", 
              RowBox[{"xSUM", ",", 
               RowBox[{"{", "k1", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"-", "k1"}], "}"}]}], "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NastySUMWrapped", "[", 
       RowBox[{"integranddFdt", ",", "RulesTemp"}], "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "All", " ", "the", " ", "terms", " ", "with", " ", "no", " ", "INT", " ", 
     "have", " ", "vanished", " ", "by", " ", 
     RowBox[{"symmetry", ".", "\[IndentingNewLine]", "We"}], " ", "have", " ",
      "made", " ", "good", " ", 
     RowBox[{"progress", "."}]}], "*)"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861417638291367*^9, 3.8614176532356653`*^9}, {
   3.8614180032160177`*^9, 3.861418044120986*^9}, {3.8614197301381474`*^9, 
   3.861419734920472*^9}, {3.861419830564619*^9, 3.861419899523733*^9}, {
   3.861419937760292*^9, 3.861420030996951*^9}, {3.861420095241317*^9, 
   3.861420270533736*^9}, {3.861420947068768*^9, 3.8614212429188013`*^9}, 
   3.8614251251488523`*^9, {3.8614252990906277`*^9, 3.861425390573348*^9}, 
   3.861425429040368*^9, {3.861425468704811*^9, 3.861425602794339*^9}, {
   3.861425718695113*^9, 3.861425841269515*^9}, {3.861425877438561*^9, 
   3.861425908030723*^9}, {3.8614259420651712`*^9, 3.861426055995085*^9}, {
   3.861426337960328*^9, 3.861426341639101*^9}, {3.861426383250285*^9, 
   3.861426405418075*^9}, {3.8614265118124533`*^9, 3.861426529988793*^9}, {
   3.861426616475132*^9, 3.861426687332034*^9}, {3.8614267359924097`*^9, 
   3.861426755160158*^9}, {3.861426946967778*^9, 3.861427033040813*^9}, {
   3.861427069649508*^9, 3.861427078742655*^9}, {3.861427904117697*^9, 
   3.861428193396922*^9}, {3.8614318671071577`*^9, 3.8614321505571623`*^9}, {
   3.8614322355217876`*^9, 3.861432254573744*^9}, {3.861432664112419*^9, 
   3.861432818928422*^9}, {3.8614328596136*^9, 3.86143287505126*^9}, {
   3.861432905200382*^9, 3.861432917548225*^9}, {3.861432975839279*^9, 
   3.861433043464698*^9}, {3.861433079955204*^9, 3.8614330802085743`*^9}, {
   3.8614331821093197`*^9, 3.8614332964043417`*^9}, {3.861433375952223*^9, 
   3.8614334932373257`*^9}, {3.86230244574225*^9, 3.862302452542369*^9}, 
   3.862302711770093*^9, {3.866194261788827*^9, 3.8661942783803062`*^9}, {
   3.866194363791634*^9, 3.866194367932725*^9}, {3.8665289352939463`*^9, 
   3.866528942668696*^9}, {3.866528977499762*^9, 3.866528978971828*^9}, {
   3.866529025593856*^9, 3.866529065135049*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. of types of nasty SUM | \"\>", "\[InvisibleSpace]",
    "38"}],
  SequenceForm["Initial nb. of types of nasty SUM | ", 38],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426423682967*^9, 3.861426461637768*^9, 
  3.861426533985731*^9, 3.8614278647244577`*^9, 3.861432274544627*^9, 
  3.861433498078088*^9, 3.861434620384997*^9, 3.861435081799605*^9, 
  3.8614470381822987`*^9, 3.862302555932032*^9, 3.862302711770149*^9, 
  3.86245755177499*^9, 3.862544196938444*^9, 3.862632173510378*^9, 
  3.8627361957280693`*^9, 3.86273836039854*^9, 3.862912587491519*^9, 
  3.862999772251914*^9, 3.8630009508957767`*^9, 3.8630089899167128`*^9, 
  3.866180572057672*^9, 3.866194372707646*^9, 3.8665303396194687`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.336789`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426506264327*^9, 3.861426570203032*^9, 
  3.861427869881528*^9, 3.86143227997052*^9, 3.861433503981526*^9, 
  3.861434626138525*^9, 3.861435087513774*^9, 3.861447044489987*^9, 
  3.862302561428225*^9, 3.862302711770212*^9, 3.862457557175653*^9, 
  3.862544202634377*^9, 3.862632179052517*^9, 3.862736201322975*^9, 
  3.86273836585867*^9, 3.862912593471133*^9, 3.862999778189386*^9, 
  3.86300095667318*^9, 3.863008995623767*^9, 3.866180577608836*^9, 
  3.866194378410379*^9, 3.866530344956729*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.64461`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426506264327*^9, 3.861426570203032*^9, 
  3.861427869881528*^9, 3.86143227997052*^9, 3.861433503981526*^9, 
  3.861434626138525*^9, 3.861435087513774*^9, 3.861447044489987*^9, 
  3.862302561428225*^9, 3.862302711770212*^9, 3.862457557175653*^9, 
  3.862544202634377*^9, 3.862632179052517*^9, 3.862736201322975*^9, 
  3.86273836585867*^9, 3.862912593471133*^9, 3.862999778189386*^9, 
  3.86300095667318*^9, 3.863008995623767*^9, 3.866180577608836*^9, 
  3.866194378410379*^9, 3.866530347602141*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.775355`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426506264327*^9, 3.861426570203032*^9, 
  3.861427869881528*^9, 3.86143227997052*^9, 3.861433503981526*^9, 
  3.861434626138525*^9, 3.861435087513774*^9, 3.861447044489987*^9, 
  3.862302561428225*^9, 3.862302711770212*^9, 3.862457557175653*^9, 
  3.862544202634377*^9, 3.862632179052517*^9, 3.862736201322975*^9, 
  3.86273836585867*^9, 3.862912593471133*^9, 3.862999778189386*^9, 
  3.86300095667318*^9, 3.863008995623767*^9, 3.866180577608836*^9, 
  3.866194378410379*^9, 3.8665303503784113`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.280431`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426506264327*^9, 3.861426570203032*^9, 
  3.861427869881528*^9, 3.86143227997052*^9, 3.861433503981526*^9, 
  3.861434626138525*^9, 3.861435087513774*^9, 3.861447044489987*^9, 
  3.862302561428225*^9, 3.862302711770212*^9, 3.862457557175653*^9, 
  3.862544202634377*^9, 3.862632179052517*^9, 3.862736201322975*^9, 
  3.86273836585867*^9, 3.862912593471133*^9, 3.862999778189386*^9, 
  3.86300095667318*^9, 3.863008995623767*^9, 3.866180577608836*^9, 
  3.866194378410379*^9, 3.866530350660054*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.270814`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426506264327*^9, 3.861426570203032*^9, 
  3.861427869881528*^9, 3.86143227997052*^9, 3.861433503981526*^9, 
  3.861434626138525*^9, 3.861435087513774*^9, 3.861447044489987*^9, 
  3.862302561428225*^9, 3.862302711770212*^9, 3.862457557175653*^9, 
  3.862544202634377*^9, 3.862632179052517*^9, 3.862736201322975*^9, 
  3.86273836585867*^9, 3.862912593471133*^9, 3.862999778189386*^9, 
  3.86300095667318*^9, 3.863008995623767*^9, 3.866180577608836*^9, 
  3.866194378410379*^9, 3.866530350931629*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. of types of nasty SUM | \"\>", "\[InvisibleSpace]", 
   "10"}],
  SequenceForm["Final nb. of types of nasty SUM | ", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426423682967*^9, 3.861426461637768*^9, 
  3.861426533985731*^9, 3.8614278647244577`*^9, 3.861432274544627*^9, 
  3.861433498078088*^9, 3.861434620384997*^9, 3.861435081799605*^9, 
  3.8614470381822987`*^9, 3.862302555932032*^9, 3.862302711770149*^9, 
  3.86245755177499*^9, 3.862544196938444*^9, 3.862632173510378*^9, 
  3.8627361957280693`*^9, 3.86273836039854*^9, 3.862912587491519*^9, 
  3.862999772251914*^9, 3.8630009508957767`*^9, 3.8630089899167128`*^9, 
  3.866180572057672*^9, 3.866194372707646*^9, 3.866530351206807*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "1007"}],
  SequenceForm["Initial nb. terms | ", 1007],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426423682967*^9, 3.861426461637768*^9, 
  3.861426533985731*^9, 3.8614278647244577`*^9, 3.861432274544627*^9, 
  3.861433498078088*^9, 3.861434620384997*^9, 3.861435081799605*^9, 
  3.8614470381822987`*^9, 3.862302555932032*^9, 3.862302711770149*^9, 
  3.86245755177499*^9, 3.862544196938444*^9, 3.862632173510378*^9, 
  3.8627361957280693`*^9, 3.86273836039854*^9, 3.862912587491519*^9, 
  3.862999772251914*^9, 3.8630009508957767`*^9, 3.8630089899167128`*^9, 
  3.866180572057672*^9, 3.866194372707646*^9, 3.8665303526409683`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "945"}],
  SequenceForm["Final nb. terms | ", 945],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426423682967*^9, 3.861426461637768*^9, 
  3.861426533985731*^9, 3.8614278647244577`*^9, 3.861432274544627*^9, 
  3.861433498078088*^9, 3.861434620384997*^9, 3.861435081799605*^9, 
  3.8614470381822987`*^9, 3.862302555932032*^9, 3.862302711770149*^9, 
  3.86245755177499*^9, 3.862544196938444*^9, 3.862632173510378*^9, 
  3.8627361957280693`*^9, 3.86273836039854*^9, 3.862912587491519*^9, 
  3.862999772251914*^9, 3.8630009508957767`*^9, 3.8630089899167128`*^9, 
  3.866180572057672*^9, 3.866194372707646*^9, 3.8665303527610826`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.554502`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426506264327*^9, 3.861426570203032*^9, 
  3.861427869881528*^9, 3.86143227997052*^9, 3.861433503981526*^9, 
  3.861434626138525*^9, 3.861435087513774*^9, 3.861447044489987*^9, 
  3.862302561428225*^9, 3.862302711770212*^9, 3.862457557175653*^9, 
  3.862544202634377*^9, 3.862632179052517*^9, 3.862736201322975*^9, 
  3.86273836585867*^9, 3.862912593471133*^9, 3.862999778189386*^9, 
  3.86300095667318*^9, 3.863008995623767*^9, 3.866180577608836*^9, 
  3.866194378410379*^9, 3.8665303527679777`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "945"}],
  SequenceForm["Initial nb. terms | ", 945],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426423682967*^9, 3.861426461637768*^9, 
  3.861426533985731*^9, 3.8614278647244577`*^9, 3.861432274544627*^9, 
  3.861433498078088*^9, 3.861434620384997*^9, 3.861435081799605*^9, 
  3.8614470381822987`*^9, 3.862302555932032*^9, 3.862302711770149*^9, 
  3.86245755177499*^9, 3.862544196938444*^9, 3.862632173510378*^9, 
  3.8627361957280693`*^9, 3.86273836039854*^9, 3.862912587491519*^9, 
  3.862999772251914*^9, 3.8630009508957767`*^9, 3.8630089899167128`*^9, 
  3.866180572057672*^9, 3.866194372707646*^9, 3.866530353620097*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "917"}],
  SequenceForm["Final nb. terms | ", 917],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426423682967*^9, 3.861426461637768*^9, 
  3.861426533985731*^9, 3.8614278647244577`*^9, 3.861432274544627*^9, 
  3.861433498078088*^9, 3.861434620384997*^9, 3.861435081799605*^9, 
  3.8614470381822987`*^9, 3.862302555932032*^9, 3.862302711770149*^9, 
  3.86245755177499*^9, 3.862544196938444*^9, 3.862632173510378*^9, 
  3.8627361957280693`*^9, 3.86273836039854*^9, 3.862912587491519*^9, 
  3.862999772251914*^9, 3.8630009508957767`*^9, 3.8630089899167128`*^9, 
  3.866180572057672*^9, 3.866194372707646*^9, 3.866530353664381*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.901641`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426506264327*^9, 3.861426570203032*^9, 
  3.861427869881528*^9, 3.86143227997052*^9, 3.861433503981526*^9, 
  3.861434626138525*^9, 3.861435087513774*^9, 3.861447044489987*^9, 
  3.862302561428225*^9, 3.862302711770212*^9, 3.862457557175653*^9, 
  3.862544202634377*^9, 3.862632179052517*^9, 3.862736201322975*^9, 
  3.86273836585867*^9, 3.862912593471133*^9, 3.862999778189386*^9, 
  3.86300095667318*^9, 3.863008995623767*^9, 3.866180577608836*^9, 
  3.866194378410379*^9, 3.866530353671083*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "917"}],
  SequenceForm["Initial nb. terms | ", 917],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426423682967*^9, 3.861426461637768*^9, 
  3.861426533985731*^9, 3.8614278647244577`*^9, 3.861432274544627*^9, 
  3.861433498078088*^9, 3.861434620384997*^9, 3.861435081799605*^9, 
  3.8614470381822987`*^9, 3.862302555932032*^9, 3.862302711770149*^9, 
  3.86245755177499*^9, 3.862544196938444*^9, 3.862632173510378*^9, 
  3.8627361957280693`*^9, 3.86273836039854*^9, 3.862912587491519*^9, 
  3.862999772251914*^9, 3.8630009508957767`*^9, 3.8630089899167128`*^9, 
  3.866180572057672*^9, 3.866194372707646*^9, 3.866530354035471*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "856"}],
  SequenceForm["Final nb. terms | ", 856],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426423682967*^9, 3.861426461637768*^9, 
  3.861426533985731*^9, 3.8614278647244577`*^9, 3.861432274544627*^9, 
  3.861433498078088*^9, 3.861434620384997*^9, 3.861435081799605*^9, 
  3.8614470381822987`*^9, 3.862302555932032*^9, 3.862302711770149*^9, 
  3.86245755177499*^9, 3.862544196938444*^9, 3.862632173510378*^9, 
  3.8627361957280693`*^9, 3.86273836039854*^9, 3.862912587491519*^9, 
  3.862999772251914*^9, 3.8630009508957767`*^9, 3.8630089899167128`*^9, 
  3.866180572057672*^9, 3.866194372707646*^9, 3.866530354097414*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.429586`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.861426506264327*^9, 3.861426570203032*^9, 
  3.861427869881528*^9, 3.86143227997052*^9, 3.861433503981526*^9, 
  3.861434626138525*^9, 3.861435087513774*^9, 3.861447044489987*^9, 
  3.862302561428225*^9, 3.862302711770212*^9, 3.862457557175653*^9, 
  3.862544202634377*^9, 3.862632179052517*^9, 3.862736201322975*^9, 
  3.86273836585867*^9, 3.862912593471133*^9, 3.862999778189386*^9, 
  3.86300095667318*^9, 3.863008995623767*^9, 3.866180577608836*^9, 
  3.866194378410379*^9, 3.866530354105216*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "The", " ", "only", " ", "terms", " ", "that", " ", "remain", " ", 
      "involve", " ", "the", " ", "3"}], "-", 
     RowBox[{"body", " ", "resonance", " ", "condition"}]}], ",", " ", 
    RowBox[{"via", "\[IndentingNewLine]", 
     RowBox[{"DIRAC", "[", 
      RowBox[{
       RowBox[{"k1", " ", 
        RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
       RowBox[{"k1", " ", 
        RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
       RowBox[{"k2", " ", 
        RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], 
     "\[IndentingNewLine]", "and", " ", "the", " ", "PRPA", " ", "and", " ", 
     "PRPAP", " ", "are", " ", "all", " ", "of", " ", "the", " ", "form", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PRPA", "[", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
          RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "]"}], ".", 
      "\[IndentingNewLine]", "In"}], " ", "order", " ", "to", " ", "ease", 
     " ", "the", " ", "simplification", " ", "of", " ", "the", " ", 
     "expression"}], ",", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "want", " ", "to", " ", "make", " ", "sure", " ", "that", " ",
       "the", " ", "resonance", " ", "condition", " ", "always", " ", 
      "remains", " ", "under", " ", "the", " ", "exact", " ", "same", " ", 
      RowBox[{"form", ".", "\[IndentingNewLine]", "The"}], " ", "only", " ", 
      "symmetrisation", " ", "that", " ", "keeps", " ", "this", " ", 
      "resonance", " ", "condition", " ", "unchanged", " ", "is", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "J1", ",", "k2", ",", "J2"}], "}"}]}], "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k2", ",", "J2", ",", "k1", ",", "J1"}], "}"}], ".", 
       "\[IndentingNewLine]", "As"}], " ", "previously"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "we", " ", "try", " ", "to", " ", "reduce", " ", "the", " ", "number", 
      " ", "of", " ", "types", " ", "of", " ", "3"}], "-", 
     RowBox[{
     "body", " ", "integrals", " ", "by", " ", "performing", " ", "this", " ",
       "symmetrisation"}]}], ",", " ", 
    RowBox[{"if", " ", 
     RowBox[{"useful", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Generic", " ", "function", " ", "that", " ", "returns", " ", "the", " ", 
     "list", " ", "of", " ", "all", " ", "the", " ", "nice", " ", "INT", " ", 
     "that", " ", "are", " ", 
     RowBox[{"present", ".", "\[IndentingNewLine]", "There"}], " ", "is", " ",
      "no", " ", "need", " ", "to", " ", "be", " ", "cautious", " ", "with", 
     " ", "the", " ", "summand", " ", "of", " ", "SUM", " ", "outside", " ", 
     "of", " ", "the", " ", "integral", " ", "as", " ", "it", " ", "does", 
     " ", "not", " ", "contain", " ", "any", " ", "UPotk", " ", "nor", " ", 
     RowBox[{"Abs", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
    RowBox[{
    "we", " ", "only", " ", "return", " ", "the", " ", "integrand", " ", "of",
      " ", 
     RowBox[{"INT", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NiceINTLIST", "[", "expinit_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"expinit", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"HoldPattern", "@", 
                RowBox[{"INT", "[", " ", 
                 RowBox[{"A_", ",", 
                  RowBox[{"{", 
                   RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], 
               "\[RuleDelayed]", 
               RowBox[{"Sow", "[", "A", "]"}]}], "}"}]}], ")"}], "//", 
           "Reap"}], "//", "Last"}], "//", "Last"}], "//", "Counts"}], "//", 
       "Normal"}], "//", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "try", " ", "to", " ", "perform", " ", 
      "symmetrisations", " ", "to", " ", "reduce", " ", "the", " ", "types", 
      " ", "of", " ", 
      RowBox[{"term", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "here", " ", "there", " ", "is", " ", "no", " ", "need", " ", "to", " ",
        "provide", " ", "the", " ", "rule", " ", "to", " ", "use", " ", "as", 
       " ", "the", " ", "only", " ", "legitimate", " ", "symmetrisation", " ",
        "is", " ", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "J1", ",", "k2", ",", "J2"}], "}"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k2", ",", "J2", ",", "k1", ",", "J1"}], "}"}], "."}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NiceINTSym", "[", 
      RowBox[{"expinit_", ",", "INTnice_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "exp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Applying", " ", "the", " ", 
         RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"expinit", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"HoldPattern", "@", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xSUM_:", "1"}], ")"}], " ", 
                RowBox[{"INT", "[", 
                 RowBox[{"INTnice", ",", 
                  RowBox[{"{", 
                   RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
            RowBox[{"SUM", "[", 
             RowBox[{
              RowBox[{"INT", "[", 
               RowBox[{
                RowBox[{"ReplaceVariables", "[", 
                 RowBox[{
                  RowBox[{"xSUM", " ", "INTnice"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k1", ",", "J1", ",", "k2", ",", "J2"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"k2", ",", "J2", ",", "k1", ",", "J1"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "When", " ", "performing", " ", "the", " ", "symmetrisation"}], ",",
           " ", 
          RowBox[{"we", " ", "have", " ", "created", " ", "some", " ", 
           RowBox[{"PRPA", "[", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}], 
            "]"}], " ", "and", " ", 
           RowBox[{
            RowBox[{"PRPAP", "[", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}], 
             "]"}], ".", "\[IndentingNewLine]", "We"}], " ", "use", " ", 
           "the", " ", "presence", " ", "of", " ", "the", " ", "resonant", 
           " ", "DIRAC", " ", "to", " ", "get", " ", "them", " ", 
           RowBox[{"away", ".", "\[IndentingNewLine]", "We"}], " ", "also", 
           " ", "apply", " ", "the", " ", "rule", " ", "to", " ", "get", " ", 
           "rid", " ", "of", " ", "the", " ", 
           RowBox[{"scalings", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
          ",", " ", 
          RowBox[{
          "here", " ", "we", " ", "use", " ", "the", " ", "CORRRECT", " ", 
           "rule", " ", "for", " ", "the", " ", "scaling", " ", "of", " ", 
           "the", " ", "PRPA", " ", "and", " ", 
           RowBox[{"derivatives", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"RepeatedRules", "[", 
          RowBox[{"exp", ",", 
           RowBox[{"RulesDIRACSub", "~", "Join", "~", "RulesScaling"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "performs", " ", "the", 
      " ", "symmetrisation", " ", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "J1", ",", "k2", ",", "J2"}], "}"}]}], "\[Rule]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k2", ",", "J2", ",", "k1", ",", "J1"}], "}"}], " ", "over", 
      " ", "all", " ", "the", " ", "available", " ", 
      RowBox[{"integrals", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NiceINTSymFULL", "[", "expinit_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"listINT", ",", "rule", ",", "exp"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{
         "we", " ", "get", " ", "the", " ", "list", " ", "of", " ", "the", 
          " ", "Nice", " ", "integrals", " ", "that", " ", "are", " ", 
          RowBox[{"present", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"listINT", " ", "=", " ", 
         RowBox[{"expinit", "//", "NiceINTLIST"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "create", " ", "a", " ", "list", " ", "that", " ", 
          "performs", " ", "a", " ", "symmetrisation", " ", "for", " ", "all",
           " ", "the", " ", "integrals", " ", 
          RowBox[{"present", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"rule", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"HoldPattern", "@", 
             RowBox[{"SUM", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xSUM_:", "1"}], ")"}], " ", 
                RowBox[{"INT", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
            RowBox[{"SUM", "[", 
             RowBox[{
              RowBox[{"INT", "[", 
               RowBox[{
                RowBox[{"ReplaceVariables", "[", 
                 RowBox[{
                  RowBox[{"xSUM", " ", "#"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k1", ",", "J1", ",", "k2", ",", "J2"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"k2", ",", "J2", ",", "k1", ",", "J1"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], "&"}], "/@", 
          "listINT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Applying", " ", "the", " ", 
           RowBox[{"rule", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
          " ", 
          RowBox[{
          "we", " ", "apply", " ", "the", " ", "rule", " ", "only", " ", 
           RowBox[{"once", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"expinit", "/.", "rule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "When", " ", "performing", " ", "the", " ", "symmetrisation"}], ",",
           " ", 
          RowBox[{"we", " ", "have", " ", "created", " ", "some", " ", 
           RowBox[{"PRPA", "[", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}], 
            "]"}], " ", "and", " ", 
           RowBox[{
            RowBox[{"PRPAP", "[", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}], 
             "]"}], ".", "\[IndentingNewLine]", "We"}], " ", "use", " ", 
           "the", " ", "presence", " ", "of", " ", "the", " ", "resonant", 
           " ", "DIRAC", " ", "to", " ", "get", " ", "them", " ", 
           RowBox[{"away", ".", "\[IndentingNewLine]", "We"}], " ", "also", 
           " ", "apply", " ", "the", " ", "rule", " ", "to", " ", "get", " ", 
           "rid", " ", "of", " ", "the", " ", 
           RowBox[{"scalings", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
          ",", " ", 
          RowBox[{
          "here", " ", "we", " ", "use", " ", "the", " ", "CORRRECT", " ", 
           "rule", " ", "for", " ", "the", " ", "scaling", " ", "of", " ", 
           "the", " ", "PRPA", " ", "and", " ", 
           RowBox[{"derivatives", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"RepeatedRules", "[", 
          RowBox[{"exp", ",", 
           RowBox[{"RulesDIRACSub", "~", "Join", "~", "RulesScaling"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "define", " ", "a", " ", "scaling", " ", "rule", " ", "for", 
      " ", "the", " ", "PRPA"}], ",", " ", "PRPAP", ",", " ", 
     RowBox[{
     "and", " ", "PRPAPP", " ", "such", " ", "that", " ", "the", " ", 
      "prefactors", " ", "in", " ", "k", " ", "are", " ", "not", " ", 
      RowBox[{"kept", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "this", " ", "rule", " ", "should", " ", "ONLY", " ", "be", " ", "used", 
      " ", "to", " ", "simplify", " ", "the", " ", "shape", " ", "of", " ", 
      "the", " ", "nice", " ", 
      RowBox[{"INT", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{"it", " ", "it", " ", "not", " ", "correct", " ", "per", " ", 
      RowBox[{"se", ":", " ", 
       RowBox[{
       "it", " ", "is", " ", "only", " ", "useful", " ", "to", " ", "reduce", 
        " ", "the", " ", "number", " ", "of", " ", 
        RowBox[{"terms", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesPRPANice", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], " ", 
         RowBox[{
          RowBox[{"PRPA", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}], "]"}], "^", 
          RowBox[{"(", "n_.", ")"}]}]}], ":>", 
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], " ", 
         RowBox[{
          RowBox[{"PRPA", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}], "]"}], "^", 
          RowBox[{"(", "n", ")"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], " ", 
         RowBox[{
          RowBox[{"PRPAP", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}], "]"}], "^", 
          RowBox[{"(", "n_.", ")"}]}]}], ":>", 
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], " ", 
         RowBox[{
          RowBox[{"PRPAP", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}], "]"}], "^", 
          RowBox[{"(", "n", ")"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], " ", 
         RowBox[{
          RowBox[{"PRPAPP", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}], "]"}], "^", 
          RowBox[{"(", "n_.", ")"}]}]}], ":>", 
        RowBox[{
         RowBox[{"DIRAC", "[", 
          RowBox[{
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
           RowBox[{"k1", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
           RowBox[{"k2", " ", 
            RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], " ", 
         RowBox[{
          RowBox[{"PRPAPP", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}]}], "]"}], "^", 
          RowBox[{"(", "n", ")"}]}]}]}]}], "\[IndentingNewLine]", "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generic", " ", "function", " ", "that", " ", "takes", " ", "an", " ", 
     "initial", " ", "expression", " ", "and", " ", "performs", " ", "a", " ",
      "symmetrisation", " ", "of", " ", "the", " ", "nice", " ", "integrals", 
     " ", "to", " ", "try", " ", "and", " ", "reduce", " ", "their", " ", 
     RowBox[{"number", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReduceNiceINT", "[", "expinit_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "exp", ",", "listNICE", ",", "listNICEsym", ",", "listNonTrivial", 
         ",", "listNICEinter", ",", "intinter", ",", "ind", ",", "int"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{"we", " ", "copy", " ", "the", " ", "initial", " ", 
          RowBox[{"expression", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", "expinit"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "determine", " ", "the", " ", "initial", " ", "list", " ",
           "of", " ", "nice", " ", 
          RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNICE", " ", "=", " ", 
         RowBox[{"NiceINTLIST", "[", "exp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "consider", " ", "the", " ", "symmetrised", " ", 
          "version", " ", "of", " ", "the", " ", "nice", " ", 
          RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNICEsym", " ", "=", " ", 
         RowBox[{"ReplaceVariables", "[", 
          RowBox[{"listNICE", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "J1", ",", "k2", ",", "J2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k2", ",", "J2", ",", "k1", ",", "J1"}], "}"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "also", " ", "get", " ", "rid", " ", "of", " ", "the", 
           " ", 
           RowBox[{"PRPA", "[", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}], 
            "]"}], " ", "and", " ", 
           RowBox[{
            RowBox[{"PRPAP", "[", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], ")"}]}], 
             "]"}], ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
          RowBox[{"when", " ", "making", " ", "this", " ", "replacement"}], 
          ",", " ", 
          RowBox[{
          "we", " ", "do", " ", "not", " ", "care", " ", "about", " ", "the", 
           " ", 
           RowBox[{"scaling", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNICEsym", " ", "=", " ", 
         RowBox[{"RepeatedRules", "[", 
          RowBox[{"listNICEsym", ",", "RulesPRPANice"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "limit", " ", "ourselves", " ", "only", " ", "to", " ", 
          "nice", " ", "integrals", " ", "that", " ", "change", " ", "upon", 
          " ", 
          RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNonTrivial", " ", "=", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"UnsameQ", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"listNICE", ",", "listNICEsym"}], "}"}], "//", 
            "Transpose"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"listNonTrivial", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"listNonTrivial", ",", "True"}], "]"}], "//", 
          RowBox[{
           RowBox[{"First", "/@", "#"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Restricting", " ", "ourselves", " ", "to", " ", "the", " ", 
          "elements", " ", "that", " ", "differ", " ", "from", " ", "two", 
          " ", 
          RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNICE", " ", "=", " ", 
         RowBox[{"listNICE", "[", 
          RowBox[{"[", "listNonTrivial", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"listNICEsym", " ", "=", " ", 
         RowBox[{"listNICEsym", "[", 
          RowBox[{"[", "listNonTrivial", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Computing", " ", "the", " ", "intersection", " ", "of", " ", "the", 
          " ", "two", " ", 
          RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNICEinter", " ", "=", " ", 
         RowBox[{"Intersection", "[", 
          RowBox[{"listNICE", ",", "listNICEsym"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "As", " ", "long", " ", "as", " ", "there", " ", "is", " ", "some", 
           " ", "overlap", " ", "between", " ", "the", " ", "two", " ", 
           "lists"}], ",", " ", 
          RowBox[{
          "we", " ", "are", " ", "going", " ", "to", " ", "perform", " ", 
           RowBox[{"symmetrisations", "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"UnsameQ", "[", 
           RowBox[{"listNICEinter", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Nice", " ", "integral", " ", "that", " ", "can", " ", "be", " ", 
            RowBox[{"symmetrised", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"intinter", " ", "=", " ", 
            RowBox[{"listNICEinter", "//", "First"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "We", " ", "find", " ", "its", " ", "position", " ", "in", " ", 
             "the", " ", "symmetrised", " ", 
             RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ind", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"listNICEsym", ",", "intinter"}], "]"}], "//", 
              "First"}], "//", "First"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "The", " ", "integral", " ", "to", " ", "symmetrise", " ", "is", 
              " ", "then", " ", "the", " ", "following", " ", 
              RowBox[{"one", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",",
              " ", 
             RowBox[{
             "it", " ", "is", " ", "important", " ", "to", " ", "proceed", 
              " ", "in", " ", "that", " ", "order", " ", "to", " ", "prevent",
               " ", "falling", " ", "into", " ", "infinite", " ", "loops", 
              " ", "of", " ", 
              RowBox[{"replacements", "."}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"int", " ", "=", " ", 
            RowBox[{"listNICE", "[", 
             RowBox[{"[", "ind", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Performing", " ", "the", " ", 
             RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"exp", " ", "=", " ", 
            RowBox[{"NiceINTSym", "[", 
             RowBox[{"exp", ",", "int"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Determining", " ", "the", " ", "new", " ", "list", " ", "of", 
              " ", "nice", " ", 
              RowBox[{
              "integrals", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
             " ", 
             RowBox[{
             "we", " ", "limit", " ", "ourselves", " ", "only", " ", "to", 
              " ", "nice", " ", "integrals", " ", "that", " ", "change", " ", 
              "upon", " ", 
              RowBox[{"symmetrisation", "."}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"listNICE", " ", "=", " ", 
            RowBox[{"NiceINTLIST", "[", "exp", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "We", " ", "consider", " ", "the", " ", "symmetrised", " ", 
             "version", " ", "of", " ", "the", " ", "nice", " ", 
             RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"listNICEsym", " ", "=", " ", 
            RowBox[{"ReplaceVariables", "[", 
             RowBox[{"listNICE", ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", "J1", ",", "k2", ",", "J2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k2", ",", "J2", ",", "k1", ",", "J1"}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "We", " ", "also", " ", "get", " ", "rid", " ", "of", " ", "the",
               " ", 
              RowBox[{"PRPA", "[", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], 
                 ")"}]}], "]"}], " ", "and", " ", 
              RowBox[{
               RowBox[{"PRPAP", "[", 
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"\[CapitalOmega]", "-", "\[CapitalOmega]2"}], 
                  ")"}]}], "]"}], ".", "\[IndentingNewLine]", "ATTENTION"}]}],
              ",", " ", 
             RowBox[{"when", " ", "making", " ", "this", " ", "replacement"}],
              ",", " ", 
             RowBox[{
             "we", " ", "do", " ", "not", " ", "care", " ", "about", " ", 
              "the", " ", "scaling"}], ",", " ", 
             RowBox[{
              RowBox[{"i", ".", "e", ".", " ", "we"}], " ", "use", " ", "an", 
              " ", "incorrect", " ", "expression", " ", "per", " ", 
              RowBox[{"se", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"listNICEsym", " ", "=", " ", 
            RowBox[{"RepeatedRules", "[", 
             RowBox[{"listNICEsym", ",", "RulesPRPANice"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "We", " ", "limit", " ", "ourselves", " ", "only", " ", "to", " ",
              "nice", " ", "integrals", " ", "that", " ", "change", " ", 
             "upon", " ", 
             RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"listNonTrivial", " ", "=", "  ", 
            RowBox[{
             RowBox[{
              RowBox[{"UnsameQ", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"listNICE", ",", "listNICEsym"}], "}"}], "//", 
               "Transpose"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"listNonTrivial", " ", "=", " ", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"listNonTrivial", ",", "True"}], "]"}], "//", 
             RowBox[{
              RowBox[{"First", "/@", "#"}], "&"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Restricting", " ", "ourselves", " ", "to", " ", "the", " ", 
             "elements", " ", "that", " ", "differ", " ", "from", " ", "two", 
             " ", 
             RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"listNICE", " ", "=", " ", 
            RowBox[{"listNICE", "[", 
             RowBox[{"[", "listNonTrivial", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"listNICEsym", " ", "=", " ", 
            RowBox[{"listNICEsym", "[", 
             RowBox[{"[", "listNonTrivial", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Updating", " ", "the", " ", "intersection", " ", "of", " ", 
             "the", " ", "two", " ", 
             RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"listNICEinter", " ", "=", " ", 
            RowBox[{"Intersection", "[", 
             RowBox[{"listNICE", ",", "listNICEsym"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", ",", " ", 
     RowBox[{
     "we", " ", "reduce", " ", "the", " ", "number", " ", "of", " ", "nasty", 
      " ", "integrals", " ", "that", " ", "are", " ", 
      RowBox[{"present", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Initial nb. of types of nice INT | \>\"", ",", 
      RowBox[{
       RowBox[{"NiceINTLIST", "[", "integranddFdt", "]"}], "//", "Length"}]}],
      "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Performing", " ", "symmetrisations", " ", "of", " ", "the", " ", "nasty",
      " ", 
     RowBox[{"sums", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNiceINT", "[", "integranddFdt", "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Getting", " ", "the", " ", "final", " ", "number", " ", "of", " ", 
     "nasty", " ", "integrals", " ", 
     RowBox[{"present", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Final nb. of types of nice INT | \>\"", ",", 
      RowBox[{
       RowBox[{"NiceINTLIST", "[", "integranddFdt", "]"}], "//", "Length"}]}],
      "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "takes", " ", "as", " ", 
      "an", " ", "argument", " ", "a", " ", "nice", " ", "integral", " ", 
      RowBox[{"INT", "[", 
       RowBox[{",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "isolates", " ", "it", " ", "in", " ", "exp", " ", "the", " ", "terms", 
      " ", "that", " ", "involve", " ", "this", " ", "integral"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "and", " ", "tries", " ", "to", " ", "perform", " ", "some", " ", 
      "simplifications", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"without", " ", "using", " ", "any", " ", "rules"}], ")"}], 
       ".", "\[IndentingNewLine]", "This"}], " ", "function", " ", "returns", 
      " ", "True", " ", "if"}], ",", " ", 
     RowBox[{"after", " ", "simplification"}], ",", " ", 
     RowBox[{
     "these", " ", "integrals", " ", "give", " ", "a", " ", "vanishing", " ", 
      
      RowBox[{"contribution", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NiceINTQ", "[", 
      RowBox[{"expinit_", ",", "INTnice_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"LISTexp", ",", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{
         "we", " ", "transform", " ", "exp", " ", "into", " ", "a", " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LISTexp", " ", "=", " ", 
         RowBox[{"List", "@@", 
          RowBox[{"(", 
           RowBox[{"expinit", "//", "Expand"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "select", " ", "the", " ", "elements", " ", "that", " ", 
           "involve", " ", "the", " ", 
           RowBox[{"integral", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
          ",", " ", 
          RowBox[{
          "we", " ", "must", " ", "rewrap", " ", "INTnice", " ", "within", 
           " ", "a", " ", 
           RowBox[{
            RowBox[{"INT", "[", 
             RowBox[{",", 
              RowBox[{"{", 
               RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"LISTexp", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"#", ",", 
               RowBox[{"INT", "[", 
                RowBox[{"INTnice", ",", 
                 RowBox[{"{", 
                  RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Putting", " ", "back", " ", "as", " ", "a", " ", "sum", " ", "of", 
          " ", 
          RowBox[{"terms", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"Plus", "@@", "exp"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "now", " ", "try", " ", "to", " ", "simplify", " ", "the",
           " ", "resulting", " ", 
          RowBox[{"expression", ".", "\[IndentingNewLine]", "We"}], " ", 
          "temporarily", " ", "remove", " ", "the", " ", "SUM", " ", "to", 
          " ", "let", " ", "Mathematica", " ", "simplify"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"exp", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SUM", "[", 
             RowBox[{"xSUM_", ",", "varSUM_"}], "]"}], "\[RuleDelayed]", 
            "xSUM"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Simplifying", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"exp", "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determining", " ", "if", " ", "the", " ", "result", " ", 
          RowBox[{"vanishes", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"SameQ", "[", 
          RowBox[{"exp", ",", "0"}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "removes", " ", "all", " ",
       "the", " ", "contributions", " ", "from", " ", "a", " ", "NiceINT"}], 
     ",", " ", 
     RowBox[{
     "which", " ", "we", " ", "just", " ", "check", " ", "gives", " ", "a", 
      " ", "vanishing", " ", 
      RowBox[{"contribution", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NiceINTRemove", "[", 
      RowBox[{"expinit_", ",", "INTnice_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "exp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Replacing", " ", "the", " ", "integrals", " ", "by", " ", "0.", "*",
           "\[IndentingNewLine]", "ATTENTION"}], ",", " ", 
         RowBox[{
         "we", " ", "must", " ", "rewrap", " ", "INTnice", " ", "within", " ",
           "a", " ", 
          RowBox[{
           RowBox[{"INT", "[", 
            RowBox[{",", 
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "."}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"expinit", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"HoldPattern", "@", 
             RowBox[{"INT", "[", 
              RowBox[{"INTnice", ",", 
               RowBox[{"{", 
                RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]",
             "0"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generic", " ", "function", " ", "that", " ", "takes", " ", "an", " ", 
     "expression", " ", "and", " ", "removes", " ", "all", " ", "the", " ", 
     "nice", " ", "integrals", " ", "that", " ", 
     RowBox[{"vanish", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NiceINTWrapped", "[", "expinit_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "exp", ",", "listNiceINT", ",", "listNiceINTQ", ",", "listNiceINTind",
          ",", "listNiceINTvanish"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Copying", " ", "the", " ", "initial", " ", 
         RowBox[{"expressions", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", "expinit"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "List", " ", "of", " ", "all", " ", "the", " ", "nice", " ", 
          RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNiceINT", " ", "=", " ", 
         RowBox[{"NiceINTLIST", "[", "exp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"For", " ", "every", " ", "integral"}], ",", " ", 
          RowBox[{"we", " ", "try", " ", "to", " ", 
           RowBox[{"simplify", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNiceINTQ", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"NiceINTQ", "[", 
            RowBox[{"exp", ",", "#"}], "]"}], "&"}], "/@", "listNiceINT"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "find", " ", "the", " ", "index", " ", "of", " ", "all", 
          " ", "the", " ", "nice", " ", "integrals", " ", "that", " ", 
          RowBox[{"vanish", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNiceINTind", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"listNiceINTQ", ",", "True"}], "]"}], "//", 
          RowBox[{
           RowBox[{"First", "/@", "#"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "construct", " ", "the", " ", "list", " ", "of", " ", 
          "the", " ", "nice", " ", "integrals", " ", "that", " ", 
          RowBox[{"vanish", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNiceINTvanish", " ", "=", " ", 
         RowBox[{"listNiceINT", "[", 
          RowBox[{"[", "listNiceINTind", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", ",", " ", 
          RowBox[{
          "for", " ", "every", " ", "vanishing", " ", "nice", " ", 
           "integral"}], ",", " ", 
          RowBox[{
          "we", " ", "remove", " ", "it", " ", "from", " ", "the", " ", 
           RowBox[{"expressions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Initial nb. terms | \>\"", ",", 
          RowBox[{"exp", "//", "Length"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exp", " ", "=", " ", 
           RowBox[{"NiceINTRemove", "[", 
            RowBox[{"exp", ",", "INTNice"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"INTNice", ",", "listNiceINTvanish"}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Final nb. terms | \>\"", ",", 
          RowBox[{"exp", "//", "Length"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Removing", " ", "nice", " ", "INT", " ", "by", " ", 
     RowBox[{"simplification", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NiceINTWrapped", "[", "integranddFdt", "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Some", " ", "of", " ", "the", " ", "Nice", " ", "integrals", " ", 
       "are", " ", "left", " ", "unchanged", " ", "by", " ", "the", " ", 
       "symmetry", " ", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "J1", ",", "k2", ",", "J2"}], "}"}]}], "\[Rule]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k2", ",", "J2", ",", "k1", ",", "J1"}], "}"}], ".", 
       "\[IndentingNewLine]", "Yet"}]}], ",", " ", 
     RowBox[{
     "applying", " ", "this", " ", "symmetry", " ", "can", " ", "still", " ", 
      "be", " ", "useful", " ", "because", " ", "it", " ", "affects", " ", 
      "the", " ", "front", " ", "factors", " ", "in", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k1", ",", "k2"}], ")"}], ".", "\[IndentingNewLine]", "As"}], 
      " ", "a", " ", "consequence"}], ",", " ", 
     RowBox[{
     "we", " ", "scan", " ", "over", " ", "all", " ", "the", " ", "nice", " ",
       "integrals", " ", "and", " ", "take", " ", "the", " ", "average", " ", 
      "between", " ", "the", " ", "symmetrised", " ", 
      RowBox[{"expressions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generic", " ", "function", " ", "that", " ", "returns", " ", "True", " ",
      "if", " ", "ever", " ", "a", " ", "nice", " ", "integral", " ", "gives",
      " ", "a", " ", "vanishing", " ", "contribution", " ", "under", " ", 
     "the", " ", 
     RowBox[{"`mid", "'"}], " ", 
     RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NiceINTmidQ", "[", 
      RowBox[{"expinit_", ",", "INTnice_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"LISTexp", ",", "exp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", ",", " ", 
         RowBox[{
         "we", " ", "transform", " ", "exp", " ", "into", " ", "a", " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LISTexp", " ", "=", " ", 
         RowBox[{"List", "@@", 
          RowBox[{"(", 
           RowBox[{"expinit", "//", "Expand"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "select", " ", "the", " ", "elements", " ", "that", " ", 
           "involve", " ", "the", " ", 
           RowBox[{"integral", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
          ",", " ", 
          RowBox[{
          "we", " ", "must", " ", "rewrap", " ", "INTnice", " ", "within", 
           " ", "a", " ", 
           RowBox[{
            RowBox[{"INT", "[", 
             RowBox[{",", 
              RowBox[{"{", 
               RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"LISTexp", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"#", ",", 
               RowBox[{"INT", "[", 
                RowBox[{"INTnice", ",", 
                 RowBox[{"{", 
                  RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Putting", " ", "back", " ", "as", " ", "a", " ", "sum", " ", "of", 
          " ", 
          RowBox[{"terms", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"Plus", "@@", "exp"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "We", " ", "now", " ", "perform", " ", "the", " ", "mid", " ", 
           RowBox[{
           "symmetrisation", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",",
           " ", 
          RowBox[{
          "not", " ", "to", " ", "forget", " ", "the", " ", "factor", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"exp", " ", "+", " ", 
            RowBox[{"NiceINTSym", "[", 
             RowBox[{"exp", ",", "INTnice"}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"We", " ", 
          RowBox[{"expand", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"exp", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "now", " ", "try", " ", "to", " ", "simplify", " ", "the",
           " ", "resulting", " ", 
          RowBox[{"expression", ".", "\[IndentingNewLine]", "We"}], " ", 
          "temporarily", " ", "remove", " ", "the", " ", "SUM", " ", "to", 
          " ", "let", " ", "MMA", " ", "simplify"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"exp", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SUM", "[", 
             RowBox[{"xSUM_", ",", "varSUM_"}], "]"}], "\[RuleDelayed]", 
            "xSUM"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Simplifying", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"exp", " ", "=", " ", 
         RowBox[{"exp", "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determining", " ", "if", " ", "the", " ", "result", " ", 
          RowBox[{"vanishes", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"SameQ", "[", 
          RowBox[{"exp", ",", "0"}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "takes", " ", "an", " ", 
      "expression", " ", "and", " ", "removes", " ", "all", " ", "the", " ", 
      "nice", " ", "integrals", " ", "that", " ", "vanish", " ", "under", " ",
       "the", " ", 
      RowBox[{"`mid", "'"}], " ", "symmetrisation"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "average", " ", "of", 
      " ", "an", " ", "expression", " ", "and", " ", "its", " ", 
      RowBox[{"symmetric", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NiceINTmidWrapped", "[", "expinit_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "exp", ",", "listNiceINT", ",", "listNiceINTQ", ",", "listNiceINTind",
          ",", "listNiceINTvanish"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Copying", " ", "the", " ", "initial", " ", 
         RowBox[{"expression", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"exp", " ", "=", " ", "expinit"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "List", " ", "of", " ", "all", " ", "the", " ", "nice", " ", 
          RowBox[{"expressions", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNiceINT", " ", "=", " ", 
         RowBox[{"NiceINTLIST", "[", "exp", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"For", " ", "every", " ", "integral"}], ",", " ", 
          RowBox[{"we", " ", "try", " ", "to", " ", 
           RowBox[{"simplify", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNiceINTQ", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"NiceINTmidQ", "[", 
            RowBox[{"exp", ",", "#"}], "]"}], "&"}], "/@", "listNiceINT"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "find", " ", "the", " ", "index", " ", "of", " ", "all", 
          " ", "the", " ", "nice", " ", "integrals", " ", "that", " ", 
          RowBox[{"vanish", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNiceINTind", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"listNiceINTQ", ",", "True"}], "]"}], "//", 
          RowBox[{
           RowBox[{"First", "/@", "#"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "construct", " ", "the", " ", "list", " ", "of", " ", 
          "the", " ", "nice", " ", "integrals", " ", "that", " ", 
          RowBox[{"vanish", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listNiceINTvanish", " ", "=", " ", 
         RowBox[{"listNiceINT", "[", 
          RowBox[{"[", "listNiceINTind", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", ",", " ", 
          RowBox[{
          "for", " ", "every", " ", "vanishing", " ", "nice", " ", 
           "integral"}], ",", " ", 
          RowBox[{
          "we", " ", "remove", " ", "it", " ", "from", " ", "the", " ", 
           RowBox[{"expressions", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Initial nb. terms | \>\"", ",", 
          RowBox[{"exp", "//", "Length"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"exp", " ", "=", " ", 
           RowBox[{"NiceINTRemove", "[", 
            RowBox[{"exp", ",", "INTNice"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"INTNice", ",", "listNiceINTvanish"}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Final nb. terms | \>\"", ",", 
          RowBox[{"exp", "//", "Length"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Removing", " ", "terms", " ", "by", " ", "the", " ", "simple", " ", 
     RowBox[{"`mid", "'"}], " ", 
     RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"NiceINTmidWrapped", "[", "integranddFdt", "]"}]}], ";"}], "//",
     "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "We", " ", "expect", " ", "that", " ", "the", " ", "final", " ", 
       "kinetic", " ", "equation", " ", "will", " ", "only", " ", "involve", 
       " ", "first"}], "-", 
      RowBox[{"order", " ", 
       RowBox[{"derivatives", ".", "\[IndentingNewLine]", "As"}], " ", "a", 
       " ", "consequence"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "perform", " ", "integration", " ", "by", " ", "parts", " ", 
       "so", " ", "as", " ", "not", " ", "to", " ", "have", " ", "any", " ", 
       RowBox[{"FPP", "[", "J1", "]"}], " ", 
       RowBox[{"appearing", ".", "\[IndentingNewLine]", "We"}], " ", "have", 
       " ", 
       RowBox[{"FPP", "[", "J1", "]"}]}], "=", 
      RowBox[{"d", "/", 
       RowBox[{"dJ1", "[", 
        RowBox[{"FP", "[", "J1", "]"}], "]"}]}]}], ",", " ", 
     RowBox[{
     "hence", " ", "we", " ", "need", " ", "a", " ", "negative", " ", "sign", 
      " ", "in", " ", "the", " ", "integration", " ", "by", " ", 
      RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartFPP", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{"xINT_", " ", 
          RowBox[{"FPP", "[", "J1", "]"}]}], ",", "varINT_"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"INT", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DER", "[", 
             RowBox[{"xINT", " ", ",", "J1"}], "]"}], " ", 
            RowBox[{"FP", "[", "J1", "]"}]}], ",", "varINT"}], "]"}]}], "/;", 
        
        RowBox[{"(", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"varINT", ",", "J1"}], "]"}], ")"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", "rule", " ", 
      RowBox[{"once", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "for", " ", "safety", " ", "we", " ", "do", " ", "not", " ", "use", " ", 
      
      RowBox[{"RepeatedRules", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", 
     RowBox[{"integranddFdt", "/.", "RulePartFPP"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "compute", " ", "explicitly", " ", "all", " ", "the", " ", 
     "DER", " ", "that", " ", "have", " ", 
     RowBox[{"appeared", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "perform", " ", "an", " ", "integration", " ", 
      "by", " ", "parts", " ", "of", " ", "all", " ", "the", " ", "DIRACP", 
      " ", "that", " ", "have", " ", 
      RowBox[{"appeared", ".", "\[IndentingNewLine]", "Naturally"}]}], ",", 
     " ", 
     RowBox[{
     "we", " ", "perform", " ", "this", " ", "integration", " ", "by", " ", 
      "parts", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", "J2"}]}], ",", " ", 
     RowBox[{
     "because", " ", "we", " ", "do", " ", "not", " ", "want", " ", "to", " ",
       "create", " ", "back", " ", "the", " ", 
      RowBox[{"FPP", "[", "J1", "]"}], " ", "we", " ", "just", " ", "got", 
      " ", "rid", " ", 
      RowBox[{"from", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"RulePartDIRACP", "[", 
         RowBox[{"{", "FP", "}"}], "]"}]}], "]"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Making", " ", "sure", " ", "that", " ", "the", " ", "product", " ", 
     "PRPA", "\[Times]", "PRPAPP", " ", "are", " ", 
     RowBox[{"simplified", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RuleIdentifyPRPAPRPAPP"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "When", " ", "performing", " ", "the", " ", "integration", " ", "by", 
      " ", "parts"}], ",", " ", 
     RowBox[{
     "we", " ", "have", " ", "created", " ", "some", " ", "new", " ", 
      "UPotkP1"}], ",", 
     RowBox[{
     "...", "\[IndentingNewLine]", "As", " ", "a", " ", "consequence"}], ",", 
     " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "make", " ", "sure", " ", "that", " ",
       "we", " ", "reduce"}], ",", " ", 
     RowBox[{"once", " ", "again"}], ",", " ", 
     RowBox[{
     "as", " ", "much", " ", "as", " ", "possible", " ", "the", " ", "type", 
      " ", "of", " ", "integrals", " ", "that", " ", "are", " ", 
      RowBox[{"present", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNiceINT", "[", "integranddFdt", "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "further", " ", "reduce", " ", "the", " ", "number", " ", "of",
      " ", "terms", " ", "by", " ", "trying", " ", "to", " ", "simplify", " ",
      "the", " ", "nice", " ", 
     RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"NiceINTWrapped", "[", "integranddFdt", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "continue", " ", "reducing", " ", 
      "the", " ", "number", " ", "of", " ", "type", " ", "of", " ", "INT", 
      " ", "that", " ", "are", " ", "present"}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "now", " ", "try", " ", "to", " ", "make", " ", "it", " ", 
       "so", " ", "that", " ", "no", " ", "second"}], "-", 
      RowBox[{
      "order", " ", "derivatives", " ", "of", " ", "the", " ", "interaction", 
       " ", "potential", " ", "are", " ", 
       RowBox[{"present", ".", "\[IndentingNewLine]", "We"}], " ", "start", 
       " ", "with", " ", "the", " ", "occurrences", " ", "of", " ", 
       RowBox[{
        RowBox[{"UPotkP1P1", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "."}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartUPotkP1P1", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "have", " ", 
          RowBox[{"UPotkP1P1", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "=", 
         RowBox[{"d", "/", 
          RowBox[{"dJ1", "[", 
           RowBox[{"UPotkP1", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "]"}]}]}], ",", " ", 
        
        RowBox[{
        "hence", " ", "we", " ", "need", " ", "a", " ", "negative", " ", 
         "sign", " ", "in", " ", "the", " ", "integration", " ", "by", " ", 
         RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{"UPotkP1P1", "[", 
            RowBox[{"k_", ",", 
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"-", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DER", "[", 
            RowBox[{"xINT", ",", "J1"}], "]"}], " ", 
           RowBox[{"UPotkP1", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", "rule", " ", 
      RowBox[{"once", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "for", " ", "safety", " ", "we", " ", "do", " ", "not", " ", "use", " ", 
      
      RowBox[{"RepeatedRules", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", 
     RowBox[{"integranddFdt", "/.", "RulePartUPotkP1P1"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "compute", " ", "explicitly", " ", "all", " ", "the", " ", 
     "DER", " ", "that", " ", "have", " ", 
     RowBox[{"appeared", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "perform", " ", "an", " ", "integration", " ", 
      "by", " ", "parts", " ", "of", " ", "all", " ", "the", " ", "DIRACP", 
      " ", "that", " ", "have", " ", 
      RowBox[{"appeared", ".", "\[IndentingNewLine]", "Naturally"}]}], ",", 
     " ", 
     RowBox[{
     "we", " ", "perform", " ", "this", " ", "integration", " ", "by", " ", 
      "parts", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", "J2"}]}], ",", " ", 
     RowBox[{
     "because", " ", "we", " ", "do", " ", "not", " ", "want", " ", "to", " ",
       "create", " ", "back", " ", "the", " ", 
      RowBox[{"UPotkP1P1", "[", "]"}]}], ",", " ", 
     RowBox[{"we", " ", "just", " ", "got", " ", "rid", " ", 
      RowBox[{"from", ".", "\[IndentingNewLine]", "In"}], " ", "order", " ", 
      "to", " ", "make", " ", "sure", " ", "that", " ", "the", " ", 
      "function", " ", "selects", " ", "J2", " ", "as", " ", "the", " ", 
      "integration", " ", "variable"}], ",", " ", 
     RowBox[{"we", " ", "make", " ", "sure", " ", "that", " ", 
      RowBox[{"F", "[", "J1", "]"}], " ", "and", " ", "its", " ", 
      "derivatives", " ", "are", " ", "not", " ", 
      RowBox[{"selected", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"RulePartDIRACP", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"F", "[", "J1", "]"}], ",", 
           RowBox[{"FP", "[", "J1", "]"}], ",", 
           RowBox[{"FPP", "[", "J1", "]"}]}], "}"}], "]"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Making", " ", "sure", " ", "that", " ", "the", " ", "product", " ", 
     "PRPA", "\[Times]", "PRPAPP", " ", "are", " ", 
     RowBox[{"simplified", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RuleIdentifyPRPAPRPAPP"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "When", " ", "performing", " ", "the", " ", "integration", " ", "by", 
      " ", "parts"}], ",", " ", 
     RowBox[{
     "we", " ", "have", " ", "created", " ", "some", " ", "new", " ", 
      "UPotkP1"}], ",", 
     RowBox[{
     "...", "\[IndentingNewLine]", "As", " ", "a", " ", "consequence"}], ",", 
     " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "make", " ", "sure", " ", "that", " ",
       "we", " ", "reduce"}], ",", " ", 
     RowBox[{"once", " ", "again"}], ",", " ", 
     RowBox[{
     "as", " ", "much", " ", "as", " ", "possible", " ", "the", " ", "type", 
      " ", "of", " ", "integrals", " ", "that", " ", "are", " ", 
      RowBox[{"present", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNiceINT", "[", "integranddFdt", "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "further", " ", "reduce", " ", "the", " ", "number", " ", "of",
      " ", "terms", " ", "by", " ", "trying", " ", "to", " ", "simplify", " ",
      "the", " ", "nice", " ", 
     RowBox[{"integrals", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"NiceINTWrapped", "[", "integranddFdt", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "We", " ", "perform", " ", "an", " ", "integration", " ", "by", " ", 
         "part", " ", "of", " ", "the", " ", "UPotkP2P2", " ", "that", " ", 
         "are", " ", 
         RowBox[{"present", ".", " ", "Our"}], " ", "goal", " ", "is", " ", 
         "still", " ", "to", " ", "make", " ", "it", " ", "so", " ", "that", 
         " ", "no", " ", "second"}], "-", 
        RowBox[{
        "order", " ", "derivatives", " ", "of", " ", "the", " ", 
         "interaction", " ", "potential", " ", 
         RowBox[{"appear", ".", "\[IndentingNewLine]", "At"}], " ", "this", 
         " ", "stage"}]}], ",", " ", 
       RowBox[{
       "we", " ", "face", " ", "three", " ", "sort", " ", "of", " ", 
        "UPotkP2P2", " ", "either", " ", 
        RowBox[{"UPotkP2P2", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}]}]}]}]}], "]"}], ",", " ", 
     RowBox[{"or", " ", 
      RowBox[{
       RowBox[{"UPotkP2P2", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], ".", 
       "\[IndentingNewLine]", "We"}], " ", "must", " ", "treat", " ", "each", 
      " ", "case", " ", "separately", " ", "because", " ", "we", " ", "need", 
      " ", "to", " ", "make", " ", "sure", " ", "we", " ", "fully", " ", 
      "know", " ", "which", " ", "integration", " ", "variable", " ", "is", 
      " ", "used", " ", "to", " ", "perform", " ", "the", " ", 
      RowBox[{"integration", ".", " ", "Indeed"}]}], ",", " ", 
     RowBox[{
     "if", " ", "we", " ", "use", " ", "J1", " ", "to", " ", "integrate", " ",
       "by", " ", "part", " ", "UPotkP2P2"}], ",", " ", 
     RowBox[{
     "then", " ", "we", " ", "must", " ", "use", " ", "J2", " ", "to", " ", 
      "integrate", " ", "by", " ", "parts", " ", "the", " ", "DIRACP", " ", 
      "that", " ", "gets", " ", 
      RowBox[{"created", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"++", 
     RowBox[{"++", 
      RowBox[{"++", 
       RowBox[{"++", 
        RowBox[{"++", 
         RowBox[{"++", 
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"++", 
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"++", "++"}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"++", 
     RowBox[{"++", 
      RowBox[{"++", 
       RowBox[{"++", 
        RowBox[{"++", 
         RowBox[{"++", 
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"++", 
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"++", "++"}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Integration", " ", "by", " ", "part", " ", "of", " ", 
     RowBox[{
      RowBox[{"UPotkP2P2", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartUPotkP2P2argJJ1", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "have", " ", 
          RowBox[{"UPotkP2P2", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], "=", 
         RowBox[{"d", "/", 
          RowBox[{"dJ1", "[", 
           RowBox[{"UPotkP2", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], "]"}]}]}], ",", " ", 
        RowBox[{
        "hence", " ", "we", " ", "need", " ", "a", " ", "negative", " ", 
         "sign", " ", "in", " ", "the", " ", "integration", " ", "by", " ", 
         RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{"UPotkP2P2", "[", 
            RowBox[{"k_", ",", 
             RowBox[{"{", 
              RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"-", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DER", "[", 
            RowBox[{"xINT", ",", "J1"}], "]"}], " ", 
           RowBox[{"UPotkP2", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", "rule"}], ",", " ", 
     RowBox[{"and", " ", "the", " ", "subsequent", " ", 
      RowBox[{"simplifications", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
     ",", " ", 
     RowBox[{
     "we", " ", "use", " ", "J2", " ", "to", " ", "perform", " ", "the", " ", 
      "integration", " ", "by", " ", "part", " ", "of", " ", "the", " ", 
      RowBox[{"DIRACP", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", 
     RowBox[{"integranddFdt", "/.", "RulePartUPotkP2P2argJJ1"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"RulePartDIRACP", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"F", "[", "J1", "]"}], ",", 
           RowBox[{"FP", "[", "J1", "]"}], ",", 
           RowBox[{"FPP", "[", "J1", "]"}]}], "}"}], "]"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RuleIdentifyPRPAPRPAPP"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNiceINT", "[", "integranddFdt", "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"NiceINTWrapped", "[", "integranddFdt", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"++", 
     RowBox[{"++", 
      RowBox[{"++", 
       RowBox[{"++", 
        RowBox[{"++", 
         RowBox[{"++", 
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"++", 
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"++", "++"}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"++", 
     RowBox[{"++", 
      RowBox[{"++", 
       RowBox[{"++", 
        RowBox[{"++", 
         RowBox[{"++", 
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"++", 
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"++", "++"}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Integration", " ", "by", " ", "part", " ", "of", " ", 
     RowBox[{
      RowBox[{"UPotkP2P2", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartUPotkP2P2argJJ2", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "have", " ", 
          RowBox[{"UPotkP2P2", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], "=", 
         RowBox[{"d", "/", 
          RowBox[{"dJ2", "[", 
           RowBox[{"UPotkP2", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], "]"}]}]}], ",", " ", 
        RowBox[{
        "hence", " ", "we", " ", "need", " ", "a", " ", "negative", " ", 
         "sign", " ", "in", " ", "the", " ", "integration", " ", "by", " ", 
         RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{"UPotkP2P2", "[", 
            RowBox[{"k_", ",", 
             RowBox[{"{", 
              RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"-", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DER", "[", 
            RowBox[{"xINT", ",", "J2"}], "]"}], " ", 
           RowBox[{"UPotkP2", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", "rule"}], ",", " ", 
     RowBox[{"and", " ", "the", " ", "subsequent", " ", 
      RowBox[{"simplifications", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
     ",", " ", 
     RowBox[{
     "we", " ", "use", " ", "J1", " ", "to", " ", "perform", " ", "the", " ", 
      "integration", " ", "by", " ", "part", " ", "of", " ", "the", " ", 
      RowBox[{"DIRACP", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", 
     RowBox[{"integranddFdt", "/.", "RulePartUPotkP2P2argJJ2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"RulePartDIRACP", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"F", "[", "J2", "]"}], ",", 
           RowBox[{"FP", "[", "J2", "]"}], ",", 
           RowBox[{"FPP", "[", "J2", "]"}]}], "}"}], "]"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RuleIdentifyPRPAPRPAPP"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNiceINT", "[", "integranddFdt", "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"NiceINTWrapped", "[", "integranddFdt", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"++", 
     RowBox[{"++", 
      RowBox[{"++", 
       RowBox[{"++", 
        RowBox[{"++", 
         RowBox[{"++", 
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"++", 
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"++", "++"}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"++", 
     RowBox[{"++", 
      RowBox[{"++", 
       RowBox[{"++", 
        RowBox[{"++", 
         RowBox[{"++", 
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"++", 
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"++", "++"}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Integration", " ", "by", " ", "part", " ", "of", " ", 
     RowBox[{
      RowBox[{"UPotkP2P2", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartUPotkP2P2argJ1J2", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "have", " ", 
          RowBox[{"UPotkP2P2", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "=", 
         RowBox[{"d", "/", 
          RowBox[{"dJ2", "[", 
           RowBox[{"UPotkP2", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "]"}]}]}], ",", " ", 
        
        RowBox[{
        "hence", " ", "we", " ", "need", " ", "a", " ", "negative", " ", 
         "sign", " ", "in", " ", "the", " ", "integration", " ", "by", " ", 
         RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{"UPotkP2P2", "[", 
            RowBox[{"k_", ",", 
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"-", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DER", "[", 
            RowBox[{"xINT", ",", "J2"}], "]"}], " ", 
           RowBox[{"UPotkP2", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", "rule"}], ",", " ", 
     RowBox[{"and", " ", "the", " ", "subsequent", " ", 
      RowBox[{"simplifications", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
     ",", " ", 
     RowBox[{
     "we", " ", "use", " ", "J1", " ", "to", " ", "perform", " ", "the", " ", 
      "integration", " ", "by", " ", "parts", " ", "of", " ", "the", " ", 
      RowBox[{"DIRACP", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", 
     RowBox[{"integranddFdt", "/.", "RulePartUPotkP2P2argJ1J2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"RulePartDIRACP", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"F", "[", "J2", "]"}], ",", 
           RowBox[{"FP", "[", "J2", "]"}], ",", 
           RowBox[{"FPP", "[", "J2", "]"}]}], "}"}], "]"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RuleIdentifyPRPAPRPAPP"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNiceINT", "[", "integranddFdt", "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"NiceINTWrapped", "[", "integranddFdt", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"++", 
     RowBox[{"++", 
      RowBox[{"++", 
       RowBox[{"++", 
        RowBox[{"++", 
         RowBox[{"++", 
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"++", 
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"++", "++"}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"++", 
     RowBox[{"++", 
      RowBox[{"++", 
       RowBox[{"++", 
        RowBox[{"++", 
         RowBox[{"++", 
          RowBox[{"++", 
           RowBox[{"++", 
            RowBox[{"++", 
             RowBox[{"++", 
              RowBox[{"++", 
               RowBox[{"++", 
                RowBox[{"++", 
                 RowBox[{"++", "++"}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Performing", " ", "an", " ", "integration", " ", "by", " ", "parts", 
       " ", "of", " ", "the", " ", "final", " ", "second"}], "-", 
      RowBox[{"order", " ", "derivatives", " ", "of", " ", "UPotk"}]}], ",", 
     RowBox[{"namely", " ", 
      RowBox[{
       RowBox[{"UPotkP1P2", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartUPotkP1P2", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "have", " ", 
          RowBox[{"UPotkP1P2", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], "=", 
         RowBox[{
          RowBox[{"d", "/", "dJ1"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}], ",", " ", 
        RowBox[{
        "hence", " ", "the", " ", "need", " ", "for", " ", "a", " ", 
         "negative", " ", "sign", " ", "in", " ", "the", " ", "integration", 
         " ", "by", " ", 
         RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{"UPotkP1P2", "[", 
            RowBox[{"k_", ",", 
             RowBox[{"{", 
              RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"-", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DER", "[", 
            RowBox[{"xINT", ",", "J1"}], "]"}], " ", 
           RowBox[{"UPotkP1", "[", 
            RowBox[{"k", ",", 
             RowBox[{"{", 
              RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", "rule"}], ",", " ", 
     RowBox[{"and", " ", "the", " ", "subsequent", " ", 
      RowBox[{"simplifications", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
     ",", " ", 
     RowBox[{
     "we", " ", "use", " ", "J2", " ", "to", " ", "perform", " ", "the", " ", 
      "integration", " ", "by", " ", "part", " ", "of", " ", "the", " ", 
      RowBox[{"DIRACP", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", 
     RowBox[{"integranddFdt", "/.", "RulePartUPotkP1P2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"RulePartDIRACP", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"F", "[", "J1", "]"}], ",", 
           RowBox[{"FP", "[", "J1", "]"}], ",", 
           RowBox[{"FPP", "[", "J1", "]"}]}], "}"}], "]"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RuleIdentifyPRPAPRPAPP"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNiceINT", "[", "integranddFdt", "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"NiceINTWrapped", "[", "integranddFdt", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "We", " ", "continue", " ", "getting", " ", "rid", " ", "of", " ", 
       "second"}], "-", 
      RowBox[{"order", " ", "derivatives"}]}], ",", " ", 
     RowBox[{"this", " ", "time"}], ",", " ", 
     RowBox[{"second", "-", 
      RowBox[{
      "order", " ", "derivatives", " ", "of", " ", "the", " ", "frequency", 
       " ", 
       RowBox[{"profile", ".", "\[IndentingNewLine]", "For"}], " ", "now"}]}],
      ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "only", " ", "deal", " ", "with", " ", "the", " ", "term", 
       " ", "that", " ", "do", " ", "not", " ", "create", " ", "any", " ", 
       "new", " ", "second"}], "-", 
      RowBox[{"order", " ", 
       RowBox[{"derivatives", ".", "\[IndentingNewLine]", "These"}], " ", 
       "correspond", " ", "only", " ", "to", " ", "two", " ", "terms"}]}], 
     ",", " ", 
     RowBox[{"involving", " ", 
      RowBox[{
       RowBox[{"\[CapitalOmega]PP", "[", "J2", "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePart\[CapitalOmega]PPJ2", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "have", " ", 
          RowBox[{"\[CapitalOmega]PP", "[", "J2", "]"}]}], "=", 
         RowBox[{
          RowBox[{"d", "/", "dJ2"}], " ", 
          RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}]}]}], ",", " ", 
        RowBox[{
        "hence", " ", "we", " ", "need", " ", "a", " ", "negative", " ", 
         "sign", " ", "in", " ", "the", " ", "integration", " ", "by", " ", 
         RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HoldPattern", "@", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{"xINT_", " ", 
           RowBox[{"\[CapitalOmega]PP", "[", "J2", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"-", " ", 
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DER", "[", 
            RowBox[{"xINT", ",", "J2"}], "]"}], " ", 
           RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", "rule"}], ",", " ", 
     RowBox[{"and", " ", "the", " ", "subsequent", " ", 
      RowBox[{"simplifications", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
     ",", " ", 
     RowBox[{
     "we", " ", "use", " ", "J1", " ", "to", " ", "perform", " ", "the", " ", 
      "integration", " ", "by", " ", "part", " ", "of", " ", "the", " ", 
      RowBox[{"DIRACP", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", 
     RowBox[{"integranddFdt", "/.", "RulePart\[CapitalOmega]PPJ2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", "=", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"RulePartDIRACP", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"F", "[", "J2", "]"}], ",", 
           RowBox[{"FP", "[", "J2", "]"}], ",", 
           RowBox[{"FPP", "[", "J2", "]"}]}], "}"}], "]"}]}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RuleIdentifyPRPAPRPAPP"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdt", " ", "=", " ", 
      RowBox[{"ReduceNiceINT", "[", "integranddFdt", "]"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"NiceINTWrapped", "[", "integranddFdt", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "next", " ", "step", " ", "of", " ", "the", " ", 
      "calculation", " ", "is", " ", "to", " ", "perform", " ", "an", " ", 
      "integration", " ", "by", " ", "parts", " ", "for", " ", "all", " ", 
      "the", " ", "terms", " ", "where", " ", "the", " ", "product", " ", 
      RowBox[{"F", "[", "J", "]"}], 
      RowBox[{"F", "[", "J1", "]"}], 
      RowBox[{"F", "[", "J2", "]"}], " ", "involves", " ", "more", " ", 
      "than", " ", "one", " ", 
      RowBox[{"derivative", ".", "\[IndentingNewLine]", "Indeed"}]}], ",", 
     " ", 
     RowBox[{
     "we", " ", "expect", " ", "that", " ", "the", " ", "dependence", " ", 
      "of", " ", "the", " ", "DF", " ", "will", " ", "simply", " ", "be", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", "+", "k2"}], ",", 
          RowBox[{"-", "k1"}], ",", 
          RowBox[{"-", "k2"}]}], ")"}], ".", "d"}], "/", "d"}], 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"J", ",", "J1", ",", "J2"}], "}"}], "[", 
        RowBox[{
         RowBox[{"F", "[", "J", "]"}], 
         RowBox[{"F", "[", "J1", "]"}], 
         RowBox[{"F", "[", "J2", "]"}]}], "]"}], ".", "\[IndentingNewLine]", 
       "At"}], " ", "this", " ", "stage"}], ",", " ", 
     RowBox[{
     "the", " ", "unpleasant", " ", "terms", " ", "that", " ", "remain", " ", 
      "involve", " ", "products", " ", "of", " ", "the", " ", "form", " ", 
      RowBox[{"FP", "[", "J", "]"}], 
      RowBox[{"FP", "[", "J1", "]"}], 
      RowBox[{
       RowBox[{"F", "[", "J2", "]"}], ".", "\[IndentingNewLine]", "In"}], " ",
       "order", " ", "to", " ", "carry", " ", "out", " ", "the", " ", 
      "calculation"}], ",", " ", 
     RowBox[{
      RowBox[{"we", " ", 
       RowBox[{"will", ":", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"+", " ", "Symmetrise"}], " ", "these", " ", "terms", " ", 
          RowBox[{"w", ".", "r", ".", "t", ".", " ", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "J1"}], "}"}]}]}], "<", "_", ">", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k2", ",", "J2"}], "}"}], "\[IndentingNewLine]", "+", " ", 
          
          RowBox[{
          "Performing", " ", "an", " ", "integration", " ", "by", " ", 
           "parts", " ", "of", " ", "the", " ", "newly", " ", "created", " ", 
           "terms", " ", "in", " ", 
           RowBox[{"FP", "[", "J", "]"}], 
           RowBox[{"F", "[", "J1", "]"}], 
           RowBox[{"FP", "[", "J2", "]"}], " ", "by", " ", "using", " ", 
           RowBox[{"FP", "[", "J2", "]"}]}]}]}]}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"d", "/", "dJ2"}], " ", 
        RowBox[{"F", "[", "J2", "]"}]}], "\[IndentingNewLine]", "+", " ", 
       RowBox[{
       "Perform", " ", "an", " ", "integration", " ", "by", " ", "parts", " ",
         "wrt", " ", "J1", " ", "of", " ", "the", " ", "newly", " ", 
        "created", " ", "DIRACP"}]}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulePartFP1", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "We", " ", "spot", " ", "the", " ", "terms", " ", "that", " ", 
          "involve", " ", "two", " ", "derivatives", " ", "of", " ", "the", 
          " ", "distribution", " ", 
          RowBox[{"function", ".", "\[IndentingNewLine]", "We"}], " ", 
          "symmetrise", " ", 
          RowBox[{"w", ".", "r", ".", "t", ".", " ", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "J1"}], "}"}]}]}], "<", "_", ">", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k2", ",", "J2"}], "}"}], ".", "\[IndentingNewLine]", 
          "ATTENTION"}]}], ",", " ", 
        RowBox[{
        "not", " ", "to", " ", "forget", " ", "the", " ", "factor", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], "."}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xPREF_", " ", 
        RowBox[{"FP", "[", "J", "]"}], " ", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"xSUM_", " ", 
           RowBox[{"INT", "[", 
            RowBox[{
             RowBox[{"xINT_", " ", 
              RowBox[{"FP", "[", "J1", "]"}], " ", 
              RowBox[{"F", "[", "J2", "]"}]}], ",", "varINT_"}], "]"}]}], " ",
           ",", "varSUM_"}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xPREF", " ", "xSUM", " ", "xINT", " ", 
                RowBox[{"FP", "[", "J", "]"}], " ", 
                RowBox[{"FP", "[", "J1", "]"}], " ", 
                RowBox[{"F", "[", "J2", "]"}]}], " ", "+", " ", 
               RowBox[{"ReplaceVariables", "[", 
                RowBox[{
                 RowBox[{"xPREF", " ", "xSUM", " ", "xINT", " ", 
                  RowBox[{"FP", "[", "J", "]"}], " ", 
                  RowBox[{"FP", "[", "J1", "]"}], " ", 
                  RowBox[{"F", "[", "J2", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k1", ",", "J1", ",", "k2", ",", "J2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k2", ",", "J2", ",", "k1", ",", "J1"}], "}"}]}], 
                "]"}]}], ")"}]}], ",", "varINT"}], "]"}], ",", "varSUM"}], 
         "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"SameQ", "[", 
           RowBox[{"varSUM", ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "&&", 
          RowBox[{"SameQ", "[", 
           RowBox[{"varINT", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], ")"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", 
      RowBox[{"rule", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{"not", " ", "to", " ", "use", " ", 
      RowBox[{"RepeatedRules", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"integranddFdt", "/.", "RulePartFP1"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Applying", " ", "the", " ", "rule", " ", "to", " ", "put", " ", "all", 
     " ", "the", " ", "PRPA", " ", "to", " ", "the", " ", "expected", " ", 
     RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", "  ", 
     RowBox[{"RepeatedRules", "[", 
      RowBox[{"integranddFdt", ",", 
       RowBox[{"RulesDIRACSub", "~", "Join", "~", "RulesScaling"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Rule", " ", "to", " ", "perform", " ", "an", " ", "integration", " ", 
     "by", " ", "part", " ", "wrt", " ", "J2", " ", "for", " ", "the", " ", 
     "newly", " ", "created", " ", "integrals", " ", "that", " ", "involve", 
     " ", "terms", " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{"FP", "[", "J", "]"}], 
     RowBox[{"F", "[", "J1", "]"}], 
     RowBox[{
      RowBox[{"FP", "[", "J2", "]"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"RulePartFP2", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", " ", "have", " ", 
          RowBox[{"FP", "[", "J2", "]"}]}], "=", 
         RowBox[{
          RowBox[{"d", "/", "dJ2"}], " ", 
          RowBox[{"F", "[", "J2", "]"}]}]}], ",", " ", 
        RowBox[{
        "hence", " ", "the", " ", "need", " ", "for", " ", "a", " ", 
         "negative", " ", "sign", " ", "in", " ", "the", " ", "integration", 
         " ", "by", " ", 
         RowBox[{"parts", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xPREF_", " ", 
        RowBox[{"FP", "[", "J", "]"}], " ", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"xSUM_", "  ", 
           RowBox[{"INT", "[", 
            RowBox[{
             RowBox[{"xINT_", " ", 
              RowBox[{"F", "[", "J1", "]"}], " ", 
              RowBox[{"FP", "[", "J2", "]"}]}], ",", "varINT_"}], "]"}]}], 
          ",", "varSUM_"}], "]"}]}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{"-", " ", 
         RowBox[{"SUM", "[", 
          RowBox[{
           RowBox[{"INT", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DER", "[", 
               RowBox[{
                RowBox[{"xPREF", " ", "xSUM", " ", "xINT", " ", 
                 RowBox[{"FP", "[", "J", "]"}], " ", 
                 RowBox[{"F", "[", "J1", "]"}]}], ",", "J2"}], "]"}], 
              RowBox[{"F", "[", "J2", "]"}]}], ",", "varINT"}], "]"}], ",", 
           "varSUM"}], "]"}]}], "/;", 
        RowBox[{"(", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"varINT", ",", "J2"}], "]"}], ")"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"integranddFdt", "/.", "RulePartFP2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Computing", " ", "the", " ", "derivatives", " ", "to", " ", "get", " ", 
     "some", " ", "DIRACP", " ", "to", " ", 
     RowBox[{"appear", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", "RulesDER"}], "]"}], "//", "Expand"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Performing", " ", "an", " ", "integration", " ", "by", " ", "parts", " ",
      "wrt", " ", "J1", " ", "of", " ", "the", " ", 
     RowBox[{"DIRACP", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", 
     RowBox[{"integranddFdt", "/.", 
      RowBox[{"RulePartDIRACP", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"F", "[", "J2", "]"}], ",", 
         RowBox[{"FP", "[", "J2", "]"}], ",", 
         RowBox[{"FPP", "[", "J2", "]"}]}], "}"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Computing", " ", "all", " ", "the", " ", "derivatives", " ", "and", " ", 
     "identifying", " ", "the", " ", "PRPA", "\[Times]", 
     RowBox[{"PRPAPP", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdt", ",", 
        RowBox[{"RuleIdentifyPRPAPRPAPP", "~", "Join", "~", "RulesDER"}]}], 
       "]"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Making", " ", 
     RowBox[{"simplifications", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"integranddFdt", "//", "NiceINTWrapped"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Making", " ", "a", " ", "full", " ", 
     RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"integranddFdt", " ", "+", " ", 
         RowBox[{"NiceINTSymFULL", "[", "integranddFdt", "]"}]}], ")"}]}], "//",
       "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "conclude", " ", "the", " ", "calculation", " ", "by", " ", 
     "removing", " ", "the", " ", "SUM", " ", "and", " ", "INT", " ", "and", 
     " ", "letting", " ", "MMA", " ", "make", " ", "a", " ", 
     RowBox[{"simplification", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdtSHORT", " ", "=", " ", 
     RowBox[{"RepeatedRules", "[", 
      RowBox[{"integranddFdt", ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SUM", "[", 
           RowBox[{"xSUM_", ",", "varSUM_"}], "]"}], "\[RuleDelayed]", 
          "xSUM"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{"xINT_", ",", "varINT_"}], "]"}], "\[RuleDelayed]", 
          "xINT"}]}], "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Letting", " ", "MMA", " ", 
     RowBox[{"simplify", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integranddFdtSHORT", "=", " ", 
      RowBox[{"integranddFdtSHORT", "//", "Simplify"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Displaying", " ", "the", " ", "final", " ", "equation"}], 
     ".."}], "*)"}], "\[IndentingNewLine]", "integranddFdtSHORT", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "create", " ", "back", " ", "the", " ", "full", " ", 
      "expression"}], ",", " ", 
     RowBox[{"and", " ", 
      RowBox[{"expand", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{
      RowBox[{"SUM", "[", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{"integranddFdtSHORT", " ", ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "//", "Expand"}]}], 
    ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.8614351052739897`*^9, 3.861435107624209*^9}, {
   3.861436551451955*^9, 3.861436576288884*^9}, {3.861436612653694*^9, 
   3.861436759744174*^9}, {3.8614368857055197`*^9, 3.8614369076080217`*^9}, {
   3.86143713359057*^9, 3.861437282194072*^9}, {3.861437343596711*^9, 
   3.861437359445404*^9}, {3.861437862837802*^9, 3.8614381990490103`*^9}, {
   3.861438259849586*^9, 3.861438262379382*^9}, {3.8614383301582823`*^9, 
   3.861438369314249*^9}, {3.861438425520667*^9, 3.861438890152637*^9}, {
   3.8614391580989637`*^9, 3.8614392731826153`*^9}, {3.8614393175036707`*^9, 
   3.861439317631778*^9}, {3.861439412623312*^9, 3.8614394156234417`*^9}, {
   3.861445556536237*^9, 3.861445607631235*^9}, {3.861445639817127*^9, 
   3.8614457222178993`*^9}, {3.861445773004202*^9, 3.861445790683853*^9}, {
   3.86144583531526*^9, 3.861445997134709*^9}, {3.861446030923565*^9, 
   3.861446202365168*^9}, {3.861446278779641*^9, 3.861446359066759*^9}, {
   3.86144670774382*^9, 3.861446748675345*^9}, {3.861446814943698*^9, 
   3.861446830173252*^9}, {3.861447202421767*^9, 3.8614472436027803`*^9}, {
   3.861528260999164*^9, 3.861528292295134*^9}, 3.861528516521756*^9, {
   3.8623023652232237`*^9, 3.862302368153838*^9}, {3.8623024619818983`*^9, 
   3.862302504469898*^9}, 3.86230271177312*^9, {3.8628880729460363`*^9, 
   3.862888073531645*^9}, {3.862912281251925*^9, 3.8629122814993687`*^9}, {
   3.8629123768791313`*^9, 3.862912377226206*^9}, {3.8629996077002068`*^9, 
   3.862999607900876*^9}, {3.863000491665145*^9, 3.863000530063546*^9}, {
   3.8630006857778397`*^9, 3.863000744172267*^9}, {3.863001259762516*^9, 
   3.863001259916504*^9}, {3.8630087743523912`*^9, 3.863008787305002*^9}, {
   3.866194487195609*^9, 3.866194489611044*^9}, {3.866194607286222*^9, 
   3.866194609507531*^9}, {3.866194720331875*^9, 3.866194747580862*^9}, 
   3.866529077940222*^9, 3.866529113193524*^9, {3.866529143624146*^9, 
   3.8665291496012774`*^9}, {3.8665291819983673`*^9, 3.866529214972845*^9}, {
   3.866529248568049*^9, 3.866529290341406*^9}, {3.8665293259574966`*^9, 
   3.866529332467841*^9}, 3.866529372399414*^9, 3.866529442691986*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. of types of nice INT | \"\>", "\[InvisibleSpace]", 
   "308"}],
  SequenceForm["Initial nb. of types of nice INT | ", 308],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530354676652*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"75.329161`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.8665304300066013`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. of types of nice INT | \"\>", "\[InvisibleSpace]", 
   "209"}],
  SequenceForm["Final nb. of types of nice INT | ", 209],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.8665304303104057`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "656"}],
  SequenceForm["Initial nb. terms | ", 656],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530432472616*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "644"}],
  SequenceForm["Final nb. terms | ", 644],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530432518506*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.186002`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.866530432525304*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "644"}],
  SequenceForm["Initial nb. terms | ", 644],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530439431121*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "640"}],
  SequenceForm["Final nb. terms | ", 640],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.8665304394684353`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.943086`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.86653043947474*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"40.235583`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.8665304817842617`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "507"}],
  SequenceForm["Initial nb. terms | ", 507],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530483117786*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "440"}],
  SequenceForm["Final nb. terms | ", 440],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.8665304832406673`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.53715`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.8665304864898148`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "407"}],
  SequenceForm["Initial nb. terms | ", 407],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530487389347*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "407"}],
  SequenceForm["Final nb. terms | ", 407],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530487396317*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.309131`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.866530490289064*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "380"}],
  SequenceForm["Initial nb. terms | ", 380],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.8665304909974203`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "380"}],
  SequenceForm["Final nb. terms | ", 380],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530491039267*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.778371`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.866530493147285*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "376"}],
  SequenceForm["Initial nb. terms | ", 376],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530493848301*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "376"}],
  SequenceForm["Final nb. terms | ", 376],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.8665304938897867`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.71701`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.866530495938704*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "373"}],
  SequenceForm["Initial nb. terms | ", 373],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530496588954*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "373"}],
  SequenceForm["Final nb. terms | ", 373],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530496594491*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.528831`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.866530498597721*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "352"}],
  SequenceForm["Initial nb. terms | ", 352],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.86653049918818*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "352"}],
  SequenceForm["Final nb. terms | ", 352],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.8665304991953278`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.324558`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.8665305019375668`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "340"}],
  SequenceForm["Initial nb. terms | ", 340],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.8665305023874817`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "335"}],
  SequenceForm["Final nb. terms | ", 335],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530502393227*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial nb. terms | \"\>", "\[InvisibleSpace]", "378"}],
  SequenceForm["Initial nb. terms | ", 378],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530504187154*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Final nb. terms | \"\>", "\[InvisibleSpace]", "364"}],
  SequenceForm["Final nb. terms | ", 364],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439469814858*^9, 3.861439507921047*^9}, {
   3.861446192370945*^9, 3.861446205514778*^9}, 3.861447073129562*^9, 
   3.861447246918434*^9, {3.861447297582271*^9, 3.861447316146063*^9}, 
   3.8614476488403997`*^9, 3.862302577374185*^9, 3.862302711773176*^9, 
   3.862457567426894*^9, 3.862544213642354*^9, 3.8626321894532547`*^9, 
   3.862736211734819*^9, 3.862738375876155*^9, 3.862912604118792*^9, 
   3.8629997887074957`*^9, 3.863000967456327*^9, 3.8630090061279097`*^9, 
   3.866180587601305*^9, 3.866194750532453*^9, 3.866530504193675*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.041873`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.866530511137662*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["k1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"k1", "+", "k2"}], ")"}]}]], 
  RowBox[{"2", " ", 
   SuperscriptBox["\[Pi]", "3"], " ", 
   SuperscriptBox["\[Mu]", "2"], " ", 
   RowBox[{"DIRAC", "[", 
    RowBox[{
     RowBox[{"k1", " ", 
      RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
     RowBox[{"k2", " ", 
      RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
     RowBox[{"k1", " ", 
      RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
     RowBox[{"k2", " ", 
      RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "k1"}], " ", 
      RowBox[{"F", "[", "J", "]"}], " ", 
      RowBox[{"F", "[", "J2", "]"}], " ", 
      RowBox[{"FP", "[", "J1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"F", "[", "J1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], " ", 
         RowBox[{"F", "[", "J2", "]"}], " ", 
         RowBox[{"FP", "[", "J", "]"}]}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"F", "[", "J", "]"}], " ", 
         RowBox[{"FP", "[", "J2", "]"}]}]}], ")"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"PRPA", "[", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
          RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}]], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "k2"}], " ", 
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"k1", " ", 
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["k1", "2"], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"k1", " ", "k2", " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"k1", " ", "k2", " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["k2", "2"], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"k1", " ", "k2", " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"k1", " ", "k2", " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"k2", " ", 
       RowBox[{"PRPAP", "[", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
          RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}]], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"k1", "+", "k2"}], ")"}]}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"\[CapitalOmega]P", "[", "J", "]"}]}], "+", 
         RowBox[{"k1", " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}]}], "+", 
         RowBox[{"k2", " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}]}]}], ")"}]}]}], ")"}], 
    "2"]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.861439470326016*^9, 3.861439508398912*^9}, {
   3.861446198891081*^9, 3.861446206030046*^9}, 3.861447073676757*^9, {
   3.861447284108347*^9, 3.861447304775921*^9}, 3.861447399937158*^9, 
   3.861447728415258*^9, 3.862302665104959*^9, 3.862302711773224*^9, 
   3.862457641278882*^9, 3.8625442944360647`*^9, 3.862632275965564*^9, 
   3.8627362873042173`*^9, 3.862738451506343*^9, 3.8629126849345417`*^9, 
   3.862999873056918*^9, 3.863001050456012*^9, 3.863009086555539*^9, 
   3.86618066994919*^9, 3.866194831933051*^9, 3.866530511146428*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Dumping", " ", "the", " ", "expression", " ", "for", " ", "easy", " ", 
    "later", " ", 
    RowBox[{"use", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<integranddFdt.mx\>\""}], ",", "integranddFdt", ",", 
       "\"\<MX\>\""}], "]"}], ";"}], "//", "AbsoluteTiming"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<integranddFdtSHORT.mx\>\""}], ",", "integranddFdtSHORT", ",", 
       "\"\<MX\>\""}], "]"}], ";"}], "//", "AbsoluteTiming"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.862306879647386*^9, 3.8623068998937483`*^9}, {
   3.862999522359448*^9, 3.8629995354699297`*^9}, {3.863000567571867*^9, 
   3.863000573281578*^9}, {3.8630012704206553`*^9, 3.863001275082837*^9}, 
   3.863016405247438*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.091785`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.862306901513356*^9, 3.862457651276744*^9, 
  3.862738461396913*^9, 3.86291275701309*^9, 3.862999957310978*^9, 
  3.863001276455531*^9, 3.863009167152561*^9, 3.86301640524756*^9, 
  3.866180759030794*^9, 3.866194982953527*^9, 3.866530512087654*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.119514`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.862306901513356*^9, 3.862457651276744*^9, 
  3.862738461396913*^9, 3.86291275701309*^9, 3.862999957310978*^9, 
  3.863001276455531*^9, 3.863009167152561*^9, 3.86301640524756*^9, 
  3.866180759030794*^9, 3.866194982953527*^9, 3.866530512236547*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "check", " ", "that", " ", "the", " ", "kinetic", " ", 
     "equation"}], ",", " ", 
    RowBox[{
    "as", " ", "written", " ", "in", " ", "the", " ", "paper", " ", "matches",
      " ", "with", " ", "the", " ", "MMA", " ", 
     RowBox[{"calculation", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Reading", " ", "the", " ", "dumped", " ", 
     RowBox[{"expressions", ".", "\[IndentingNewLine]", "With"}], " ", "this",
      " ", "convention"}], ",", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "kinetic", " ", "equation", " ", "reads", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dF", "[", "J", "]"}], "/", "dt"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"d", "/", 
       RowBox[{"dJ", " ", "[", "integranddFdt", "]"}]}], 
      "\[IndentingNewLine]", " ", "=", " ", 
      RowBox[{"d", "/", 
       RowBox[{"dJ", "[", 
        RowBox[{"SUM", "[", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{"integranddFdtshort", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"integranddFdt", " ", "=", " ", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<integranddFdt.mx\>\""}], ",", "\"\<MX\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integranddFdtSHORT", " ", "=", " ", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<integranddFdtSHORT.mx\>\""}], ",", "\"\<MX\>\""}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.862999698981557*^9, 3.8629997124468517`*^9}, {
   3.862999750359977*^9, 3.862999854177726*^9}, {3.8630006634568653`*^9, 
   3.863000668007765*^9}, {3.863001283772314*^9, 3.8630012867950497`*^9}, 
   3.8630566587158213`*^9, 3.86619516024116*^9, {3.866529462123446*^9, 
   3.8665294633080063`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "manually", " ", "rewrite", " ", "the", " ", "equation"}], ",",
     " ", 
    RowBox[{"as", " ", "in", " ", "the", " ", "paper"}], ",", " ", 
    RowBox[{
    "to", " ", "check", " ", "that", " ", "it", " ", "matches", " ", "with", 
     " ", "the", " ", "MMA", " ", 
     RowBox[{"calculation", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Expression", " ", "of", " ", "the", " ", "two", " ", "coupling", " ", 
    RowBox[{"coefficients", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"First", " ", "coupling", " ", 
    RowBox[{"U1", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expU1", " ", "=", " ", 
     RowBox[{
      RowBox[{"k2", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "coupling", " ", 
     RowBox[{"U2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expU2", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J", "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k1", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Expression", " ", "of", " ", "the", " ", "flux", " ", "of", " ", "the", 
      " ", "kinetic", " ", "equation"}], ",", " ", 
     RowBox[{
      RowBox[{"defined", " ", "so", " ", "that", " ", 
       RowBox[{"dF", "/", "dt"}]}], "=", 
      RowBox[{"d", "/", 
       RowBox[{
        RowBox[{"dJ", "[", "Flux", "]"}], ".", "\[IndentingNewLine]", 
        "ATTENTION"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"to", " ", "the", " ", "minus", " ", "sign", " ", "in", " ", 
       RowBox[{"PRPAP", "[", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
           RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "]"}]}], 
      "=", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}], "^", 
          RowBox[{"(", "2", ")"}]}], ")"}], "."}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FluxKineticEquationSHORT", " ", "=", " ", 
     RowBox[{"2", " ", 
      RowBox[{"\[Pi]", "^", 
       RowBox[{"(", "3", ")"}]}], " ", 
      RowBox[{"\[Mu]", "^", 
       RowBox[{"(", "2", ")"}]}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", "^", 
           RowBox[{"(", "2", ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}]}], ")"}]}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"expU1", " ", 
          RowBox[{"PRPA", "[", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "]"}]}],
          "-", " ", 
         RowBox[{"k2", " ", "expU2", " ", 
          RowBox[{"PRPAP", "[", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
           "]"}]}]}], ")"}], "^", 
       RowBox[{"(", "2", ")"}]}], " ", 
      RowBox[{"DIRAC", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], 
         RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
        RowBox[{"k1", " ", 
         RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], " ", 
         RowBox[{"FP", "[", "J", "]"}], " ", 
         RowBox[{"F", "[", "J1", "]"}], 
         RowBox[{"F", "[", "J2", "]"}]}], "-", 
        RowBox[{"k1", " ", 
         RowBox[{"F", "[", "J", "]"}], 
         RowBox[{"FP", "[", "J1", "]"}], 
         RowBox[{"F", "[", "J2", "]"}]}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"F", "[", "J", "]"}], 
         RowBox[{"F", "[", "J1", "]"}], 
         RowBox[{"FP", "[", "J2", "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Checking", " ", "that", " ", "the", " ", "equations", " ", "are", " ", 
     "the", " ", 
     RowBox[{"same", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"FluxKineticEquationSHORT", "-", "integranddFdtSHORT"}], ")"}], "//",
     "Expand"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.862999857983184*^9, 3.86300000062748*^9}, {
   3.863000063031682*^9, 3.863000435835135*^9}, {3.8630008720284843`*^9, 
   3.863000885403887*^9}, {3.8630012941567783`*^9, 3.863001336597035*^9}, {
   3.863001476862884*^9, 3.863001487268385*^9}, 3.863001590019363*^9, {
   3.863001625392457*^9, 3.8630016382568913`*^9}, {3.863001746686099*^9, 
   3.863001870814999*^9}, {3.863008744623102*^9, 3.863008757684929*^9}, {
   3.8630566203966303`*^9, 3.863056658717395*^9}, {3.866195126119718*^9, 
   3.866195160241674*^9}}],

Cell[BoxData["0"], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.86619515570373*^9, 3.8661951732236958`*^9}, 
   3.866530512639819*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["6/ RECOVERING THE HOMOGENEOUS 1/N^2 EQUATION", \
"Subsubsection"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 CellChangeTimes->{{3.862999373075259*^9, 3.8629993893354797`*^9}, 
   3.862999506818902*^9, {3.8661787335071373`*^9, 3.866178735472378*^9}, {
   3.866179015533478*^9, 3.8661790470734262`*^9}, 3.8665306625625753`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Recovering", " ", "the", " ", "homogeneos", " ", 
      RowBox[{"1", "/", 
       RowBox[{"N", "^", "2"}]}], " ", "equation", " ", "obtained", " ", "in",
       " ", "Fouvry"}], "+", "2020"}], ",", " ", "PRE", ",", " ", "102", ",", 
    " ", 
    RowBox[{"052110", " ", 
     RowBox[{
      RowBox[{"(", "2020", ")"}], ".", "\[IndentingNewLine]", "ATTENTION"}]}],
     ",", " ", 
    RowBox[{
    "we", " ", "still", " ", "make", " ", "UPotk", " ", "depend", " ", "on", 
     " ", "J", " ", "in", " ", "a", " ", "trivial", " ", "fashion"}], ",", 
    " ", 
    RowBox[{
    "so", " ", "that", " ", "simplification", " ", "rules", " ", "are", " ", 
     "still", " ", 
     RowBox[{"performed", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RulesHOM", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "Ja_", "]"}], "\[RuleDelayed]", 
        "Ja"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]P", "[", "Ja_", "]"}], "\[RuleDelayed]", 
        "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]PP", "[", "Ja_", "]"}], "\[RuleDelayed]", 
        "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UPotk", "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{"UPotk", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"J", ",", "J"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UPotkP1", "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
        "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UPotkP2", "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
        "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UPotkP1P1", "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
        "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UPotkP1P2", "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
        "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UPotkP2P2", "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
        "0"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intdFdtSHORTHOM", " ", "=", " ", 
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"integranddFdtSHORT", ",", "RulesHOM"}], "]"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Putting", " ", "under", " ", "the", " ", "same", " ", "form", " ", 
       "as", " ", "in", " ", "Fouvry"}], "+", "2020"}], ",", " ", "PRE", ",", 
     " ", "102", ",", " ", 
     RowBox[{"052110", " ", 
      RowBox[{
       RowBox[{"(", "2020", ")"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesHOM2", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"J", "\[RuleDelayed]", "v"}], ",", "\[IndentingNewLine]", 
       RowBox[{"J1", "\[RuleDelayed]", "v1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"J2", "\[RuleDelayed]", "v2"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UPotk", "[", 
         RowBox[{"k_", ",", "l_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"UPotk", "[", "k", "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"intdFdtSHORTHOM", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"RepeatedRules", "[", 
       RowBox[{"intdFdtSHORTHOM", " ", ",", "RulesHOM2"}], "]"}], "//", 
      "Expand"}], "//", "Simplify"}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 CellChangeTimes->{{3.8623079610191813`*^9, 3.86230812329498*^9}, {
   3.862632342170904*^9, 3.862632343161961*^9}, {3.862632383523377*^9, 
   3.862632383625661*^9}, {3.8627410059628687`*^9, 3.8627410272100573`*^9}, {
   3.862819260898241*^9, 3.8628192752522583`*^9}, {3.862824119851266*^9, 
   3.862824120129743*^9}, {3.862890087928441*^9, 3.862890114632519*^9}, {
   3.8629010705704327`*^9, 3.862901073553212*^9}, 3.8629013169985743`*^9, {
   3.862901381592243*^9, 3.86290145692689*^9}, {3.862912261602174*^9, 
   3.862912262269808*^9}, {3.862926910321*^9, 3.8629269108476353`*^9}, {
   3.862926977152738*^9, 3.862926977281065*^9}, {3.862930990154779*^9, 
   3.8629310016691628`*^9}, {3.862932310516028*^9, 3.862932363810514*^9}, {
   3.8629324366054583`*^9, 3.8629324545184517`*^9}, {3.862969335461982*^9, 
   3.86296935833916*^9}, 3.862999506819269*^9, {3.863009191926557*^9, 
   3.8630092018770742`*^9}, {3.866195023307629*^9, 3.866195055314356*^9}, {
   3.866529501052487*^9, 3.8665295826038847`*^9}, {3.866530551633823*^9, 
   3.86653066256291*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["k1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"k1", "+", "k2"}], ")"}]}]], 
  RowBox[{"2", " ", 
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["\[Pi]", "3"], " ", 
   SuperscriptBox["\[Mu]", "2"], " ", 
   RowBox[{"DIRAC", "[", 
    RowBox[{
     RowBox[{"k1", " ", "v"}], "+", 
     RowBox[{"k2", " ", "v"}], "-", 
     RowBox[{"k1", " ", "v1"}], "-", 
     RowBox[{"k2", " ", "v2"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "k1"}], " ", 
      RowBox[{"F", "[", "v", "]"}], " ", 
      RowBox[{"F", "[", "v2", "]"}], " ", 
      RowBox[{"FP", "[", "v1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"F", "[", "v1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], " ", 
         RowBox[{"F", "[", "v2", "]"}], " ", 
         RowBox[{"FP", "[", "v", "]"}]}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"F", "[", "v", "]"}], " ", 
         RowBox[{"FP", "[", "v2", "]"}]}]}], ")"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"PRPAP", "[", 
     FractionBox["1", 
      RowBox[{"v", "-", "v1"}]], "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"k1", " ", 
       RowBox[{"UPotk", "[", "k2", "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", "+", "k2"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"UPotk", "[", "k1", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}], " ", 
          RowBox[{"UPotk", "[", "k2", "]"}]}], "-", 
         RowBox[{"k2", " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", "+", "k2"}], "]"}]}]}], ")"}]}]}], ")"}], 
    "2"]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 CellChangeTimes->{{3.8665306520858707`*^9, 3.86653066256299*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["7/ CONSERVATION PROPERTIES", "Subsubsection"]], \
"Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.86299963027845*^9, 3.862999639751279*^9}, 
   3.8629996928302107`*^9, {3.8630098451369762`*^9, 3.86300985002241*^9}, 
   3.8630566587152863`*^9, 3.866178877498698*^9, {3.866179017053179*^9, 
   3.866179017229271*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Expression", " ", "of", " ", "the", " ", "two", " ", "coupling", " ", 
    RowBox[{"coefficients", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"First", " ", "coupling", " ", 
    RowBox[{"U1", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expU1", " ", "=", " ", 
     RowBox[{
      RowBox[{"k2", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "coupling", " ", 
     RowBox[{"U2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expU2", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J", "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k1", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Expression", " ", "of", " ", "the", " ", "flux", " ", "of", " ", "the", 
      " ", "kinetic", " ", "equation"}], ",", " ", 
     RowBox[{
      RowBox[{"defined", " ", "so", " ", "that", " ", 
       RowBox[{"dF", "/", "dt"}]}], "=", 
      RowBox[{"d", "/", 
       RowBox[{
        RowBox[{"dJ", "[", "Flux", "]"}], ".", "\[IndentingNewLine]", 
        "ATTENTION"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"to", " ", "the", " ", "minus", " ", "sign", " ", "in", " ", 
       RowBox[{"PRPAP", "[", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
           RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "]"}]}], 
      "=", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}], "^", 
          RowBox[{"(", "2", ")"}]}], ")"}], "."}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FluxKineticEquationSHORT", " ", "=", " ", 
     RowBox[{"2", " ", 
      RowBox[{"\[Pi]", "^", 
       RowBox[{"(", "3", ")"}]}], " ", 
      RowBox[{"\[Mu]", "^", 
       RowBox[{"(", "2", ")"}]}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", "^", 
           RowBox[{"(", "2", ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}]}], ")"}]}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"expU1", " ", 
          RowBox[{"PRPA", "[", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "]"}]}],
          "-", " ", 
         RowBox[{"k2", " ", "expU2", " ", 
          RowBox[{"PRPAP", "[", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
           "]"}]}]}], ")"}], "^", 
       RowBox[{"(", "2", ")"}]}], " ", 
      RowBox[{"DIRAC", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], 
         RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
        RowBox[{"k1", " ", 
         RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], " ", 
         RowBox[{"FP", "[", "J", "]"}], " ", 
         RowBox[{"F", "[", "J1", "]"}], 
         RowBox[{"F", "[", "J2", "]"}]}], "-", 
        RowBox[{"k1", " ", 
         RowBox[{"F", "[", "J", "]"}], 
         RowBox[{"FP", "[", "J1", "]"}], 
         RowBox[{"F", "[", "J2", "]"}]}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"F", "[", "J", "]"}], 
         RowBox[{"F", "[", "J1", "]"}], 
         RowBox[{"FP", "[", "J2", "]"}]}]}], ")"}]}]}], ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{3.866195258547409*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "check", " ", "the", " ", "symmetry", " ", "property", " ", 
     "of", " ", "the", " ", "integral", " ", 
     RowBox[{
      RowBox[{"INT", "[", 
       RowBox[{"FluxKineticEquation", ",", "J"}], "]"}], ".", 
      "\[IndentingNewLine]", "As"}], " ", "a", " ", "consequence"}], ",", " ", 
    RowBox[{
    "we", " ", "can", " ", "now", " ", "perform", " ", "symmetrisation", " ", 
     "wrt", " ", "the", " ", "variable", " ", 
     RowBox[{"J", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Without", " ", "performing", " ", "any", " ", 
    RowBox[{"symmetrisation", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"INTFluxSHORT0", " ", "=", " ", "FluxKineticEquationSHORT"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Performing", " ", "the", " ", "symmetrisation", " ", "J"}], 
      "<", "_", ">", 
      RowBox[{"J1", " ", "and", " ", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2"}], "}"}]}]}], "\[Rule]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "k1"}], "-", "k2"}], ",", "k2"}], "}"}], "."}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTFluxSHORT1", " ", "=", " ", 
     RowBox[{"ReplaceVariables", "[", 
      RowBox[{"INTFluxSHORT0", ",", 
       RowBox[{"{", 
        RowBox[{"J", ",", "J1", ",", "k1", ",", "k2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"J1", ",", "J", ",", 
         RowBox[{
          RowBox[{"-", "k1"}], "-", "k2"}], ",", "k2"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTFluxSHORT1", " ", "=", " ", 
     RowBox[{"INTFluxSHORT1", "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Performing", " ", "the", " ", "symmetrisation", " ", "J"}], 
      "<", "_", ">", 
      RowBox[{"J2", " ", "and", " ", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2"}], "}"}]}]}], "\[Rule]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "k1"}], ",", 
        RowBox[{"k1", "+", "k2"}]}], "}"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTFluxSHORT2", " ", "=", " ", 
     RowBox[{"ReplaceVariables", "[", 
      RowBox[{"INTFluxSHORT0", ",", 
       RowBox[{"{", 
        RowBox[{"J", ",", "J2", ",", "k1", ",", "k2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"J2", ",", "J", ",", 
         RowBox[{"-", "k1"}], ",", 
         RowBox[{"k1", "+", "k2"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "PRPA", " ", "have", " ", "now", " ", "become", " ", 
      RowBox[{"PRPA", "[", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "J1", "]"}], "-", 
          RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}]}], "]"}]}], 
     ",", " ", 
     RowBox[{
     "but", " ", "we", " ", "can", " ", "use", " ", "the", " ", "DIRAC", " ", 
      "to", " ", "make", " ", "some", " ", 
      RowBox[{"replacements", ".", "\[IndentingNewLine]", "As"}], " ", 
      "such"}], ",", " ", 
     RowBox[{"we", " ", "temporarily", " ", "introduce", " ", 
      RowBox[{"INT", "[", 
       RowBox[{",", 
        RowBox[{"{", 
         RowBox[{"J", ",", "J1", ",", "J2"}], "}"}]}], "]"}], " ", "so", " ", 
      "as", " ", "to", " ", "be", " ", "able", " ", "to", " ", "use", " ", 
      "the", " ", "previously", " ", "defined", " ", 
      RowBox[{"rules", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTFluxSHORT2", " ", "=", " ", 
     RowBox[{"INT", "[", 
      RowBox[{"INTFluxSHORT2", ",", 
       RowBox[{"{", 
        RowBox[{"J", ",", "J1", ",", "J2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Using", " ", "the", " ", "rules", " ", "to", " ", "make", " ", "the", 
     " ", "substitution", " ", "via", " ", "the", " ", "DIRAC", " ", "and", 
     " ", "to", " ", "take", " ", "out", " ", "the", " ", "scaling", " ", 
     "from", " ", "the", " ", 
     RowBox[{"PRPA", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTFluxSHORT2", " ", "=", " ", 
     RowBox[{"RepeatedRules", "[", 
      RowBox[{"INTFluxSHORT2", ",", 
       RowBox[{"RulesDIRACSub", "~", "Join", "~", "RulesScaling"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Removing", " ", "the", " ", "INT", " ", "now", " ", "that", " ", "the", 
     " ", "substitutions", " ", "have", " ", "been", " ", 
     RowBox[{"performed", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTFluxSHORT2", " ", "=", " ", 
     RowBox[{"INTFluxSHORT2", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{"xINT_", ",", "varINT_"}], "]"}], "\[RuleDelayed]", "xINT"}],
        "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INTFluxSHORT2", " ", "=", " ", 
     RowBox[{"INTFluxSHORT2", "//", "Simplify"}]}], ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.8630153311246767`*^9, 3.8630153349988728`*^9}, {
   3.863015590392872*^9, 3.8630161346902723`*^9}, 3.8630162323070517`*^9, {
   3.86301636373927*^9, 3.863016370369182*^9}, 3.8630566587206087`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "now", " ", "check", " ", "the", " ", "needed", " ", 
     "relations"}], ",", " ", 
    RowBox[{
     RowBox[{"namely", "\[IndentingNewLine]", 
      RowBox[{"INTFluxSHORT0", "/", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}]}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", "INTFluxSHORT1"}], "/", "k1"}], 
       "\[IndentingNewLine]", 
       RowBox[{"INTFluxSHORT0", "/", 
        RowBox[{"(", 
         RowBox[{"k1", "+", "k2"}], ")"}]}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", " ", "INTFluxSHORT2"}], "/", 
       RowBox[{"k2", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"INTFluxSHORT0", "/", 
        RowBox[{"(", 
         RowBox[{"k1", "+", "k2"}], ")"}]}], ")"}], " ", "+", " ", 
      RowBox[{"(", 
       RowBox[{"INTFluxSHORT1", "/", "k1"}], ")"}]}], ")"}], "//", "Expand"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"INTFluxSHORT0", "/", 
        RowBox[{"(", 
         RowBox[{"k1", "+", "k2"}], ")"}]}], ")"}], " ", "+", " ", 
      RowBox[{"(", 
       RowBox[{"INTFluxSHORT2", "/", "k2"}], ")"}]}], ")"}], "//", 
    "Expand"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.863016066866445*^9, 3.863016224386256*^9}, 
   3.863056658720888*^9}],

Cell[BoxData["0"], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.863016198204392*^9, 3.863016238337894*^9}, 
   3.8630163753421*^9, {3.863056645460623*^9, 3.86305665872258*^9}, 
   3.866195251985083*^9, 3.866530671219389*^9}],

Cell[BoxData["0"], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.863016198204392*^9, 3.863016238337894*^9}, 
   3.8630163753421*^9, {3.863056645460623*^9, 3.86305665872258*^9}, 
   3.866195251985083*^9, 3.86653067122869*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["8/ FUNDAMENTAL RESONANCES", "Subsubsection"]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.863497909509165*^9, 3.863497922623654*^9}, 
   3.863501073676804*^9, 3.866178885274947*^9, {3.8661790186373034`*^9, 
   3.86617901882078*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "We", " ", "check", " ", "our", " ", "rewriting", " ", "of", " ", "the", 
    " ", "kinetic", " ", "equation", " ", "using", " ", "the", " ", 
    "fundamental", " ", 
    RowBox[{"resonances", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Generic", " ", "expression", " ", "of", " ", "the", " ", "flux", " ", 
    "of", " ", "the", " ", "kinetic", " ", 
    RowBox[{"equation", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Rewriting", " ", "the", " ", "final", " ", "kinetic", " ", 
    RowBox[{"equations", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Expression", " ", "of", " ", "the", " ", "two", " ", "coupling", " ", 
    RowBox[{"coefficients", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"First", " ", "coupling", " ", 
    RowBox[{"U1", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expU1", " ", "=", " ", 
     RowBox[{
      RowBox[{"k2", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "coupling", " ", 
     RowBox[{"U2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expU2", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J", "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k1", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Expression", " ", "of", " ", "the", " ", "flux", " ", "of", " ", "the", 
      " ", "kinetic", " ", "equation"}], ",", " ", 
     RowBox[{
      RowBox[{"defined", " ", "so", " ", "that", " ", 
       RowBox[{"dF", "/", "dt"}]}], "=", 
      RowBox[{"d", "/", 
       RowBox[{
        RowBox[{"dJ", "[", "Flux", "]"}], ".", "\[IndentingNewLine]", 
        "ATTENTION"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"to", " ", "the", " ", "minus", " ", "sign", " ", "in", " ", 
       RowBox[{"PRPAP", "[", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
           RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "]"}]}], 
      "=", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}], "^", 
          RowBox[{"(", "2", ")"}]}], ")"}], "."}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FluxKineticEquation", " ", "=", " ", 
     RowBox[{"SUM", "[", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"\[Pi]", "^", 
           RowBox[{"(", "3", ")"}]}], " ", 
          RowBox[{"\[Mu]", "^", 
           RowBox[{"(", "2", ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"k1", "^", 
               RowBox[{"(", "2", ")"}]}], " ", 
              RowBox[{"(", 
               RowBox[{"k1", "+", "k2"}], ")"}]}], ")"}]}], ")"}], " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"expU1", " ", 
              RowBox[{"PRPA", "[", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                  RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
               "]"}]}], "-", " ", 
             RowBox[{"k2", " ", "expU2", " ", 
              RowBox[{"PRPAP", "[", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                  RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
               "]"}]}]}], ")"}], "^", 
           RowBox[{"(", "2", ")"}]}], " ", 
          RowBox[{"DIRAC", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k1", "+", "k2"}], ")"}], 
             RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
            RowBox[{"k1", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
            RowBox[{"k2", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k1", "+", "k2"}], ")"}], " ", 
             RowBox[{"FP", "[", "J", "]"}], " ", 
             RowBox[{"F", "[", "J1", "]"}], 
             RowBox[{"F", "[", "J2", "]"}]}], "-", 
            RowBox[{"k1", " ", 
             RowBox[{"F", "[", "J", "]"}], 
             RowBox[{"FP", "[", "J1", "]"}], 
             RowBox[{"F", "[", "J2", "]"}]}], "-", 
            RowBox[{"k2", " ", 
             RowBox[{"F", "[", "J", "]"}], 
             RowBox[{"F", "[", "J1", "]"}], 
             RowBox[{"FP", "[", "J2", "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "restrict", " ", "the", " ", "sum", " ", "only", 
      " ", "to", " ", "the", " ", "terms", " ", "for", " ", "which", " ", 
      "k1"}], ",", " ", "k2", ",", " ", 
     RowBox[{
      RowBox[{"and", " ", "k1"}], "+", 
      RowBox[{"k2", " ", "are", " ", "non"}], "-", 
      RowBox[{
       RowBox[{"zero", ".", "\[IndentingNewLine]", "We"}], " ", "also", " ", 
       "choose", " ", "a", " ", "large", " ", "bound", " ", "on", " ", "k", 
       " ", "to", " ", "make", " ", "sure", " ", "that", " ", "we", " ", "do",
        " ", "not", " ", "miss", " ", "any", " ", "terms", " ", "from", " ", 
       "the", " ", 
       RowBox[{"edges", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kmaxSUM", " ", "=", " ", "12"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FluxKineticEquation", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"FluxKineticEquation", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SUM", "[", 
            RowBox[{"A_", ",", 
             RowBox[{"{", 
              RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"k1", "\[NotEqual]", "0"}], "&&", 
                RowBox[{"k2", "\[NotEqual]", "0"}], "&&", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"k1", "+", "k2"}], ")"}], "\[NotEqual]", "0"}]}], 
               ",", "\[IndentingNewLine]", "A", ",", "\[IndentingNewLine]", 
               "True", ",", "\[IndentingNewLine]", "0"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"k1", ",", 
               RowBox[{"-", "kmaxSUM"}], ",", "kmaxSUM"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k2", ",", 
               RowBox[{"-", "kmaxSUM"}], ",", "kmaxSUM"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], ")"}], "//", "Expand"}]}], ";"}], "//",
     "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "now", " ", "assume", " ", "that", " ", "the", " ", 
     "interaction", " ", "potential", " ", "is", " ", "truncated", " ", "at", 
     " ", "a", " ", "certain", " ", "value", " ", "of", " ", 
     RowBox[{"k", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kmax", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "put", " ", "to", " ", "zero", " ", "all", " ", "the", " ", 
      "values", " ", "of", " ", "the", " ", "interaction", " ", "potential", 
      " ", "above", " ", 
      RowBox[{"kmax", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "not", " ", "to", " ", "forget", " ", "to", " ", "also", " ", "make", 
      " ", "the", " ", "replacements", " ", "for", " ", "the", " ", 
      "derivatives", " ", "of", " ", 
      RowBox[{"UPotk", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FluxKineticEquation", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"FluxKineticEquation", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"UPotk", "[", 
            RowBox[{
             RowBox[{"k_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "@", "#"}], ">", "kmax"}], "&"}], ")"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"UPotkP1", "[", 
            RowBox[{
             RowBox[{"k_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "@", "#"}], ">", "kmax"}], "&"}], ")"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"UPotkP2", "[", 
            RowBox[{
             RowBox[{"k_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "@", "#"}], ">", "kmax"}], "&"}], ")"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
           "0"}]}], "\[IndentingNewLine]", "}"}]}], ")"}], "//", "Expand"}]}],
     ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.863497970089402*^9, 3.863498362323475*^9}, 
   3.86349844105754*^9, {3.863499677407061*^9, 3.863499680061331*^9}, {
   3.863499793351679*^9, 3.8634997949350033`*^9}, {3.863500040209502*^9, 
   3.8635000403525343`*^9}, {3.863500103692563*^9, 3.863500126531826*^9}, {
   3.86350019208407*^9, 3.863500192458044*^9}, {3.863500346954842*^9, 
   3.863500349281726*^9}, {3.8635003883356953`*^9, 3.863500390470769*^9}, 
   3.86350107367767*^9, {3.8661952913592443`*^9, 3.866195297003952*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"51.18053`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.863498241470394*^9, 3.863498263681234*^9}, 
   3.863498436117762*^9, 3.863499686433564*^9, 3.863499797432385*^9, 
   3.863499934857493*^9, 3.863500046574823*^9, 3.863500148337844*^9, 
   3.863500194382983*^9, 3.863500320904295*^9, 3.86350036398532*^9, 
   3.8635004295322943`*^9, 3.8635006744605093`*^9, 3.863501073677751*^9, 
   3.866195369315024*^9, 3.866530730958692*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "We", " ", "can", " ", "now", " ", "compare", " ", "this", " ", 
    "expression", " ", "with", " ", "the", " ", "expression", " ", "obtained",
     " ", "when", " ", "the", " ", "equation", " ", "is", " ", "rewritten", 
    " ", "with", " ", "the", " ", "fundamental", " ", 
    RowBox[{"resonances", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "all", " ", "the", " ", "fundamental", " ", 
    "resonances", " ", "up", " ", "to", " ", 
    RowBox[{"kmax", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ListFundRes", " ", "=", " ", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k", ",", "kp"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "kmax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"kp", ",", "1", ",", "kmax"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "List", " ", "of", " ", "the", " ", "resonance", " ", "pairs", " ", 
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2"}], "}"}], " ", "for", " ", "a", " ", 
     "fundamental", " ", "resonance", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", "kp"}], "}"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetRes", "[", 
      RowBox[{"k_", ",", "kp_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k", ",", "kp"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k", "+", "kp"}], ",", 
         RowBox[{"-", "k"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{
          RowBox[{"-", "k"}], "-", "kp"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kp", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k", "+", "kp"}], ",", 
         RowBox[{"-", "kp"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kp", ",", 
         RowBox[{
          RowBox[{"-", "k"}], "-", "kp"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Expression", " ", "of", " ", "the", " ", "contribution", " ", "from", 
      " ", "a", " ", "given", " ", "resonance", " ", "pair", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2"}], "}"}], ".", "\[IndentingNewLine]", 
       "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "there", " ", "is", " ", "no", " ", "prefactor", " ", "in", " ", "this", 
      " ", 
      RowBox[{"expression", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"to", " ", "the", " ", "minus", " ", "sign", " ", "in", " ", 
       RowBox[{"PRPAP", "[", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
           RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "]"}]}], 
      "=", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}], "^", 
          RowBox[{"(", "2", ")"}]}], ")"}], "."}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ContribFlux", "[", 
      RowBox[{"ka_", ",", "kb_"}], "]"}], ":=", " ", 
     RowBox[{"ReplaceVariables", "[", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"k1", "^", 
               RowBox[{"(", "2", ")"}]}], " ", 
              RowBox[{"(", 
               RowBox[{"k1", "+", "k2"}], ")"}]}], ")"}]}], ")"}], " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"expU1", " ", 
              RowBox[{"PRPA", "[", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                  RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
               "]"}]}], "-", " ", 
             RowBox[{"k2", " ", "expU2", " ", 
              RowBox[{"PRPAP", "[", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                  RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
               "]"}]}]}], ")"}], "^", 
           RowBox[{"(", "2", ")"}]}], " ", 
          RowBox[{"DIRAC", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k1", "+", "k2"}], ")"}], 
             RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
            RowBox[{"k1", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
            RowBox[{"k2", " ", 
             RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k1", "+", "k2"}], ")"}], " ", 
             RowBox[{"FP", "[", "J", "]"}], " ", 
             RowBox[{"F", "[", "J1", "]"}], 
             RowBox[{"F", "[", "J2", "]"}]}], "-", 
            RowBox[{"k1", " ", 
             RowBox[{"F", "[", "J", "]"}], 
             RowBox[{"FP", "[", "J1", "]"}], 
             RowBox[{"F", "[", "J2", "]"}]}], "-", 
            RowBox[{"k2", " ", 
             RowBox[{"F", "[", "J", "]"}], 
             RowBox[{"F", "[", "J1", "]"}], 
             RowBox[{"FP", "[", "J2", "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k1", ",", "k2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ka", ",", "kb"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Flux", " ", "of", " ", "a", " ", "given", " ", "fundamental", " ", 
     "resonance", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", "kp"}], "}"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FluxFund", "[", 
      RowBox[{"k_", ",", "kp_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ContribFlux", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"GetRes", "[", 
          RowBox[{"k", ",", "kp"}], "]"}]}], ")"}], "//", "Total"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Total", " ", "flux", " ", "when", " ", "summed", " ", "over", " ", 
      "the", " ", "fundamental", " ", 
      RowBox[{"resonances", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "to", " ", "the", " ", "prefactor", " ", "that", " ", "is", " ", "2", 
      RowBox[{"\[Pi]", "^", "3"}], 
      RowBox[{"\[Mu]", "^", "2."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FluxKineticEquationFund", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", 
         RowBox[{"\[Pi]", "^", 
          RowBox[{"(", "3", ")"}]}], 
         RowBox[{"\[Mu]", "^", 
          RowBox[{"(", "2", ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"FluxFund", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
             "ListFundRes"}], ")"}], "//", "Total"}], ")"}]}], ")"}], "//", 
       "Expand"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "put", " ", "to", " ", "zero", " ", "all", " ", "the", " ", 
      "values", " ", "of", " ", "the", " ", "interaction", " ", "potential", 
      " ", "above", " ", 
      RowBox[{"kmax", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "not", " ", "to", " ", "forget", " ", "to", " ", "also", " ", "make", 
      " ", "the", " ", "replacements", " ", "for", " ", "the", " ", 
      "derivatives", " ", "of", " ", 
      RowBox[{"UPotk", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FluxKineticEquationFund", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"FluxKineticEquationFund", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"UPotk", "[", 
            RowBox[{
             RowBox[{"k_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "@", "#"}], ">", "kmax"}], "&"}], ")"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"UPotkP1", "[", 
            RowBox[{
             RowBox[{"k_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "@", "#"}], ">", "kmax"}], "&"}], ")"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"UPotkP2", "[", 
            RowBox[{
             RowBox[{"k_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "@", "#"}], ">", "kmax"}], "&"}], ")"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"Ja_", ",", "Jb_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
           "0"}]}], "\[IndentingNewLine]", "}"}]}], ")"}], "//", "Expand"}]}],
     ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.86349840118289*^9, 3.863498548417437*^9}, {
   3.863498582166498*^9, 3.863498598110729*^9}, {3.863498686871147*^9, 
   3.863498833741968*^9}, {3.863498874846642*^9, 3.863498911805731*^9}, {
   3.863499510830448*^9, 3.863499648500502*^9}, {3.863500132524805*^9, 
   3.863500140755991*^9}, 3.863500314377002*^9, {3.863500423062368*^9, 
   3.863500423704376*^9}, 3.8635010736783733`*^9, {3.866529693196806*^9, 
   3.866529710218788*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"42.889008`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{3.863499697329259*^9, 3.863499842180606*^9, 
  3.863499938129417*^9, 3.8635000499138813`*^9, 3.863500151658779*^9, 
  3.863500197968883*^9, 3.8635003242213297`*^9, 3.8635003816858664`*^9, 
  3.863500478336317*^9, 3.8635007181330643`*^9, 3.863501073678439*^9, 
  3.866195464678879*^9, 3.8665307785329857`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Checking", " ", "that", " ", "the", " ", "two", " ", "fluxes", " ", "are",
     " ", "the", " ", 
    RowBox[{"same", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"FluxKineticEquation", "-", "FluxKineticEquationFund"}], ")"}], 
     "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{"xINT_", ",", "varINT_"}], "]"}], "\[RuleDelayed]", "xINT"}], 
      "\[IndentingNewLine]", "}"}]}], ")"}], "//", "Simplify"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.863499649580249*^9, 3.863499670587503*^9}, {
   3.863499702100041*^9, 3.863499718375492*^9}, {3.863499763048561*^9, 
   3.8634997756041327`*^9}, {3.863499846797452*^9, 3.863499886876317*^9}, 
   3.863501073678548*^9}],

Cell[BoxData["0"], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.863499700212832*^9, 3.8634997157952547`*^9}, {
   3.8634997595135612`*^9, 3.863499789300642*^9}, {3.86349984407111*^9, 
   3.863499847740138*^9}, {3.8634998837726107`*^9, 3.8634998875652847`*^9}, 
   3.8634999401569443`*^9, 3.863500158007599*^9, 3.863500200166142*^9, 
   3.863500327281067*^9, 3.863500383024599*^9, 3.863500718490099*^9, 
   3.863501073678659*^9, 3.8661954753590107`*^9, 3.86653077898454*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["9/ ALTERNATIVE WRITING", "Subsubsection"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.86351146520175*^9, 3.863511484198535*^9}, 
   3.8635137315005302`*^9, {3.866178943796661*^9, 3.8661789459067583`*^9}, {
   3.8661790201328077`*^9, 3.8661790203166933`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "check", " ", "the", " ", "alternative", " ", "expression", 
     " ", "of", " ", "the", " ", "contribution", " ", "from", " ", "a", " ", 
     "resonance", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], ".", "\[IndentingNewLine]", "This"}],
      " ", "is", " ", "used", " ", "to", " ", "construct", " ", "a", " ", 
     "well"}], "-", 
    RowBox[{"posed", " ", "form", " ", "for", " ", "the", " ", "kinetic", " ", 
     RowBox[{"equation", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Initial", " ", "expression", " ", "of", " ", "the", " ", "contribution", 
    " ", "of", " ", "the", " ", "resonance", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2"}], "}"}], "."}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expU1", " ", "=", " ", 
     RowBox[{
      RowBox[{"k2", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "coupling", " ", 
     RowBox[{"U2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expU2", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J", "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k1", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Expression", " ", "of", " ", "the", " ", "flux", " ", "of", " ", "the", 
      " ", "kinetic", " ", "equation"}], ",", " ", 
     RowBox[{
      RowBox[{"defined", " ", "so", " ", "that", " ", 
       RowBox[{"dF", "/", "dt"}]}], "=", 
      RowBox[{"d", "/", 
       RowBox[{
        RowBox[{"dJ", "[", "Flux", "]"}], ".", "\[IndentingNewLine]", 
        "ATTENTION"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"to", " ", "the", " ", "minus", " ", "sign", " ", "in", " ", 
       RowBox[{"PRPAP", "[", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
           RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "]"}]}], 
      "=", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}], "^", 
          RowBox[{"(", "2", ")"}]}], ")"}], ".", "\[IndentingNewLine]", 
        "ATTENTION"}]}]}], ",", " ", 
     RowBox[{
     "this", " ", "expression", " ", "does", " ", "not", " ", "contain", " ", 
      "the", " ", "prefactor", " ", "in", " ", "2", 
      RowBox[{"\[Pi]", "^", "3"}], 
      RowBox[{"\[Mu]", "^", "2."}], "\[IndentingNewLine]", "ATTENTION"}], ",",
      " ", 
     RowBox[{
     "this", " ", "expression", " ", "naturally", " ", "does", " ", "not", 
      " ", "contain", " ", 
      RowBox[{
       RowBox[{"SUM", "[", 
        RowBox[{",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expC", " ", "=", " ", 
     RowBox[{"INT", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1", "^", 
             RowBox[{"(", "2", ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{"k1", "+", "k2"}], ")"}]}], ")"}]}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"expU1", " ", 
            RowBox[{"PRPA", "[", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
             "]"}]}], "-", " ", 
           RowBox[{"k2", " ", "expU2", " ", 
            RowBox[{"PRPAP", "[", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
             "]"}]}]}], ")"}], "^", 
         RowBox[{"(", "2", ")"}]}], " ", 
        RowBox[{"DIRAC", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k1", "+", "k2"}], ")"}], 
           RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
          RowBox[{"k1", " ", 
           RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
          RowBox[{"k2", " ", 
           RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k1", "+", "k2"}], ")"}], " ", 
           RowBox[{"FP", "[", "J", "]"}], " ", 
           RowBox[{"F", "[", "J1", "]"}], 
           RowBox[{"F", "[", "J2", "]"}]}], "-", 
          RowBox[{"k1", " ", 
           RowBox[{"F", "[", "J", "]"}], 
           RowBox[{"FP", "[", "J1", "]"}], 
           RowBox[{"F", "[", "J2", "]"}]}], "-", 
          RowBox[{"k2", " ", 
           RowBox[{"F", "[", "J", "]"}], 
           RowBox[{"F", "[", "J1", "]"}], 
           RowBox[{"FP", "[", "J2", "]"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "perform", " ", "the", " ", "replacement", " ", 
      "J1"}], "<", "_", ">", 
     RowBox[{"J2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"expC", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"INT", "[", 
           RowBox[{"xINT_", ",", "varINT_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"INT", "[", 
            RowBox[{
             RowBox[{"ReplaceVariables", "[", 
              RowBox[{"xINT", ",", 
               RowBox[{"{", 
                RowBox[{"J1", ",", "J2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"J2", ",", "J1"}], "}"}]}], "]"}], ",", "varINT"}], 
            "]"}], "/;", 
           RowBox[{"(", 
            RowBox[{"SameQ", "[", 
             RowBox[{"varINT", ",", 
              RowBox[{"{", 
               RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], ")"}], "//", "Expand"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "We", " ", "use", " ", "the", " ", "presence", " ", "of", " ", "the", 
       " ", "resonant", " ", "DIRAC", " ", "to", " ", "rewrite", " ", "the", 
       " ", "PRPA", " ", "and", " ", "PRPAP", " ", "as", " ", "a", " ", 
       "function", " ", "of", " ", 
       RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", "J1", "]"}], ".", 
       "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "write", " ", "a", " ", "new", " ", 
      "replacement", " ", "for", " ", "the", " ", "DIRAC", " ", "since", " ", 
      "the", " ", "resonance", " ", "does", " ", "not", " ", "have", " ", 
      "the", " ", "usual", " ", 
      RowBox[{"form", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesDIRACSubbar", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{"xINT_", " ", 
          RowBox[{"DIRAC", "[", 
           RowBox[{
            RowBox[{"k1", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
               RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}]}], "+", 
            RowBox[{"k2", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
               RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}]}], 
           "]"}]}], ",", "varINT_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"xINT", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                 RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}], 
               "\[RuleDelayed]", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"k2", "/", "k1"}], ")"}]}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                  RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}]}], 
              "}"}]}], ")"}], " ", 
           RowBox[{"DIRAC", "[", 
            RowBox[{
             RowBox[{"k1", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], ")"}]}], "+", 
             RowBox[{"k2", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}]}], 
            "]"}]}], ",", "varINT"}], "]"}], "/;", 
        RowBox[{"SameQ", "[", 
         RowBox[{"varINT", ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Applying", " ", "the", " ", 
      RowBox[{"rule", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{"not", " ", "to", " ", "use", " ", 
      RowBox[{"RepeatedRules", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{"expCbar", "/.", "RulesDIRACSubbar"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Using", " ", "the", " ", "scaling", " ", "relation", " ", "for", " ", 
     "PRPA", " ", "and", " ", 
     RowBox[{"PRPAP", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesScalingbar", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"PRPA", "[", 
         RowBox[{
          RowBox[{"(", "k1", ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"k2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], ")"}]}],
          "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "/", "k2"}], ")"}], 
         RowBox[{"PRPA", "[", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PRPAP", "[", 
         RowBox[{
          RowBox[{"(", "k1", ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"k2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
              RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], ")"}]}],
          "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k1", "/", "k2"}], ")"}], "^", 
          RowBox[{"(", "2", ")"}]}], 
         RowBox[{"PRPAP", "[", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"expCbar", "/.", "RulesScalingbar"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "can", " ", "now", " ", "factor", " ", "the", " ", "term", " ",
      "by", " ", "removing", " ", "the", " ", 
     RowBox[{"INT", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbarSHORT", " ", "=", " ", 
     RowBox[{"expCbar", "/.", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"INT", "[", 
         RowBox[{"xINT_", ",", "varINT_"}], "]"}], "\[RuleDelayed]", "xINT"}],
        "\[IndentingNewLine]", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Making", " ", "the", " ", 
     RowBox[{"simplification", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"expCbarSHORT", "//", "Simplify"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.863511772536343*^9, 3.8635119784418793`*^9}, {
   3.863512016389544*^9, 3.863512073956753*^9}, {3.863512382763863*^9, 
   3.86351253887068*^9}, {3.86351257067585*^9, 3.8635125723084173`*^9}, 
   3.863513731501441*^9, {3.863520400470676*^9, 3.8635204012376013`*^9}, {
   3.8661954907452297`*^9, 3.8661955212069063`*^9}, {3.8665297268923264`*^9, 
   3.866529727105459*^9}, {3.866529760798667*^9, 3.866529761733425*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["k2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"k1", "+", "k2"}], ")"}]}]], 
  RowBox[{
   RowBox[{"DIRAC", "[", 
    RowBox[{
     RowBox[{"k1", " ", 
      RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "+", 
     RowBox[{"k2", " ", 
      RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
     RowBox[{"k2", " ", 
      RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
     RowBox[{"k1", " ", 
      RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "k2"}], " ", 
      RowBox[{"F", "[", "J", "]"}], " ", 
      RowBox[{"F", "[", "J2", "]"}], " ", 
      RowBox[{"FP", "[", "J1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"F", "[", "J1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], " ", 
         RowBox[{"F", "[", "J2", "]"}], " ", 
         RowBox[{"FP", "[", "J", "]"}]}], "-", 
        RowBox[{"k1", " ", 
         RowBox[{"F", "[", "J", "]"}], " ", 
         RowBox[{"FP", "[", "J2", "]"}]}]}], ")"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"PRPA", "[", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
          RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}]], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "k2"}], " ", 
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"k2", " ", 
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"k1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k1", "+", "k2"}], ")"}], " ", 
             RowBox[{"UPotk", "[", 
              RowBox[{"k1", ",", 
               RowBox[{"{", 
                RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
             RowBox[{"UPotkP1", "[", 
              RowBox[{"k2", ",", 
               RowBox[{"{", 
                RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"k1", "+", "k2"}], ")"}], " ", 
             RowBox[{"UPotk", "[", 
              RowBox[{
               RowBox[{"k1", "+", "k2"}], ",", 
               RowBox[{"{", 
                RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
             RowBox[{"UPotkP2", "[", 
              RowBox[{"k2", ",", 
               RowBox[{"{", 
                RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "+", 
            RowBox[{"k2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"UPotk", "[", 
                 RowBox[{"k1", ",", 
                  RowBox[{"{", 
                   RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
                RowBox[{"UPotkP2", "[", 
                 RowBox[{
                  RowBox[{"k1", "+", "k2"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"UPotk", "[", 
                 RowBox[{"k2", ",", 
                  RowBox[{"{", 
                   RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
                RowBox[{"UPotkP2", "[", 
                 RowBox[{
                  RowBox[{"k1", "+", "k2"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{"k1", " ", 
       RowBox[{"PRPAP", "[", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
          RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}]], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"\[CapitalOmega]P", "[", "J", "]"}]}], "-", 
         RowBox[{"k2", " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}]}], "-", 
         RowBox[{"k1", " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}]}]}], ")"}]}]}], ")"}], 
    "2"]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{3.863513478119589*^9, 3.86351373150158*^9, 
  3.863520407002821*^9, 3.863520486694736*^9, 3.866195563350485*^9, 
  3.8665307859837103`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Comparing", " ", "this", " ", "expression", " ", "with", " ", "the", " ", 
    "one", " ", "written", " ", "in", " ", "the", " ", 
    RowBox[{"paper", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Initial", " ", "expression", " ", "of", " ", "the", " ", "contribution", 
    " ", "of", " ", "the", " ", "resonance", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2"}], "}"}], "."}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expU1bar", " ", "=", " ", 
     RowBox[{
      RowBox[{"k2", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "coupling", " ", 
     RowBox[{"U2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expU2bar", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J", "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k1", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Expression", " ", "of", " ", "the", " ", "flux", " ", "of", " ", "the", 
      " ", "kinetic", " ", "equation"}], ",", " ", 
     RowBox[{
      RowBox[{"defined", " ", "so", " ", "that", " ", 
       RowBox[{"dF", "/", "dt"}]}], "=", 
      RowBox[{"d", "/", 
       RowBox[{
        RowBox[{"dJ", "[", "Flux", "]"}], ".", "\[IndentingNewLine]", 
        "ATTENTION"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"to", " ", "the", " ", "minus", " ", "sign", " ", "in", " ", 
       RowBox[{"PRPAP", "[", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
           RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "]"}]}], 
      "=", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}], "^", 
          RowBox[{"(", "2", ")"}]}], ")"}], ".", "\[IndentingNewLine]", 
        "ATTENTION"}]}]}], ",", " ", 
     RowBox[{
     "this", " ", "expression", " ", "does", " ", "not", " ", "contain", " ", 
      "the", " ", "prefactor", " ", "in", " ", "2", 
      RowBox[{"\[Pi]", "^", "3"}], 
      RowBox[{"\[Mu]", "^", "2."}], "\[IndentingNewLine]", "ATTENTION"}], ",",
      " ", 
     RowBox[{
     "this", " ", "expression", " ", "naturally", " ", "does", " ", "not", 
      " ", "contain", " ", 
      RowBox[{
       RowBox[{"SUM", "[", 
        RowBox[{",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbarWRITE", " ", "=", " ", 
     RowBox[{"INT", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k2", "^", 
             RowBox[{"(", "2", ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{"k1", "+", "k2"}], ")"}]}], ")"}]}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"expU1bar", " ", 
            RowBox[{"PRPA", "[", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
             "]"}]}], "+", " ", 
           RowBox[{"k1", " ", "expU2bar", " ", 
            RowBox[{"PRPAP", "[", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
                RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], 
             "]"}]}]}], ")"}], "^", 
         RowBox[{"(", "2", ")"}]}], " ", 
        RowBox[{"DIRAC", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k1", "+", "k2"}], ")"}], 
           RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
          RowBox[{"k1", " ", 
           RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], "-", 
          RowBox[{"k2", " ", 
           RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k1", "+", "k2"}], ")"}], " ", 
           RowBox[{"FP", "[", "J", "]"}], " ", 
           RowBox[{"F", "[", "J1", "]"}], 
           RowBox[{"F", "[", "J2", "]"}]}], "-", 
          RowBox[{"k1", " ", 
           RowBox[{"F", "[", "J", "]"}], 
           RowBox[{"FP", "[", "J2", "]"}], 
           RowBox[{"F", "[", "J1", "]"}]}], "-", 
          RowBox[{"k2", " ", 
           RowBox[{"F", "[", "J", "]"}], 
           RowBox[{"F", "[", "J2", "]"}], 
           RowBox[{"FP", "[", "J1", "]"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.863512574827634*^9, 3.863512586345619*^9}, {
   3.863513346496962*^9, 3.863513435391644*^9}, {3.863513525171884*^9, 
   3.863513525995277*^9}, 3.863513731502087*^9, {3.863520420831427*^9, 
   3.863520427741997*^9}, {3.866195568044819*^9, 3.866195568419015*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Checking", " ", "that", " ", "the", " ", "two", " ", "expressions", " ", 
    "are", " ", "the", " ", 
    RowBox[{"same", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"expCbarSHORT", "-", "expCbarWRITE"}], ")"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{"xINT_", ",", "varINT_"}], "]"}], "\[RuleDelayed]", "xINT"}], 
      "\[IndentingNewLine]", "}"}]}], ")"}], "//", "Simplify"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.863513441481971*^9, 3.863513460015539*^9}, {
  3.8635134990415707`*^9, 3.863513500095422*^9}, {3.8635137173567533`*^9, 
  3.863513731502206*^9}}],

Cell[BoxData["0"], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{
  3.863513460323494*^9, {3.863513500943304*^9, 3.8635135277096567`*^9}, {
   3.863513724052093*^9, 3.863513731502302*^9}, {3.863520425629792*^9, 
   3.863520429154365*^9}, 3.863520510529728*^9, 3.866195579634934*^9, 
   3.866530797191394*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["10/ WELL-POSEDNESS", "Subsubsection"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.863515436300459*^9, 3.8635154526565332`*^9}, 
   3.863605523290002*^9, {3.866178947682403*^9, 3.866178950626981*^9}, {
   3.866179021365501*^9, 3.8661790225413637`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Non", "-", 
    RowBox[{
    "reversed", " ", "expression", " ", "of", " ", "the", " ", "contribution",
      " ", "from", " ", "resonance", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], "."}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Initial", " ", "expression", " ", "of", " ", "the", " ", "contribution", 
    " ", "of", " ", "the", " ", "resonance", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2"}], "}"}], "."}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expU1", " ", "=", " ", 
     RowBox[{
      RowBox[{"k2", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "coupling", " ", 
     RowBox[{"U2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expU2", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J", "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k1", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expC", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1", "^", 
           RowBox[{"(", "2", ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}]}], ")"}]}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"expU1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], "+", " ", 
         
         RowBox[{"k2", " ", "expU2"}]}], ")"}], "^", 
       RowBox[{"(", "2", ")"}]}], " ", 
      RowBox[{"DIRAC", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], 
         RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
        RowBox[{"k1", " ", 
         RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], " ", 
         RowBox[{"FP", "[", "J", "]"}], " ", 
         RowBox[{"F", "[", "J1", "]"}], 
         RowBox[{"F", "[", "J2", "]"}]}], "-", 
        RowBox[{"k1", " ", 
         RowBox[{"F", "[", "J", "]"}], 
         RowBox[{"FP", "[", "J1", "]"}], 
         RowBox[{"F", "[", "J2", "]"}]}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"F", "[", "J", "]"}], 
         RowBox[{"F", "[", "J1", "]"}], 
         RowBox[{"FP", "[", "J2", "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Reversed", " ", "expression", " ", "of", " ", "the", " ", "contribution",
      " ", "from", " ", "resonance", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2"}], "}"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expU1bar", " ", "=", " ", 
     RowBox[{
      RowBox[{"k2", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
      "\[IndentingNewLine]", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "coupling", " ", 
     RowBox[{"U2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expU2bar", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J", "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k1", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k2", "^", 
           RowBox[{"(", "2", ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}]}], ")"}]}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"expU1bar", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
            RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}]}], " ", "-", 
         " ", 
         RowBox[{"k1", " ", "expU2bar"}]}], ")"}], "^", 
       RowBox[{"(", "2", ")"}]}], " ", 
      RowBox[{"DIRAC", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], 
         RowBox[{"\[CapitalOmega]", "[", "J", "]"}]}], "-", 
        RowBox[{"k1", " ", 
         RowBox[{"\[CapitalOmega]", "[", "J2", "]"}]}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], " ", 
         RowBox[{"FP", "[", "J", "]"}], " ", 
         RowBox[{"F", "[", "J1", "]"}], 
         RowBox[{"F", "[", "J2", "]"}]}], "-", 
        RowBox[{"k1", " ", 
         RowBox[{"F", "[", "J", "]"}], 
         RowBox[{"FP", "[", "J2", "]"}], 
         RowBox[{"F", "[", "J1", "]"}]}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"F", "[", "J", "]"}], 
         RowBox[{"F", "[", "J2", "]"}], 
         RowBox[{"FP", "[", "J1", "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "must", " ", "now", " ", "rewrite", " ", "these", " ", 
      "expressions", " ", "as", " ", "functions", " ", "of", " ", 
      "\[CapitalOmega]"}], ",", " ", "\[CapitalOmega]1", ",", " ", 
     RowBox[{"and", " ", 
      RowBox[{"\[CapitalOmega]2", ".", "\[IndentingNewLine]", "Indeed"}]}], 
     ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "in", " ", "these", " ", "variables", " ", "that", 
      " ", "the", " ", "resonance", " ", "condition", " ", "is", " ", "the", 
      " ", "simplest", " ", "to", " ", 
      RowBox[{"solve", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", ",", " ", 
     RowBox[{"we", " ", "replace", " ", 
      RowBox[{"\[CapitalOmega]", "[", "J", "]"}], " ", "by", " ", 
      RowBox[{"\[CapitalOmega]", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rule\[CapitalOmega]ofJ", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "\[RuleDelayed]", 
        "\[CapitalOmega]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "J1", "]"}], "\[RuleDelayed]", 
        "\[CapitalOmega]1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "J2", "]"}], "\[RuleDelayed]", 
        "\[CapitalOmega]2"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expC", " ", "=", " ", 
     RowBox[{"expC", "/.", "Rule\[CapitalOmega]ofJ"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{"expCbar", "/.", "Rule\[CapitalOmega]ofJ"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Now", ",", " ", 
     RowBox[{
     "we", " ", "interpret", " ", "J", " ", "as", " ", "a", " ", "function", 
      " ", "of", " ", 
      RowBox[{"\[CapitalOmega]", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleJto\[CapitalOmega]", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"J", "\[RuleDelayed]", "\[CapitalOmega]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"J1", "\[RuleDelayed]", "\[CapitalOmega]1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"J2", "\[RuleDelayed]", "\[CapitalOmega]2"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expC", " ", "=", " ", 
     RowBox[{"expC", "/.", "RuleJto\[CapitalOmega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{"expCbar", "/.", "RuleJto\[CapitalOmega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "must", " ", "now", " ", "deal", " ", "with", " ", "the", " ",
       "derivatives", " ", 
      RowBox[{
      "w", ".", "r", ".", "t", ".", " ", "J", ".", "\[IndentingNewLine]", 
       "For"}], " ", "example"}], ",", " ", 
     RowBox[{
      RowBox[{"we", " ", "have", " ", 
       RowBox[{"FP", "[", "J", "]"}]}], "=", 
      RowBox[{
       RowBox[{"d", "/", 
        RowBox[{"dJ", "[", 
         RowBox[{"F", "[", "J", "]"}], "]"}]}], "=", 
       RowBox[{
        RowBox[{"d", "/", 
         RowBox[{"dJ", "[", 
          RowBox[{"F", "[", 
           RowBox[{"J", "[", "\[CapitalOmega]", "]"}], "]"}], "]"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d\[CapitalOmega]", "/", "dJ"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dF", "/", "d\[CapitalOmega]"}], ")"}]}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"dJ", "/", "d\[CapitalOmega]"}], ")"}]}], ")"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dF", "/", "d\[CapitalOmega]"}], ")"}], ".", 
           "\[IndentingNewLine]", "ATTENTION"}]}]}]}]}]}], ",", " ", 
     RowBox[{
     "we", " ", "also", " ", "write", " ", "the", " ", "derivative", " ", 
      "operator", " ", "using", " ", "MMA", " ", "notations"}], ",", " ", 
     RowBox[{
     "as", " ", "we", " ", "will", " ", "subsequently", " ", "want", " ", 
      "to", " ", "perform", " ", "limited", " ", 
      RowBox[{"developments", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
     ",", " ", 
     RowBox[{
     "we", " ", "also", " ", "do", " ", "not", " ", "use", " ", "the", " ", 
      "function", " ", "UPotk", " ", "anymore"}], ",", " ", 
     RowBox[{
     "as", " ", "we", " ", "do", " ", "not", " ", "want", " ", "any", " ", 
      "of", " ", "the", " ", "automatic", " ", "rule", " ", "to", " ", "make",
       " ", "any", " ", "unwanted", " ", 
      RowBox[{"simplifications", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleDERof\[CapitalOmega]", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FP", "[", "\[CapitalOmega]_", "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          RowBox[{"F", "'"}], "[", "\[CapitalOmega]", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", "'"}], "[", "\[CapitalOmega]", "]"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]P", "[", "\[CapitalOmega]_", "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", "'"}], "[", "\[CapitalOmega]", "]"}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UPotk", "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]a_", ",", "\[CapitalOmega]b_"}], "}"}]}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{"Ulim", "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]a", ",", "\[CapitalOmega]b"}], "}"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UPotkP1", "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]a_", ",", "\[CapitalOmega]b_"}], "}"}]}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         SuperscriptBox["Ulim", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]a", ",", "\[CapitalOmega]b"}], "}"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UPotkP2", "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]a_", ",", "\[CapitalOmega]b_"}], "}"}]}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         SuperscriptBox["Ulim", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]a", ",", "\[CapitalOmega]b"}], "}"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expC", " ", "=", " ", 
     RowBox[{"expC", "/.", "RuleDERof\[CapitalOmega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{"expCbar", "/.", "RuleDERof\[CapitalOmega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ATTENTION", ",", " ", 
     RowBox[{
      RowBox[{
      "since", " ", "we", " ", "have", " ", "changed", " ", "the", " ", 
       "integration", " ", "from", "\[IndentingNewLine]", 
       RowBox[{"INT", "[", 
        RowBox[{"xx", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], "=", 
      RowBox[{
       RowBox[{"INT", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"J", "'"}], "[", "\[CapitalOmega]1", "]"}], 
          RowBox[{
           RowBox[{"J", "'"}], "[", "\[CapitalOmega]2", "]"}], " ", "xx"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[CapitalOmega]1", ",", "\[CapitalOmega]2"}], "}"}]}], 
        "]"}], ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "there", " ", "is", " ", "no", " ", "need", " ", "for", " ", "an", " ", 
       "absolute", " ", "value", " ", "since", " ", "the", " ", "mapping", 
       " ", "\[CapitalOmega]"}], "\[Rule]", 
      RowBox[{"J", " ", "is", " ", "monotonic"}]}], ",", " ", 
     RowBox[{"and", " ", "here", " ", "appears", " ", 
      RowBox[{"twice", ".", "\[IndentingNewLine]", "We"}], " ", "multiply", 
      " ", "the", " ", "expressions", " ", "of", " ", "the", " ", 
      "contributions", " ", "with", " ", "this", " ", "outside", " ", 
      RowBox[{"Jacobian", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expC", " ", "=", " ", 
     RowBox[{"expC", " ", 
      RowBox[{
       RowBox[{"J", "'"}], "[", "\[CapitalOmega]1", "]"}], " ", 
      RowBox[{
       RowBox[{"J", "'"}], "[", "\[CapitalOmega]2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{"expCbar", " ", 
      RowBox[{
       RowBox[{"J", "'"}], "[", "\[CapitalOmega]1", "]"}], 
      RowBox[{
       RowBox[{"J", "'"}], "[", "\[CapitalOmega]2", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"In", " ", "the", " ", "two", " ", "expressions"}], ",", " ", 
     RowBox[{
     "we", " ", "can", " ", "now", " ", "replace", " ", "\[CapitalOmega]2", 
      " ", "by", " ", "its", " ", "resonant", " ", 
      RowBox[{"location", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "when", " ", "solving", " ", "the", " ", "resonance", " ", "condition", 
      " ", "we", " ", "must", " ", "not", " ", "forget", " ", "the", " ", 
      RowBox[{"Abs", "[", "ki", "]"}], " ", "factors", " ", "that", " ", 
      "come", " ", "from", " ", "the", " ", 
      RowBox[{"DIRAC", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Expression", " ", "of", " ", "\[CapitalOmega]2", " ", "in", " ", 
      RowBox[{"expC", ".", "\[IndentingNewLine]", "In"}], " ", "expC"}], ",", 
     " ", 
     RowBox[{"the", " ", "resonance", " ", "condition", " ", "is", " ", 
      RowBox[{
       RowBox[{"DIRAC", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}], "\[CapitalOmega]"}], "-", 
         "k1\[CapitalOmega]1", "-", "k2\[CapitalOmega]2"}], "]"}], "."}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exp\[CapitalOmega]2C", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], "\[CapitalOmega]"}], "-", 
        RowBox[{"k1", " ", "\[CapitalOmega]1"}]}], ")"}], "/", 
      RowBox[{"(", "k2", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Expression", " ", "of", " ", "\[CapitalOmega]2", " ", "in", " ", 
      RowBox[{"expCbar", ".", "\[IndentingNewLine]", "In"}], " ", "expCbar"}],
      ",", " ", 
     RowBox[{
     "the", " ", "resonance", " ", "condition", " ", "is", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DIRAC", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"k1", "+", "k2"}], ")"}], "\[CapitalOmega]"}], "-", 
         "k1\[CapitalOmega]2", "-", "k2\[CapitalOmega]1"}], "]"}], "."}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exp\[CapitalOmega]2Cbar", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], "\[CapitalOmega]"}], " ", "-", 
        " ", 
        RowBox[{"k2", " ", "\[CapitalOmega]1"}]}], ")"}], "/", 
      RowBox[{"(", "k1", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"First", ",", " ", 
     RowBox[{"we", " ", "remove", " ", "the", " ", "unneeded", " ", 
      RowBox[{"DIRAC", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleRemoveDIRAC", " ", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DIRAC", "[", "_", "]"}], "\[RuleDelayed]", "1"}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", ".", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expC", " ", "=", " ", 
     RowBox[{"expC", "/.", "RuleRemoveDIRAC"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{"expCbar", "/.", "RuleRemoveDIRAC"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Making", " ", "the", " ", "replacement", " ", "with", " ", "the", " ", 
     "expressions", " ", "of", " ", "the", " ", "resonant", " ", 
     RowBox[{"\[CapitalOmega]2", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expC", " ", "=", " ", 
     RowBox[{"ReplaceVariables", "[", 
      RowBox[{"expC", ",", 
       RowBox[{"{", "\[CapitalOmega]2", "}"}], ",", 
       RowBox[{"{", "exp\[CapitalOmega]2C", "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{"ReplaceVariables", "[", 
      RowBox[{"expCbar", ",", 
       RowBox[{"{", "\[CapitalOmega]2", "}"}], ",", 
       RowBox[{"{", "exp\[CapitalOmega]2Cbar", "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Putting", " ", "the", " ", "prefactors", " ", "in", " ", 
     RowBox[{"Abs", "[", "ki", "]"}], " ", "coming", " ", "from", " ", "the", 
     " ", "resonance", " ", 
     RowBox[{"conditions", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"expC", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{"expC", "/", 
         RowBox[{"(", 
          RowBox[{"Abs", "[", "k2", "]"}], ")"}]}], ")"}]}], ";"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"expCbar", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{"expCbar", "/", 
         RowBox[{"(", 
          RowBox[{"Abs", "[", "k1", "]"}], ")"}]}], ")"}]}], ";"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "are", " ", "interested", " ", "in", " ", "the", " ", 
      "behaviour", " ", "of", " ", "the", " ", "integrand", " ", "in", " ", 
      "the", " ", "vicinity", " ", "of", " ", "\[CapitalOmega]1"}], "\[Rule]", 
     RowBox[{"\[CapitalOmega]", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rule\[Delta]\[CapitalOmega]", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]1", "\[RuleDelayed]", 
       RowBox[{"\[CapitalOmega]", "+", "\[Delta]\[CapitalOmega]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expC", " ", "=", " ", 
     RowBox[{"expC", "/.", "Rule\[Delta]\[CapitalOmega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expCbar", " ", "=", " ", 
     RowBox[{"expCbar", "/.", "Rule\[Delta]\[CapitalOmega]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "are", " ", "now", " ", "ready", " ", "to", " ", "look", " ", 
     "at", " ", "the", " ", "contribution", " ", "from", " ", "a", " ", 
     "given", " ", "fundamental", " ", 
     RowBox[{"resonance", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "List", " ", "of", " ", "the", " ", "resonance", " ", "pairs", " ", 
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2"}], "}"}], " ", "associated", " ", "with", " ", 
     "a", " ", "fundamental", " ", "resonance", " ", "of", " ", "the", " ", 
     "form", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", "kp"}], "}"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListRes", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k", ",", "kp"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kp", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k", "+", "kp"}], ",", 
         RowBox[{"-", "k"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k", "+", "kp"}], ",", 
         RowBox[{"-", "kp"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{
          RowBox[{"-", "k"}], "-", "kp"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"kp", ",", 
         RowBox[{
          RowBox[{"-", "k"}], "-", "kp"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Now", ",", " ", 
     RowBox[{"for", " ", "every", " ", "resonance", " ", "pair"}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "decide", " ", "which", " ", 
      "rewriting", " ", "we", " ", "consider", " ", "among", " ", "expC", " ",
       "and", " ", 
      RowBox[{"expCbar", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ChoiceWeights", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Alpha]", " ", "expC"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Alpha]"}], ")"}], "expCbar"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]", " ", "expC"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Alpha]"}], ")"}], "expCbar"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Beta]", " ", "expC"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]"}], ")"}], "expCbar"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Beta]", " ", "expC"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]"}], ")"}], "expCbar"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]", " ", "expC"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Gamma]"}], ")"}], " ", "expCbar"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]", " ", "expC"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Gamma]"}], ")"}], " ", "expCbar"}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Flux", " ", "associated", " ", "with", " ", "a", " ", "given", " ", 
     "fundamental", " ", 
     RowBox[{"resonance", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FluxRewrite", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplaceVariables", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", "k2"}], "}"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ChoiceWeights", ",", "ListRes"}], "}"}], "//", 
          "Transpose"}], ")"}]}], ")"}], "//", "Total"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "now", " ", "use", " ", "our", " ", "assumption", " ", "that",
       " ", "0"}], "<", 
     RowBox[{"k", " ", "and", " ", "0"}], "<", 
     RowBox[{"kp", " ", "to", " ", "simplify", " ", "the", " ", 
      RowBox[{"Abs", "[", "..", "]"}], " ", "that", " ", "are", " ", 
      RowBox[{"present", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RulesAbskkp", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "k", "]"}], "\[RuleDelayed]", "k"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"-", "k"}], "]"}], "\[RuleDelayed]", "k"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Abs", "[", "kp", "]"}], "\[RuleDelayed]", "kp"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"-", "kp"}], "]"}], "\[RuleDelayed]", "kp"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"k", "+", "kp"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"k", "+", "kp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"-", "k"}], "-", "kp"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"k", "+", "kp"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FluxRewrite", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"FluxRewrite", "/.", "RulesAbskkp"}], ")"}], "//", 
      "Expand"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "can", " ", "now", " ", "finally", " ", "make", " ", "a", " ",
       "limited", " ", "development", " ", "and", " ", "check", " ", "that"}],
      ",", " ", "indeed", ",", " ", 
     RowBox[{"it", " ", "scales", " ", "like", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "\[Delta]\[CapitalOmega]", ")"}], "^", 
        RowBox[{"(", "3", ")"}]}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Before", " ", "making", " ", "the", " ", "development"}], ",", 
     " ", 
     RowBox[{
     "we", " ", "teach", " ", "MMA", " ", "a", " ", "few", " ", "rules", " ", 
      "about", " ", "the", " ", "function", " ", 
      RowBox[{
       RowBox[{"Ulim", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], ".", 
       "\[IndentingNewLine]", "In"}], " ", "particular"}], ",", " ", 
     RowBox[{
     "this", " ", "function", " ", "is", " ", "independent", " ", "of", " ", 
      "the", " ", "sign", " ", "of", " ", 
      RowBox[{"k", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleUlimSignk", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Ulim", "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]1_", ",", "\[CapitalOmega]2_"}], "}"}]}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"Ulim", "[", 
          RowBox[{
           RowBox[{"-", "k"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalOmega]1", ",", "\[CapitalOmega]2"}], "}"}]}], 
          "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{"Internal`SyntacticNegativeQ", "[", "k", "]"}], ")"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SuperscriptBox["Ulim", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]1_", ",", "\[CapitalOmega]2_"}], "}"}]}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Ulim", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"-", "k"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalOmega]1", ",", "\[CapitalOmega]2"}], "}"}]}], 
          "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{"Internal`SyntacticNegativeQ", "[", "k", "]"}], ")"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SuperscriptBox["Ulim", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"k_", ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]1_", ",", "\[CapitalOmega]2_"}], "}"}]}], 
         "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Ulim", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           RowBox[{"-", "k"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalOmega]1", ",", "\[CapitalOmega]2"}], "}"}]}], 
          "]"}], "/;", 
         RowBox[{"(", 
          RowBox[{"Internal`SyntacticNegativeQ", "[", "k", "]"}], ")"}]}]}]}],
       "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FluxRewrite", " ", "=", " ", 
     RowBox[{"FluxRewrite", "//.", "RuleUlimSignk"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "order", " ", "to", " ", "accelerate", " ", "the", " ", 
      "application", " ", "of", " ", "the", " ", "limited", " ", 
      "development"}], ",", " ", 
     RowBox[{"we", " ", "use", " ", "parallelisation"}], ",", " ", 
     RowBox[{
     "and", " ", "apply", " ", "it", " ", "to", " ", "the", " ", "terms", " ", 
      RowBox[{"individually", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FluxRewriteExpansion", " ", "=", " ", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"\[Delta]\[CapitalOmega]", ",", "0", ",", "2"}], "}"}]}], 
          "]"}], "&"}], ",", 
        RowBox[{"List", "@@", 
         RowBox[{"(", 
          RowBox[{"FluxRewrite", "//", "Expand"}], ")"}]}]}], "]"}]}], ";"}], 
    "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "apply", " ", "a", " ", "rule", " ", "to", " ", "tell", " ", 
      "MMA", " ", "that", " ", 
      RowBox[{"Ulim", "[", 
       RowBox[{"k_", ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]1", ",", "\[CapitalOmega]2"}], "}"}]}], 
       "]"}], " ", "is", " ", "symmetric", " ", 
      RowBox[{"w", ".", "r", ".", "t", ".", " ", "its"}], " ", 
      RowBox[{"arguments", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
     " ", 
     RowBox[{
     "here", " ", "we", " ", "apply", " ", "the", " ", "rule", " ", "to", " ",
       "the", " ", "case", " ", "where", " ", "the", " ", "two", " ", 
      "arguments", " ", "are", " ", "the", " ", "same"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "to"}], " ", 
      RowBox[{"Ulim", "[", 
       RowBox[{"k_", ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]"}], "}"}]}], 
       "]"}]}], ",", " ", 
     RowBox[{
     "which", " ", "is", " ", "what", " ", "appears", " ", "in", " ", "the", 
      " ", "limited", " ", 
      RowBox[{"development", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RuleSymUlimDER", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"0", ",", "l_"}], "]"}], "[", "Ulim", "]"}], "[", 
        RowBox[{"k_", ",", 
         RowBox[{"{", 
          RowBox[{"\[CapitalOmega]_", ",", "\[CapitalOmega]_"}], "}"}]}], 
        "]"}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Sort", "[", 
             RowBox[{"l", ",", "Greater"}], "]"}]}], "]"}], "[", "Ulim", 
          "]"}], "[", 
         RowBox[{"k", ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]"}], "}"}]}], 
         "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"UnsameQ", "[", 
          RowBox[{"l", ",", 
           RowBox[{"Sort", "[", 
            RowBox[{"l", ",", "Greater"}], "]"}]}], "]"}], ")"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Applying", " ", "the", " ", 
     RowBox[{"rule", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FluxRewriteExpansion", " ", "=", " ", 
      RowBox[{"FluxRewriteExpansion", "/.", "RuleSymUlimDER"}]}], ";"}], "//",
     "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "make", " ", "a", " ", "first", " ", "round", " ", "of", " ", 
     RowBox[{"simplification", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FluxRewriteExpansion", " ", "=", " ", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{"Simplify", ",", "FluxRewriteExpansion"}], "]"}]}], ";"}], "//",
     "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "then", " ", "replace", " ", "the", " ", "list", " ", "with", 
     " ", "a", " ", 
     RowBox[{"sum", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FluxRewriteExpansion", " ", "=", " ", 
      RowBox[{"Plus", "@@", "FluxRewriteExpansion"}]}], ";"}], "//", 
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Performing", " ", "a", " ", "final", " ", 
     RowBox[{"simplification", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FluxRewriteExpansion", " ", "=", " ", 
      RowBox[{"FluxRewriteExpansion", "//", "Simplify"}]}], ";"}], "//", 
    "AbsoluteTiming"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.863515836226088*^9, 3.863516093652833*^9}, {
   3.863516231140965*^9, 3.863516280078897*^9}, {3.863516314616926*^9, 
   3.863516316712029*^9}, {3.8635163511199512`*^9, 3.863516370960228*^9}, {
   3.8635164298811417`*^9, 3.8635164472729197`*^9}, {3.863516498700482*^9, 
   3.863516650758992*^9}, {3.863516718129366*^9, 3.8635167191262207`*^9}, {
   3.863517101027233*^9, 3.8635171740201063`*^9}, {3.863517766103528*^9, 
   3.863518071025689*^9}, {3.863518114338401*^9, 3.863518152892805*^9}, {
   3.8635181836900673`*^9, 3.8635184853970327`*^9}, {3.8635185164314137`*^9, 
   3.863518758428494*^9}, {3.8635188852007103`*^9, 3.863518919046982*^9}, 
   3.863518951689835*^9, {3.863518989154954*^9, 3.863519056732109*^9}, {
   3.863519190490258*^9, 3.863519206386651*^9}, {3.863519482609767*^9, 
   3.863519483169578*^9}, {3.8635195244413347`*^9, 3.86351958902046*^9}, {
   3.863519631205908*^9, 3.8635196365940866`*^9}, {3.86351971100772*^9, 
   3.8635197125894623`*^9}, {3.863519843544176*^9, 3.86352007307882*^9}, {
   3.863520522149725*^9, 3.863520522267932*^9}, {3.863527811651239*^9, 
   3.8635278372884398`*^9}, {3.8635279460536213`*^9, 3.863528062169945*^9}, {
   3.863528092808613*^9, 3.863528096125475*^9}, {3.86352812813197*^9, 
   3.863528128979602*^9}, {3.8635283783100557`*^9, 3.86352838255337*^9}, {
   3.863528427277033*^9, 3.863528430829142*^9}, {3.863528543991701*^9, 
   3.863528611349826*^9}, {3.8635286535089607`*^9, 3.863529102349038*^9}, 
   3.863529149450495*^9, 3.863529198944152*^9, {3.863529364293807*^9, 
   3.8635294543922586`*^9}, {3.863530003597642*^9, 3.8635300416874533`*^9}, {
   3.863530073369375*^9, 3.86353010135852*^9}, {3.8635303093901157`*^9, 
   3.863530440418456*^9}, 3.863530488625456*^9, {3.863530925996112*^9, 
   3.863530947091902*^9}, {3.863531035945174*^9, 3.863531040541917*^9}, {
   3.86353154781075*^9, 3.863531661253776*^9}, {3.863531694728208*^9, 
   3.86353180152636*^9}, 3.863532134333789*^9, {3.863532472925651*^9, 
   3.863532475356091*^9}, {3.8635335478339777`*^9, 3.863533714365238*^9}, 
   3.86353375926091*^9, {3.863533868687656*^9, 3.863533869687542*^9}, {
   3.863533909938097*^9, 3.863533910114429*^9}, 3.863533966058229*^9, {
   3.863535331926928*^9, 3.863535354462965*^9}, 3.863537554784306*^9, {
   3.863537651668868*^9, 3.863537666786091*^9}, {3.8635377107127943`*^9, 
   3.8635377519905043`*^9}, {3.863537852210191*^9, 3.863537966113233*^9}, {
   3.863537999368062*^9, 3.863538019882509*^9}, {3.863538107693944*^9, 
   3.8635381114240417`*^9}, {3.863538298163217*^9, 3.863538313858634*^9}, {
   3.863538353549096*^9, 3.863538365036755*^9}, {3.8635384214361143`*^9, 
   3.8635384429643717`*^9}, {3.863538574136302*^9, 3.863538588369083*^9}, {
   3.863541776803589*^9, 3.863541843557643*^9}, 3.863542537549005*^9, {
   3.8635425776835413`*^9, 3.863542600990178*^9}, {3.8635427754150257`*^9, 
   3.8635427877904043`*^9}, {3.863602166079567*^9, 3.86360216672334*^9}, {
   3.863605132570463*^9, 3.863605140898435*^9}, 3.86360552329224*^9, {
   3.8657790999331837`*^9, 3.8657791058444443`*^9}, {3.8661956184934587`*^9, 
   3.8661956187607737`*^9}, 3.866195699748855*^9, {3.8665298372246437`*^9, 
   3.866529837567535*^9}, {3.86652996905866*^9, 3.86653000164607*^9}, {
   3.866530842375855*^9, 3.866530842581077*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"34.404915`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.863542980207532*^9, 3.863605523292376*^9, 
  3.865779281214314*^9, 3.865846623905154*^9, 3.866195756126276*^9, 
  3.86653088198522*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.905362`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.863542980207532*^9, 3.863605523292376*^9, 
  3.865779281214314*^9, 3.865846623905154*^9, 3.866195756126276*^9, 
  3.866530882893249*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"129.977777`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.863542980207532*^9, 3.863605523292376*^9, 
  3.865779281214314*^9, 3.865846623905154*^9, 3.866195756126276*^9, 
  3.8665310128731833`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"42.53247`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.863542980207532*^9, 3.863605523292376*^9, 
  3.865779281214314*^9, 3.865846623905154*^9, 3.866195756126276*^9, 
  3.866531055405085*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"32.115047`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.863542980207532*^9, 3.863605523292376*^9, 
  3.865779281214314*^9, 3.865846623905154*^9, 3.866195756126276*^9, 
  3.866531087521213*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Dumping", " ", "the", " ", "expression", " ", "for", " ", "easy", " ", 
    "later", " ", 
    RowBox[{"use", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<FluxRewriteExpansion.mx\>\""}], ",", "FluxRewriteExpansion", ",", 
      "\"\<MX\>\""}], "]"}], ";"}], "//", "AbsoluteTiming"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.862306879647386*^9, 3.8623068998937483`*^9}, {
   3.862999522359448*^9, 3.8629995354699297`*^9}, {3.863000567571867*^9, 
   3.863000573281578*^9}, {3.8630012704206553`*^9, 3.863001275082837*^9}, 
   3.863016405247438*^9, {3.863542636795355*^9, 3.863542650746085*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.024566`", ",", "Null"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.863546341135602*^9, 3.8636055232926893`*^9, 
  3.865847823272029*^9, 3.8661960001012383`*^9, 3.866531096497424*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Having", " ", "expanded", " ", "the", " ", "expression"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "we", " ", "can", " ", "now", " ", "look", " ", "carefully", " ", "at", 
      " ", "it", " ", "to", " ", "try", " ", "and", " ", "determine", " ", 
      "the", " ", "combinations", " ", "of", " ", "weights", " ", "that", " ",
       "must", " ", "give", " ", "zero", " ", "for", " ", "the", " ", 
      "second"}], "-", 
     RowBox[{"order", " ", "term", " ", "to", " ", 
      RowBox[{"vanish", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  "FluxRewriteExpansion"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.863605358905257*^9, 3.8636053589610767`*^9}, 
   3.8636055232928257`*^9, {3.86653102641158*^9, 3.866531026540967*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"k", " ", "kp", " ", 
         RowBox[{"(", 
          RowBox[{"k", "+", "kp"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["J", "\[Prime]",
            MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], "3"]}], 
        ")"}]}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "k", " ", "kp"}], "+", 
          RowBox[{
           SuperscriptBox["k", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", "-", "\[Gamma]"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["kp", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", "-", "\[Gamma]"}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k", " ", 
            RowBox[{"Ulim", "[", 
             RowBox[{"kp", ",", 
              RowBox[{"{", 
               RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]"}], "}"}]}], 
             "]"}], " ", 
            RowBox[{"Ulim", "[", 
             RowBox[{
              RowBox[{"k", "+", "kp"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]"}], "}"}]}], 
             "]"}]}], "-", 
           RowBox[{
            RowBox[{"Ulim", "[", 
             RowBox[{"k", ",", 
              RowBox[{"{", 
               RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]"}], "}"}]}], 
             "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"k", "+", "kp"}], ")"}], " ", 
               RowBox[{"Ulim", "[", 
                RowBox[{"kp", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]"}], 
                  "}"}]}], "]"}]}], "-", 
              RowBox[{"kp", " ", 
               RowBox[{"Ulim", "[", 
                RowBox[{
                 RowBox[{"k", "+", "kp"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[CapitalOmega]", ",", "\[CapitalOmega]"}], 
                  "}"}]}], "]"}]}]}], ")"}]}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["F", "\[Prime]",
              MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], "3"], 
           " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["J", "\[Prime]",
              MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], "2"]}],
           "+", 
          RowBox[{"2", " ", 
           RowBox[{"F", "[", "\[CapitalOmega]", "]"}], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["F", "\[Prime]",
              MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], "2"], 
           " ", 
           RowBox[{
            SuperscriptBox["J", "\[Prime]",
             MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["J", "\[Prime]\[Prime]",
             MultilineFunction->None], "[", "\[CapitalOmega]", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"F", "[", "\[CapitalOmega]", "]"}], "2"], " ", 
           RowBox[{
            SuperscriptBox["J", "\[Prime]",
             MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              RowBox[{
               SuperscriptBox["F", "\[Prime]\[Prime]",
                MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], " ", 
              
              RowBox[{
               SuperscriptBox["J", "\[Prime]\[Prime]",
                MultilineFunction->None], "[", "\[CapitalOmega]", "]"}]}], 
             "+", 
             RowBox[{
              RowBox[{
               SuperscriptBox["J", "\[Prime]",
                MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], " ", 
              
              RowBox[{
               SuperscriptBox["F", 
                TagBox[
                 RowBox[{"(", "3", ")"}],
                 Derivative],
                MultilineFunction->None], "[", "\[CapitalOmega]", "]"}]}]}], 
            ")"}]}], "-", 
          RowBox[{
           RowBox[{"F", "[", "\[CapitalOmega]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["F", "\[Prime]",
             MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox["J", "\[Prime]",
                 MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], 
               "2"], " ", 
              RowBox[{
               SuperscriptBox["F", "\[Prime]\[Prime]",
                MultilineFunction->None], "[", "\[CapitalOmega]", "]"}]}], 
             "-", 
             RowBox[{"2", " ", 
              RowBox[{"F", "[", "\[CapitalOmega]", "]"}], " ", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox["J", "\[Prime]\[Prime]",
                 MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], 
               "2"]}], "+", 
             RowBox[{
              RowBox[{"F", "[", "\[CapitalOmega]", "]"}], " ", 
              RowBox[{
               SuperscriptBox["J", "\[Prime]",
                MultilineFunction->None], "[", "\[CapitalOmega]", "]"}], " ", 
              
              RowBox[{
               SuperscriptBox["J", 
                TagBox[
                 RowBox[{"(", "3", ")"}],
                 Derivative],
                MultilineFunction->None], "[", "\[CapitalOmega]", "]"}]}]}], 
            ")"}]}]}], ")"}]}], ")"}], " ", 
      SuperscriptBox["\[Delta]\[CapitalOmega]", "2"]}]}]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Delta]\[CapitalOmega]", "]"}], "3"],
    SeriesData[$CellContext`\[Delta]\[CapitalOmega], 0, {}, 2, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Delta]\[CapitalOmega], 0, {
   Rational[-1, 
      2] $CellContext`k^(-1) $CellContext`kp^(-1) ($CellContext`k + \
$CellContext`kp)^(-1) ((-2) $CellContext`k $CellContext`kp + $CellContext`k^2 \
($CellContext`\[Beta] - $CellContext`\[Gamma]) + $CellContext`kp^2 \
($CellContext`\[Beta] - $CellContext`\[Gamma])) ($CellContext`k \
$CellContext`Ulim[$CellContext`kp, {$CellContext`\[CapitalOmega], \
$CellContext`\[CapitalOmega]}] $CellContext`Ulim[$CellContext`k + \
$CellContext`kp, {$CellContext`\[CapitalOmega], \
$CellContext`\[CapitalOmega]}] - $CellContext`Ulim[$CellContext`k, \
{$CellContext`\[CapitalOmega], $CellContext`\[CapitalOmega]}] \
(($CellContext`k + $CellContext`kp) $CellContext`Ulim[$CellContext`kp, \
{$CellContext`\[CapitalOmega], $CellContext`\[CapitalOmega]}] - \
$CellContext`kp $CellContext`Ulim[$CellContext`k + $CellContext`kp, \
{$CellContext`\[CapitalOmega], $CellContext`\[CapitalOmega]}]))^2 
    Derivative[1][$CellContext`J][$CellContext`\[CapitalOmega]]^(-3) (
     2 Derivative[1][$CellContext`F][$CellContext`\[CapitalOmega]]^3 
      Derivative[1][$CellContext`J][$CellContext`\[CapitalOmega]]^2 + 
     2 $CellContext`F[$CellContext`\[CapitalOmega]] 
      Derivative[1][$CellContext`F][$CellContext`\[CapitalOmega]]^2 
      Derivative[1][$CellContext`J][$CellContext`\[CapitalOmega]] 
      Derivative[
       2][$CellContext`J][$CellContext`\[CapitalOmega]] + \
$CellContext`F[$CellContext`\[CapitalOmega]]^2 
      Derivative[
       1][$CellContext`J][$CellContext`\[CapitalOmega]] ((-2) 
        Derivative[2][$CellContext`F][$CellContext`\[CapitalOmega]] 
        Derivative[2][$CellContext`J][$CellContext`\[CapitalOmega]] + 
       Derivative[1][$CellContext`J][$CellContext`\[CapitalOmega]] 
        Derivative[
         3][$CellContext`F][$CellContext`\[CapitalOmega]]) - \
$CellContext`F[$CellContext`\[CapitalOmega]] 
     Derivative[1][$CellContext`F][$CellContext`\[CapitalOmega]] (
      3 Derivative[1][$CellContext`J][$CellContext`\[CapitalOmega]]^2 
       Derivative[2][$CellContext`F][$CellContext`\[CapitalOmega]] - 
      2 $CellContext`F[$CellContext`\[CapitalOmega]] 
      Derivative[
        2][$CellContext`J][$CellContext`\[CapitalOmega]]^2 + \
$CellContext`F[$CellContext`\[CapitalOmega]] 
       Derivative[1][$CellContext`J][$CellContext`\[CapitalOmega]] 
       Derivative[3][$CellContext`J][$CellContext`\[CapitalOmega]]))}, 2, 3, 
   1],
  Editable->False]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.863605359359976*^9, 3.8636055232929068`*^9, 
  3.8658478247705317`*^9, 3.866196001682205*^9, 3.8665310985184603`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"In", " ", "practice"}], ",", " ", 
    RowBox[{
    "we", " ", "find", " ", "a", " ", "single", " ", "constraint", " ", "to", 
     " ", "satisfy"}], ",", "\[IndentingNewLine]", 
    RowBox[{"that", " ", "only", " ", "involves", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Beta]", "-", "\[Gamma]"}], ")"}], "."}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CONS", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "k", " ", "kp"}], "+", 
        RowBox[{
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", "\[Gamma]"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["kp", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", "\[Gamma]"}], ")"}]}]}], ")"}], "\[Equal]", 
      "0"}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"As", " ", "in", " ", "Fouvry"}], "+", "2020"}], ",", " ", 
     RowBox[{
      RowBox[{
      "we", " ", "make", " ", "the", " ", "simple", " ", "choice", " ", 
       "\[Alpha]"}], "=", "1"}], ",", " ", 
     RowBox[{"\[Beta]", "=", "1."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Exp\[Alpha]", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Exp\[Beta]", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"CONS", " ", "=", 
     RowBox[{"CONS", "/.", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", "\[RuleDelayed]", "1"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"We", " ", "now", " ", "solve", " ", "for", " ", 
     RowBox[{"\[Gamma]", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Exp\[Gamma]", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{"CONS", ",", 
          RowBox[{"{", "\[Gamma]", "}"}]}], "]"}], "//", "First"}], "//", 
       "First"}], "//", "Last"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Checking", " ", "that", " ", "the", " ", "second"}], "-", 
      RowBox[{
      "oder", " ", "term", " ", "in", " ", "the", " ", "contribution", " ", 
       "exactly", " ", "vanishes"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "equation", " ", "is", 
       " ", "well"}], "-", 
      RowBox[{"posed", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"FluxRewriteExpansionReplaced", " ", "=", " ", 
    RowBox[{
     RowBox[{"ReplaceVariables", "[", 
      RowBox[{"FluxRewriteExpansion", ",", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Exp\[Alpha]", ",", "Exp\[Beta]", ",", "Exp\[Gamma]"}], 
        "}"}]}], "]"}], "//", "Simplify"}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.865848023489099*^9, 3.8658482280160837`*^9}, {
  3.8658482640695868`*^9, 3.86584826506758*^9}, {3.8665300208153343`*^9, 
  3.866530030787951*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"k", "-", "kp"}], ")"}], "2"], 
  RowBox[{
   SuperscriptBox["k", "2"], "+", 
   SuperscriptBox["kp", "2"]}]]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{
  3.86584812699506*^9, {3.865848197338883*^9, 3.8658482280161963`*^9}, 
   3.8658482654777946`*^9, 3.8661960068212*^9, 3.866531102163226*^9}],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "\[Delta]\[CapitalOmega]", "]"}], "3"],
  SeriesData[$CellContext`\[Delta]\[CapitalOmega], 0, {}, 3, 3, 1],
  Editable->False]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{
  3.86584812699506*^9, {3.865848197338883*^9, 3.8658482280161963`*^9}, 
   3.8658482654777946`*^9, 3.8661960068212*^9, 3.866531102172769*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["11/ SECOND-ORDER KINETIC BLOCKING", \
"Subsubsection"]], "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 CellChangeTimes->{{3.863778248317864*^9, 3.863778277116786*^9}, 
   3.864293250095385*^9, {3.866178840761897*^9, 3.866178842220595*^9}, 
   3.86617895262715*^9, {3.866179023445636*^9, 3.8661790241172943`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Expression", " ", "of", " ", "the", " ", "two", " ", "coupling", " ", 
    RowBox[{"coefficients", "."}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"First", " ", "coupling", " ", 
    RowBox[{"U1", "."}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"expU1", " ", "=", " ", 
     RowBox[{
      RowBox[{"k2", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}], " ", 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}]}], ")"}]}], "+", "\n", 
      RowBox[{"k1", " ", 
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP1", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
      "\n", 
      RowBox[{"k1", " ", "k2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k2", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J1"}], "}"}]}], "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"UPotk", "[", 
           RowBox[{"k1", ",", 
            RowBox[{"{", 
             RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], 
          RowBox[{"UPotkP2", "[", 
           RowBox[{
            RowBox[{"k1", "+", "k2"}], ",", 
            RowBox[{"{", 
             RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ";"}],
    "\n", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "coupling", " ", 
     RowBox[{"U2", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"expU2", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J", "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", "\n", " ", 
      RowBox[{"k1", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J1", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J1"}], "}"}]}], "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}]}], " ", "-", "\n", " ", 
      RowBox[{"k2", " ", 
       RowBox[{"\[CapitalOmega]P", "[", "J2", "]"}], 
       RowBox[{"UPotk", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"{", 
          RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], " ", 
       RowBox[{"UPotk", "[", 
        RowBox[{
         RowBox[{"k1", "+", "k2"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "J2"}], "}"}]}], "]"}]}]}]}], ";"}]}]}]], "Input",\

 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 CellChangeTimes->{{3.863778285504188*^9, 3.863778285505381*^9}, 
   3.8642932500958242`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Generic", " ", "function", " ", "that", " ", "checks", " ", "for", " ", 
      "the", " ", "second"}], "-", 
     RowBox[{"order", " ", "kinetic", " ", 
      RowBox[{"blocking", ".", "\[IndentingNewLine]", "Here"}]}]}], ",", " ", 
    
    RowBox[{
     RowBox[{
     "we", " ", "assume", " ", "that", " ", "the", " ", "coupling", " ", 
      "coefficients", " ", "are", " ", "generically", " ", "of", " ", "the", 
      " ", "form", "\[IndentingNewLine]", 
      RowBox[{"U", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"J", ",", "Jp"}], "}"}]}], "]"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DIV", "[", 
          RowBox[{"k", ",", "dBLOCK"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", "k", "]"}], "^", 
           RowBox[{"(", "\[Alpha]BLOCK", ")"}]}], ")"}]}], "\[Times]", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"J", "-", "Jp"}], "]"}], "^", 
          RowBox[{"(", "\[Alpha]BLOCK", ")"}]}], ".", "\[IndentingNewLine]", 
         "with"}], " ", "\[Alpha]BLOCK", " ", "a", " ", "given", " ", "power",
         " ", "index", " ", "and", " ", "dBLOCK"}], "\[GreaterEqual]", 
       RowBox[{"1", " ", "a", " ", "given", " ", 
        RowBox[{"integer", ".", "\[IndentingNewLine]", "We"}], " ", 
        "introduced", " ", "the", " ", "funtion", " ", 
        RowBox[{"DIV", "[", 
         RowBox[{"k", ",", "d"}], "]"}]}]}], "=", 
      RowBox[{
       RowBox[{"1", " ", "if", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{"k", ",", "d"}], "]"}]}], "=", "0"}]}]}], ",", " ", 
    RowBox[{"0", " ", 
     RowBox[{"otherwise", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
    " ", 
    RowBox[{"this", " ", "function", " ", "uses", " ", 
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2", ",", "\[Alpha]BLOCK", ",", "dBLOCK"}], "}"}], 
     " ", "as", " ", "global", " ", 
     RowBox[{"variables", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TestBLOCK", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "exp", ",", "kON", ",", "exp\[CapitalOmega]", ",", 
        "exp\[CapitalOmega]P", ",", "expUPotk", ",", "expUPotkP1", ",", 
        "expUPotkP2", ",", "expJ2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Expression", " ", "of", " ", "the", " ", "considered", " ", 
         "frequency", " ", "profile", " ", "expressed", " ", "as", " ", "a", 
         " ", "function", " ", "of", " ", 
         RowBox[{"Ja", ".", "\[IndentingNewLine]", "Here"}]}], ",", " ", 
        RowBox[{
        "we", " ", "assume", " ", "a", " ", "simple", " ", "linear", " ", 
         "monotonic", " ", "frequency", " ", 
         RowBox[{"profile", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"exp\[CapitalOmega]", " ", "=", "Ja"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Coupling", " ", "function", " ", "that", " ", "we", " ", "test"}], 
         ",", " ", 
         RowBox[{"expressed", " ", "as", " ", "a", " ", "function", " ", 
          RowBox[{
           RowBox[{"of", " ", "[", 
            RowBox[{"ka", ",", 
             RowBox[{"{", 
              RowBox[{"Ja", ",", "Jb"}], "}"}]}], "]"}], ".", 
           "\[IndentingNewLine]", "Here"}]}], ",", " ", 
         RowBox[{
          RowBox[{"we", " ", "introduced", " ", "the", " ", "function", " ", 
           RowBox[{"DIV", "[", 
            RowBox[{"k", ",", "d"}], "]"}]}], "=", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"if", " ", "k"}], "\[Equal]", 
          RowBox[{"0", "[", 
           RowBox[{"mod", " ", "d"}], "]"}]}], ",", " ", 
         RowBox[{"0", " ", 
          RowBox[{"otherwise", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
         ",", " ", 
         RowBox[{
         "it", " ", "must", " ", "be", " ", "a", " ", "SYMMETRIC", " ", 
          "function", " ", "of", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Ja", ",", "Jb"}], "}"}], ".", "\[IndentingNewLine]", 
           "ATTENTION"}]}], ",", " ", 
         RowBox[{
         "it", " ", "must", " ", "be", " ", "an", " ", "EVEN", " ", 
          "function", " ", "of", " ", 
          RowBox[{"ka", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"expUPotk", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DIV", "[", 
            RowBox[{"ka", ",", "dBLOCK"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Abs", "[", "ka", "]"}], "^", 
             RowBox[{"(", "\[Alpha]BLOCK", ")"}]}], ")"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Abs", "[", 
             RowBox[{"Ja", "-", "Jb"}], "]"}], ")"}], "^", 
           RowBox[{"(", "\[Alpha]BLOCK", ")"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Initial", " ", "expression", " ", "of", " ", "the", " ", "coupling",
           " ", 
          RowBox[{"term", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
         " ", 
         RowBox[{"this", " ", "is", " ", "WITHOUT", " ", "the", " ", 
          RowBox[{"SQUARE", ":", " ", 
           RowBox[{
           "this", " ", "is", " ", "not", " ", "needed", " ", "for", " ", 
            "this", " ", 
            RowBox[{"test", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"exp", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[CapitalOmega]", "[", "J", "]"}], "-", 
             RowBox[{"\[CapitalOmega]", "[", "J1", "]"}]}], ")"}], "expU1"}], 
          " ", "+", " ", 
          RowBox[{"k2", " ", "expU2"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Gradient", " ", "of", " ", "the", " ", "frequency", " ", 
         RowBox[{"profile", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"exp\[CapitalOmega]P", " ", "=", " ", 
        RowBox[{"D", "[", 
         RowBox[{"exp\[CapitalOmega]", ",", 
          RowBox[{"{", 
           RowBox[{"Ja", ",", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Replacing", " ", "with", " ", "the", " ", "expression", " ", "of", 
         " ", 
         RowBox[{"\[CapitalOmega]", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"exp", " ", "=", " ", 
        RowBox[{"exp", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalOmega]", "[", "Jc_", "]"}], "\[RuleDelayed]", 
            RowBox[{"ReplaceVariables", "[", 
             RowBox[{"exp\[CapitalOmega]", ",", 
              RowBox[{"{", "Ja", "}"}], ",", 
              RowBox[{"{", "Jc", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[CapitalOmega]P", "[", "Jc_", "]"}], "\[RuleDelayed]", 
            RowBox[{"ReplaceVariables", "[", 
             RowBox[{"exp\[CapitalOmega]P", ",", 
              RowBox[{"{", "Ja", "}"}], ",", 
              RowBox[{"{", "Jc", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Needed", " ", "gradients", " ", "of", " ", "the", " ", "coupling", 
         " ", 
         RowBox[{"function", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"expUPotkP1", " ", "=", " ", 
        RowBox[{"D", "[", 
         RowBox[{"expUPotk", ",", 
          RowBox[{"{", 
           RowBox[{"Ja", ",", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"expUPotkP2", " ", "=", " ", 
        RowBox[{"D", "[", 
         RowBox[{"expUPotk", ",", 
          RowBox[{"{", 
           RowBox[{"Jb", ",", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Replacing", " ", "by", " ", "the", " ", "expression", " ", "of", 
          " ", "the", " ", 
          RowBox[{"couplings", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
         ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "we", " ", "make", " ", "the", " ", "replacement", " ", "only", 
            " ", "for", " ", "the", " ", "harmonics"}], " ", "|", "k", "|"}], 
          "=", 
          RowBox[{"kON", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"exp", " ", "=", " ", 
        RowBox[{"exp", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"UPotk", "[", 
             RowBox[{"kc_", ",", 
              RowBox[{"{", 
               RowBox[{"Jc_", ",", "Jd_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
            
            RowBox[{"ReplaceVariables", "[", 
             RowBox[{"expUPotk", ",", 
              RowBox[{"{", 
               RowBox[{"ka", ",", "Ja", ",", "Jb"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"kc", ",", "Jc", ",", "Jd"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"UPotkP1", "[", 
             RowBox[{"kc_", ",", 
              RowBox[{"{", 
               RowBox[{"Jc_", ",", "Jd_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
            
            RowBox[{"ReplaceVariables", "[", 
             RowBox[{"expUPotkP1", ",", 
              RowBox[{"{", 
               RowBox[{"ka", ",", "Ja", ",", "Jb"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"kc", ",", "Jc", ",", "Jd"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"UPotkP2", "[", 
             RowBox[{"kc_", ",", 
              RowBox[{"{", 
               RowBox[{"Jc_", ",", "Jd_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
            
            RowBox[{"ReplaceVariables", "[", 
             RowBox[{"expUPotkP2", ",", 
              RowBox[{"{", 
               RowBox[{"ka", ",", "Ja", ",", "Jb"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"kc", ",", "Jc", ",", "Jd"}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Finally", ",", " ", 
         RowBox[{
         "replacing", " ", "J2", " ", "by", " ", "its", " ", "resonant", " ", 
          
          RowBox[{"location", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"expJ2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"k1", "+", "k2"}], ")"}], 
               RowBox[{"ReplaceVariables", "[", 
                RowBox[{"exp\[CapitalOmega]", ",", 
                 RowBox[{"{", "Ja", "}"}], ",", 
                 RowBox[{"{", "J", "}"}]}], "]"}]}], "\[Equal]", 
              RowBox[{
               RowBox[{"k1", " ", 
                RowBox[{"ReplaceVariables", "[", 
                 RowBox[{"exp\[CapitalOmega]", ",", 
                  RowBox[{"{", "Ja", "}"}], ",", 
                  RowBox[{"{", "J1", "}"}]}], "]"}]}], " ", "+", " ", 
               RowBox[{"k2", " ", 
                RowBox[{"ReplaceVariables", "[", 
                 RowBox[{"exp\[CapitalOmega]", ",", 
                  RowBox[{"{", "Ja", "}"}], ",", 
                  RowBox[{"{", "J2", "}"}]}], "]"}]}]}]}], ",", "J2"}], "]"}],
            "//", "First"}], "//", "First"}], "//", "Last"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Replacing", " ", "J2", " ", "with", " ", "its", " ", "resonant", " ", 
         RowBox[{"location", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"exp", " ", "=", " ", 
        RowBox[{"exp", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"J2", " ", "\[RuleDelayed]", "expJ2"}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Simplifying", " ", "the", " ", 
          RowBox[{"expression", ".", "\[IndentingNewLine]", "ATTENTION"}]}], 
         ",", " ", 
         RowBox[{
         "we", " ", "make", " ", "sure", " ", "to", " ", "tell", " ", "MMA", 
          " ", "that", " ", "all", " ", "the", " ", "quantities", " ", "are", 
          " ", 
          RowBox[{"real", ".", "\[IndentingNewLine]", "ATTENTION"}]}], ",", 
         " ", 
         RowBox[{
         "using", " ", "ComplexExpand", " ", "allows", " ", "one", " ", "to", 
          " ", "get", " ", "rid", " ", "of", " ", "the", " ", "derivatives", 
          " ", "of", " ", 
          RowBox[{"Abs", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"exp", " ", "=", " ", 
        RowBox[{
         RowBox[{"exp", "//", "ComplexExpand"}], "//", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Assumptions", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"k1", " ", "\[Element]", " ", "Reals"}], ",", 
               RowBox[{"k2", " ", "\[Element]", " ", "Reals"}]}], "}"}]}]}], 
           "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Output", "."}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "exp", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 CellChangeTimes->{{3.863073163199065*^9, 3.863073163933935*^9}, {
   3.8630733388891993`*^9, 3.863073563621675*^9}, {3.8630736179041653`*^9, 
   3.863074027904874*^9}, {3.8630740744230328`*^9, 3.863074121967133*^9}, {
   3.863074187466127*^9, 3.863074247115943*^9}, {3.8630742833886223`*^9, 
   3.863074284356772*^9}, {3.863074372351812*^9, 3.8630743928178043`*^9}, {
   3.8630744767601957`*^9, 3.863074477014442*^9}, {3.863074516119134*^9, 
   3.863074547823484*^9}, {3.863074662328223*^9, 3.863074680190473*^9}, {
   3.8630749244814987`*^9, 3.863074927119482*^9}, {3.8630749883593817`*^9, 
   3.863075097872471*^9}, {3.863075149602347*^9, 3.8630751816733513`*^9}, {
   3.863075233692923*^9, 3.863075254836878*^9}, {3.863089048667729*^9, 
   3.863089073126478*^9}, {3.86310722168851*^9, 3.8631072595503607`*^9}, {
   3.86310739032957*^9, 3.8631073931615868`*^9}, {3.8631074297616177`*^9, 
   3.863107429888932*^9}, {3.8631074760148783`*^9, 3.863107565990801*^9}, {
   3.863107637928174*^9, 3.863107657413394*^9}, {3.8631077052834663`*^9, 
   3.863107716405622*^9}, {3.8631542991718063`*^9, 3.863154311440825*^9}, {
   3.863154351293579*^9, 3.863154351404105*^9}, {3.863154386069193*^9, 
   3.8631544073319893`*^9}, 3.863154475630418*^9, {3.8631882750695467`*^9, 
   3.863188351567594*^9}, {3.86318839690193*^9, 3.863188753731695*^9}, {
   3.8631888042557917`*^9, 3.863188831169244*^9}, {3.863188861749207*^9, 
   3.863188944917153*^9}, {3.8631893470404453`*^9, 3.863189357863514*^9}, {
   3.863189406622756*^9, 3.863189407741724*^9}, {3.8631894390307827`*^9, 
   3.8631894559702187`*^9}, {3.863189488056841*^9, 3.8631895302740583`*^9}, {
   3.8631895949818153`*^9, 3.8631895998919353`*^9}, {3.8631897337396317`*^9, 
   3.863189746074795*^9}, {3.863189789336895*^9, 3.8631898206344833`*^9}, {
   3.863190063064237*^9, 3.863190101795039*^9}, {3.863190137791518*^9, 
   3.863190140582765*^9}, {3.863190186153549*^9, 3.8631902006897507`*^9}, {
   3.8636065223105907`*^9, 3.863606524646799*^9}, {3.86366554099129*^9, 
   3.8636656206587152`*^9}, {3.863665720547793*^9, 3.8636657207076063`*^9}, {
   3.8637764923999*^9, 3.863776492886101*^9}, {3.863776603579555*^9, 
   3.863776604417864*^9}, {3.8637766385391417`*^9, 3.863776654873076*^9}, {
   3.863776684967601*^9, 3.863776746827018*^9}, {3.863776788470306*^9, 
   3.863776810164421*^9}, {3.863776854514819*^9, 3.863776856496842*^9}, {
   3.863776887410486*^9, 3.8637769189799767`*^9}, {3.863776956753314*^9, 
   3.8637770193168364`*^9}, {3.863777219134554*^9, 3.863777221590949*^9}, {
   3.863777309187628*^9, 3.863777330553334*^9}, {3.863777593604748*^9, 
   3.863777616612384*^9}, {3.863777739638977*^9, 3.863777766530632*^9}, {
   3.86377830001689*^9, 3.863778332848736*^9}, {3.863778405079482*^9, 
   3.8637786355188828`*^9}, {3.863778887449494*^9, 3.863778899634425*^9}, {
   3.86377907462387*^9, 3.863779079048283*^9}, {3.863779141639233*^9, 
   3.863779145499601*^9}, {3.8637791769824*^9, 3.863779184286399*^9}, {
   3.863779218943583*^9, 3.863779267252825*^9}, 3.863779307160544*^9, {
   3.863779342359351*^9, 3.8637793424869003`*^9}, {3.863779419740979*^9, 
   3.863779484141931*^9}, {3.863779632190105*^9, 3.863779647471608*^9}, {
   3.863779684059937*^9, 3.8637797035388613`*^9}, {3.863779739380797*^9, 
   3.863779752467841*^9}, {3.863779832708126*^9, 3.8637801293549213`*^9}, {
   3.864293145795006*^9, 3.864293150555417*^9}, {3.864293235716818*^9, 
   3.864293250096623*^9}, {3.8643597585417967`*^9, 3.864359817612175*^9}, {
   3.864359867707163*^9, 3.8643598702471437`*^9}, {3.8643599052792187`*^9, 
   3.8643599560494547`*^9}, {3.864727911656603*^9, 3.864727964055941*^9}, {
   3.86538783320292*^9, 3.8653878581919622`*^9}, {3.865778935513836*^9, 
   3.865778958759965*^9}, {3.8661702719910507`*^9, 3.8661702790010757`*^9}, {
   3.866196057467391*^9, 3.866196242665801*^9}, {3.86619627267054*^9, 
   3.866196314326273*^9}, {3.866530046440464*^9, 3.866530074136245*^9}, {
   3.866530113427883*^9, 3.86653011360116*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Checking", " ", "the", " ", 
    RowBox[{"coupling", ".", "\[IndentingNewLine]", "The"}], " ", "remaining",
     " ", "term", " ", "is", " ", "exactly", " ", 
    RowBox[{"zero", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"TestBLOCK", "[", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 CellChangeTimes->{{3.864293238313339*^9, 3.8642932500967607`*^9}, {
  3.865778997368721*^9, 3.865779018759604*^9}, {3.866196319476058*^9, 
  3.866196320836071*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"J", "-", "J1"}], ")"}], "2"], ")"}], "\[Alpha]BLOCK"], " ", 
  "k2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "\[Alpha]BLOCK"}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"Abs", "[", "k2", "]"}], 
   RowBox[{
    RowBox[{"-", "2"}], " ", "\[Alpha]BLOCK"}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"k1", " ", 
     RowBox[{"DIV", "[", 
      RowBox[{"k2", ",", "dBLOCK"}], "]"}], " ", 
     RowBox[{"DIV", "[", 
      RowBox[{
       RowBox[{"k1", "+", "k2"}], ",", "dBLOCK"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"DIV", "[", 
      RowBox[{"k1", ",", "dBLOCK"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"k1", "+", "k2"}], ")"}], " ", 
        RowBox[{"DIV", "[", 
         RowBox[{"k2", ",", "dBLOCK"}], "]"}]}], "-", 
       RowBox[{"k2", " ", 
        RowBox[{"DIV", "[", 
         RowBox[{
          RowBox[{"k1", "+", "k2"}], ",", "dBLOCK"}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 CellChangeTimes->{{3.8642932443986588`*^9, 3.864293250096875*^9}, 
   3.865778989736084*^9, 3.866091330989106*^9, 3.866196322190648*^9, 
   3.8665311121701603`*^9}]
}, Closed]]
},
Evaluator->"second",
WindowSize->{1606, 793},
WindowMargins->{{152, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4061, 81, 393, "Input"],
Cell[CellGroupData[{
Cell[4644, 105, 460, 10, 46, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[5107, 117, 80492, 1948, 6315, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[85636, 2070, 361, 5, 38, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[86000, 2077, 43579, 1162, 2661, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Closed]],
Cell[CellGroupData[{
Cell[129616, 3244, 367, 6, 38, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[129986, 3252, 86187, 2183, 5901, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}]
}, Closed]],
Cell[CellGroupData[{
Cell[216210, 5440, 381, 6, 38, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[216594, 5448, 36868, 970, 2262, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}]
}, Closed]],
Cell[CellGroupData[{
Cell[253499, 6423, 454, 7, 38, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[253956, 6432, 168020, 4131, 10508, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[421979, 10565, 580, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[422562, 10579, 580, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[423145, 10593, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[423727, 10607, 580, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[424310, 10621, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[424892, 10635, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[425474, 10649, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[426056, 10663, 578, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[426637, 10677, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[427219, 10691, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[427801, 10705, 580, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[428384, 10719, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[428966, 10733, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[429548, 10747, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[430130, 10761, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[430712, 10775, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[431294, 10789, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[431876, 10803, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[432458, 10817, 579, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[433040, 10831, 43908, 1039, 3858, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[476951, 11872, 888, 15, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[477842, 11889, 767, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[478612, 11903, 712, 10, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[479327, 11915, 767, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[480097, 11929, 714, 10, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[480814, 11941, 882, 15, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[481699, 11958, 856, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[482558, 11974, 849, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[483410, 11990, 767, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[484180, 12004, 854, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[485037, 12020, 852, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[485892, 12036, 767, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[486662, 12050, 853, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[487518, 12066, 850, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[488371, 12082, 767, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[489141, 12096, 854, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[489998, 12112, 850, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[490851, 12128, 767, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[491621, 12142, 854, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[492478, 12158, 848, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[493329, 12174, 767, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[494099, 12188, 766, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[494868, 12202, 766, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[495637, 12216, 766, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[496406, 12230, 854, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[497263, 12246, 852, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[498118, 12262, 766, 12, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[498887, 12276, 44101, 1017, 3856, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[542991, 13295, 824, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[543818, 13311, 659, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[544480, 13324, 658, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[545141, 13337, 661, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[545805, 13350, 659, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[546467, 13363, 659, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[547129, 13376, 818, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[547950, 13392, 792, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[548745, 13407, 786, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[549534, 13422, 661, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[550198, 13435, 788, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[550989, 13450, 784, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[551776, 13465, 659, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[552438, 13478, 788, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[553229, 13493, 784, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[554016, 13508, 659, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[554678, 13521, 111167, 2675, 8387, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[665848, 16198, 835, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[666686, 16214, 705, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[667394, 16227, 833, 14, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[668230, 16243, 801, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[669034, 16258, 797, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[669834, 16273, 702, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[670539, 16286, 801, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[671343, 16301, 799, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[672145, 16316, 701, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[672849, 16329, 705, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[673557, 16342, 801, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[674361, 16357, 799, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[675163, 16372, 703, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[675869, 16385, 801, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[676673, 16400, 797, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[677473, 16415, 702, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[678178, 16428, 803, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[678984, 16443, 797, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[679784, 16458, 702, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[680489, 16471, 801, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[681293, 16486, 799, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[682095, 16501, 701, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[682799, 16514, 801, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[683603, 16529, 797, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[684403, 16544, 702, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[685108, 16557, 800, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[685911, 16572, 799, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[686713, 16587, 704, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[687420, 16600, 803, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[688226, 16615, 797, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[689026, 16630, 801, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[689830, 16645, 797, 13, 26, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[690630, 16660, 702, 11, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[691335, 16673, 7027, 187, 292, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[698365, 16862, 1107, 29, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[699475, 16893, 406, 7, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[699884, 16902, 406, 7, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[700293, 16911, 2276, 59, 197, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[702572, 16972, 9110, 251, 365, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[711685, 17225, 174, 3, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}]
}, Closed]],
Cell[CellGroupData[{
Cell[711896, 17233, 392, 6, 38, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10006.}],
Cell[712291, 17241, 5512, 129, 533, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.}],
Cell[717806, 17372, 1961, 60, 121, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10006.}]
}, Closed]],
Cell[CellGroupData[{
Cell[719804, 17437, 396, 7, 38, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[720203, 17446, 7872, 224, 302, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[728078, 17672, 5453, 139, 386, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[733534, 17813, 1521, 46, 134, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[735058, 17861, 264, 4, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[735325, 17867, 263, 4, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]],
Cell[CellGroupData[{
Cell[735625, 17876, 297, 4, 38, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[735925, 17882, 14269, 369, 827, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[750197, 18253, 534, 9, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[750734, 18264, 10900, 294, 512, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[761637, 18560, 466, 8, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[762106, 18570, 900, 22, 113, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[763009, 18594, 513, 7, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}]
}, Closed]],
Cell[CellGroupData[{
Cell[763559, 18606, 345, 5, 38, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[763907, 18613, 17245, 459, 911, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[781155, 19074, 6141, 168, 259, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[787299, 19244, 9002, 248, 344, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[796304, 19494, 809, 20, 113, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[797116, 19516, 344, 6, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}]
}, Closed]],
Cell[CellGroupData[{
Cell[797497, 19527, 338, 5, 38, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[797838, 19534, 46848, 1215, 3043, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[844689, 20751, 295, 6, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[844987, 20759, 295, 6, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[845285, 20767, 299, 6, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[845587, 20775, 295, 6, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[845885, 20783, 296, 6, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[846184, 20791, 838, 19, 71, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[847025, 20812, 274, 5, 49, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[847302, 20819, 848, 18, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[848153, 20839, 8966, 213, 136, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[857122, 21054, 3236, 86, 266, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[860361, 21142, 411, 11, 78, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[860775, 21155, 426, 9, 53, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}]
}, Closed]],
Cell[CellGroupData[{
Cell[861238, 21169, 374, 6, 38, "Input",
 Evaluatable->False,
 CellGroupingRules->{GroupTogetherGrouping, 10006.}],
Cell[861615, 21177, 4418, 129, 218, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.}],
Cell[866036, 21308, 17740, 385, 1059, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.}],
Cell[883779, 21695, 538, 11, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.}],
Cell[884320, 21708, 1345, 42, 56, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10006.}]
}, Closed]]
}
]
*)

(* End of internal cache information *)
